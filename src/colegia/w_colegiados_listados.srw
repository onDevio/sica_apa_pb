HA$PBExportHeader$w_colegiados_listados.srw
forward
global type w_colegiados_listados from w_listados
end type
type gb_12 from groupbox within w_colegiados_listados
end type
type tab_1 from tab within w_colegiados_listados
end type
type tabpage_1 from userobject within tab_1
end type
type dw_datos_personales from u_dw within tabpage_1
end type
type tabpage_1 from userobject within tab_1
dw_datos_personales dw_datos_personales
end type
type tabpage_2 from userobject within tab_1
end type
type dw_fechas from u_dw within tabpage_2
end type
type tabpage_2 from userobject within tab_1
dw_fechas dw_fechas
end type
type tabpage_3 from userobject within tab_1
end type
type dw_servicios from u_dw within tabpage_3
end type
type tabpage_3 from userobject within tab_1
dw_servicios dw_servicios
end type
type tabpage_4 from userobject within tab_1
end type
type dw_alta_si_no from u_dw within tabpage_4
end type
type cb_borrar1 from commandbutton within tabpage_4
end type
type cb_todos1 from commandbutton within tabpage_4
end type
type dw_situaciones from u_dw within tabpage_4
end type
type dw_t_alta from u_dw within tabpage_4
end type
type dw_t_baja from u_dw within tabpage_4
end type
type cb_todos2 from commandbutton within tabpage_4
end type
type cb_borrar2 from commandbutton within tabpage_4
end type
type cb_todos3 from commandbutton within tabpage_4
end type
type cb_borrar3 from commandbutton within tabpage_4
end type
type cbx_alta from checkbox within tabpage_4
end type
type cbx_baja from checkbox within tabpage_4
end type
type dw_opcion_situaciones from u_dw within tabpage_4
end type
type dw_opcion_altas from u_dw within tabpage_4
end type
type dw_opcion_bajas from u_dw within tabpage_4
end type
type gb_1 from groupbox within tabpage_4
end type
type gb_2 from groupbox within tabpage_4
end type
type gb_3 from groupbox within tabpage_4
end type
type tabpage_4 from userobject within tab_1
dw_alta_si_no dw_alta_si_no
cb_borrar1 cb_borrar1
cb_todos1 cb_todos1
dw_situaciones dw_situaciones
dw_t_alta dw_t_alta
dw_t_baja dw_t_baja
cb_todos2 cb_todos2
cb_borrar2 cb_borrar2
cb_todos3 cb_todos3
cb_borrar3 cb_borrar3
cbx_alta cbx_alta
cbx_baja cbx_baja
dw_opcion_situaciones dw_opcion_situaciones
dw_opcion_altas dw_opcion_altas
dw_opcion_bajas dw_opcion_bajas
gb_1 gb_1
gb_2 gb_2
gb_3 gb_3
end type
type tabpage_5 from userobject within tab_1
end type
type dw_agrupaciones from u_dw within tabpage_5
end type
type cb_incluir4 from commandbutton within tabpage_5
end type
type cb_borrar4 from commandbutton within tabpage_5
end type
type dw_sit_profesionales from u_dw within tabpage_5
end type
type dw_incompatibilidades from u_dw within tabpage_5
end type
type cb_3 from commandbutton within tabpage_5
end type
type cb_4 from commandbutton within tabpage_5
end type
type cb_5 from commandbutton within tabpage_5
end type
type cb_6 from commandbutton within tabpage_5
end type
type dw_opcion_agr from u_dw within tabpage_5
end type
type dw_opcion_sit from u_dw within tabpage_5
end type
type dw_opcion_incomp from u_dw within tabpage_5
end type
type gb_4 from groupbox within tabpage_5
end type
type gb_5 from groupbox within tabpage_5
end type
type gb_6 from groupbox within tabpage_5
end type
type gb_7 from groupbox within tabpage_5
end type
type dw_datos_agrupacion from u_dw within tabpage_5
end type
type gb_8 from groupbox within tabpage_5
end type
type dw_datos_sitprof from u_dw within tabpage_5
end type
type tabpage_5 from userobject within tab_1
dw_agrupaciones dw_agrupaciones
cb_incluir4 cb_incluir4
cb_borrar4 cb_borrar4
dw_sit_profesionales dw_sit_profesionales
dw_incompatibilidades dw_incompatibilidades
cb_3 cb_3
cb_4 cb_4
cb_5 cb_5
cb_6 cb_6
dw_opcion_agr dw_opcion_agr
dw_opcion_sit dw_opcion_sit
dw_opcion_incomp dw_opcion_incomp
gb_4 gb_4
gb_5 gb_5
gb_6 gb_6
gb_7 gb_7
dw_datos_agrupacion dw_datos_agrupacion
gb_8 gb_8
dw_datos_sitprof dw_datos_sitprof
end type
type tabpage_10 from userobject within tab_1
end type
type dw_ejerciente_si_no from u_dw within tabpage_10
end type
type cb_todos5 from commandbutton within tabpage_10
end type
type cb_borrar5 from commandbutton within tabpage_10
end type
type dw_residente from u_dw within tabpage_10
end type
type dw_opcion_residente from u_dw within tabpage_10
end type
type gb_15 from groupbox within tabpage_10
end type
type tabpage_10 from userobject within tab_1
dw_ejerciente_si_no dw_ejerciente_si_no
cb_todos5 cb_todos5
cb_borrar5 cb_borrar5
dw_residente dw_residente
dw_opcion_residente dw_opcion_residente
gb_15 gb_15
end type
type tabpage_6 from userobject within tab_1
end type
type cb_7 from commandbutton within tabpage_6
end type
type cb_8 from commandbutton within tabpage_6
end type
type dw_consulta_orientaciones from u_dw within tabpage_6
end type
type gb_10 from groupbox within tabpage_6
end type
type dw_opciones_orientaciones from u_dw within tabpage_6
end type
type gb_9 from groupbox within tabpage_6
end type
type dw_otros_datos from u_dw within tabpage_6
end type
type tabpage_6 from userobject within tab_1
cb_7 cb_7
cb_8 cb_8
dw_consulta_orientaciones dw_consulta_orientaciones
gb_10 gb_10
dw_opciones_orientaciones dw_opciones_orientaciones
gb_9 gb_9
dw_otros_datos dw_otros_datos
end type
type tabpage_7 from userobject within tab_1
end type
type dw_datos_musaat from u_dw within tabpage_7
end type
type tabpage_7 from userobject within tab_1
dw_datos_musaat dw_datos_musaat
end type
type tabpage_8 from userobject within tab_1
end type
type dw_datos_premaat from u_dw within tabpage_8
end type
type tabpage_8 from userobject within tab_1
dw_datos_premaat dw_datos_premaat
end type
type tab_1 from tab within w_colegiados_listados
tabpage_1 tabpage_1
tabpage_2 tabpage_2
tabpage_3 tabpage_3
tabpage_4 tabpage_4
tabpage_5 tabpage_5
tabpage_10 tabpage_10
tabpage_6 tabpage_6
tabpage_7 tabpage_7
tabpage_8 tabpage_8
end type
type rb_num_col from radiobutton within w_colegiados_listados
end type
type rb_apellidos from radiobutton within w_colegiados_listados
end type
type rb_cp from radiobutton within w_colegiados_listados
end type
type rb_nif from radiobutton within w_colegiados_listados
end type
type rb_1 from radiobutton within w_colegiados_listados
end type
type rb_2 from radiobutton within w_colegiados_listados
end type
type gb_11 from groupbox within w_colegiados_listados
end type
end forward

global type w_colegiados_listados from w_listados
integer width = 3703
integer height = 2432
string title = "Listados de Colegiados"
event csd_consulta_fechas ( )
event csd_consulta_general ( )
event csd_consulta_profesional ( )
event csd_consulta_servicios ( )
event csd_consulta_sit_colegial ( )
event csd_consulta_otros_datos ( )
event csd_consulta_musaat ( )
event csd_consulta_premaat ( )
event csd_consulta_residente ( )
event csd_oculta ( )
event csd_listado_peritos_judiciales ( datawindow dw_listado )
event csd_listado_partido_judicial ( datawindow dw_listado )
event csd_colegiado_listado_peritaje ( datawindow dw_listado )
gb_12 gb_12
tab_1 tab_1
rb_num_col rb_num_col
rb_apellidos rb_apellidos
rb_cp rb_cp
rb_nif rb_nif
rb_1 rb_1
rb_2 rb_2
gb_11 gb_11
end type
global w_colegiados_listados w_colegiados_listados

type variables
u_dw idw_situaciones,idw_t_alta,idw_t_baja,idw_agrupaciones,idw_sit_profesionales, idw_incompatibilidades, idw_general
u_dw idw_fechas,idw_servicios, idw_opcion_sit,idw_opcion_altas,idw_opcion_bajas,idw_opcion_orientaciones,idw_opcion_otros
u_dw idw_opcion_agr,idw_opcion_sitprof,idw_opcion_incompat,idw_orientaciones, idw_datos_agrupacion,idw_datos_sitprof
u_dw idw_otros_datos,idw_alta_sn, idw_musaat,idw_premaat, idw_opcion_residente, idw_residente, idw_ejerciente_sn
string i_sql_nuevo

end variables

event csd_consulta_fechas();f_sql('f_colegiacion','>=','f_colegiacion_desde',idw_fechas,i_sql_nuevo,'1','F.Colegiaci$$HEX1$$f300$$ENDHEX$$n')
f_sql('f_colegiacion','<','f_colegiacion_hasta',idw_fechas,i_sql_nuevo,'1','F.Colegiaci$$HEX1$$f300$$ENDHEX$$n')
f_sql('f_alta','>=','f_alta_desde',idw_fechas,i_sql_nuevo,'1','F.Alta')
f_sql('f_alta','<','f_alta_hasta',idw_fechas,i_sql_nuevo,'1','F.Alta')
f_sql('f_baja','>=','f_baja_desde',idw_fechas,i_sql_nuevo,'1','F.Baja')
f_sql('f_baja','<','f_baja_hasta',idw_fechas,i_sql_nuevo,'1','F.Baja')
f_sql('f_titulacion','>=','f_titulacion_desde',idw_fechas,i_sql_nuevo,'1','F.Titulaci$$HEX1$$f300$$ENDHEX$$n')
f_sql('f_titulacion','<','f_titulacion_hasta',idw_fechas,i_sql_nuevo,'1','F.Titulaci$$HEX1$$f300$$ENDHEX$$n')
f_sql('f_nacimiento','>=','f_nacimiento_desde',idw_fechas,i_sql_nuevo,'1','F.Nacimiento')
f_sql('f_nacimiento','<','f_nacimiento_hasta',idw_fechas,i_sql_nuevo,'1','F.Nacimiento')

end event

event csd_consulta_general();string sql_aux 

f_sql('colegiados.n_colegiado','LIKE','n_colegiado',idw_general,i_sql_nuevo,g_tipo_base_datos,'N$$HEX2$$ba002000$$ENDHEX$$Colegiado')
f_sql('colegiados.n_colegiado','>=','n_cold',idw_general,i_sql_nuevo,g_tipo_base_datos,'N$$HEX2$$ba002000$$ENDHEX$$Colegiado')
f_sql('colegiados.n_colegiado','<=','n_colh',idw_general,i_sql_nuevo,g_tipo_base_datos,'N$$HEX2$$ba002000$$ENDHEX$$Colegiado')
f_sql('colegiados.tipo_persona','LIKE','tipo_persona',idw_general,i_sql_nuevo,'1','Sociedad')
f_sql('colegiados.sexo','LIKE','sexo',idw_general,i_sql_nuevo,'1','Sexo')
f_sql('colegiados.apellidos','LIKE','apellido_nombresociedad',idw_general,i_sql_nuevo,'1','Apellidos')
f_sql('colegiados.nombre','LIKE','nombre',idw_general,i_sql_nuevo,'1','Nombre')
f_sql('colegiados.n_consejo','LIKE','n_consejo',idw_general,i_sql_nuevo,'1','N$$HEX2$$ba002000$$ENDHEX$$Consejo')
f_sql('colegiados.nif','LIKE','nif_cif',idw_general,i_sql_nuevo,g_tipo_base_datos,'NIF')
f_sql('colegiados.colegio','LIKE','colegio',idw_general,i_sql_nuevo,'1','Colegio')
f_sql('colegiados.demarcacion','LIKE','colegio_territorial',idw_general,i_sql_nuevo,'1','Nivel Provincial')
f_sql('colegiados.delegacion','LIKE','delegacion',idw_general,i_sql_nuevo,'1','Delegaci$$HEX1$$f300$$ENDHEX$$n')
//f_sql('colegiados.c_geografico','=','codigo_geografico',idw_general,i_sql_nuevo,'1','Residente')


// Modificado Ricardo 04-07-12
// Por familia de conceptos
if not f_es_vacio(idw_general.getitemstring(1,'familia')) then
	if PosA(upper(i_sql_nuevo), "WHERE") > 0 then
		sql_aux = " and "
	else
		sql_aux = " WHERE "
	end if	
	sql_aux += " colegiados.id_colegiado IN (SELECT id_colegiado FROM conceptos_domiciliables, csi_articulos_servicios WHERE conceptos_domiciliables.concepto= csi_articulos_servicios.codigo and familia = '"+idw_general.getitemstring(1,'familia')+"')"	
	i_sql_nuevo += sql_aux
	sql_aux = ''
end if
// FIN Modificado Ricardo 04-07-12

//Todos los colegiados que tengan el concepto domiciliable elegido
if PosA(upper(i_sql_nuevo), "WHERE") > 0 then
	sql_aux = " and colegiados.id_colegiado IN (SELECT id_colegiado FROM conceptos_domiciliables WHERE concepto='"+idw_general.getitemstring(1,'conceptos_domiciliables')+"')"
else
	sql_aux = " WHERE colegiados.id_colegiado IN (SELECT id_colegiado FROM conceptos_domiciliables WHERE concepto='"+idw_general.getitemstring(1,'conceptos_domiciliables')+"')"
end if	
if not isnull(sql_aux) then i_sql_nuevo += sql_aux

// Todos los colegiados que pertenezcan a la lista de colegiados elegida..
// Pero comprobando si hay que incluirlos o incluirlos
string incl_excl, operador_not
operador_not = ''
incl_excl = idw_general.GetItemString(1,'incluir_lista')
if incl_excl = 'E' then operador_not = ' NOT '

if PosA(upper(i_sql_nuevo), "WHERE") > 0 then
	sql_aux = " and colegiados.id_colegiado " + operador_not + "IN (SELECT id_lista_miembro FROM listas_miembros WHERE id_lista='"+idw_general.getitemstring(1,'lista_colegiados')+"')"
else
	sql_aux = " WHERE colegiados.id_colegiado " + operador_not + "IN (SELECT id_lista_miembro FROM listas_miembros WHERE id_lista='"+idw_general.getitemstring(1,'lista_colegiados')+"')"
end if	
if not isnull(sql_aux) then i_sql_nuevo += sql_aux

// Todos los colegiados que tengan un domicilio en la poblaci$$HEX1$$f300$$ENDHEX$$n elegida
if PosA(upper(i_sql_nuevo), "WHERE") > 0 then
	sql_aux = " and colegiados.id_colegiado IN (SELECT id_colegiado FROM domicilios WHERE cod_pob='"+idw_general.getitemstring(1,'cod_pob')+"')"
else
	sql_aux = " WHERE colegiados.id_colegiado IN (SELECT id_colegiado FROM domicilios WHERE cod_pob='"+idw_general.getitemstring(1,'cod_pob')+"')"
end if	

// Julian Melero
if not isnull( idw_general.getitemstring(1,'desc_pob')) then
if PosA(upper(i_sql_nuevo), "WHERE") > 0 then

	sql_aux = "and colegiados.id_colegiado IN (SELECT dom.id_colegiado FROM domicilios dom, poblaciones pob WHERE dom.cod_pob = pob.cod_pob and pob.descripcion like '"+idw_general.getitemstring(1,'desc_pob')+"')"
else
	sql_aux = "WHERE colegiados.id_colegiado IN (SELECT dom.id_colegiado FROM domicilios dom, poblaciones pob WHERE dom.cod_pob = pob.cod_pob and pob.descripcion like '"+idw_general.getitemstring(1,'desc_pob')+"')"
end if	
end if

if not isnull(sql_aux) then i_sql_nuevo += sql_aux

//Los colegiados separados por comas...
if PosA(upper(i_sql_nuevo), "WHERE") > 0 then
	if not isnull(idw_general.getitemstring(1,'otros_colegiados')) then
		i_sql_nuevo = i_sql_nuevo + " and colegiados.n_colegiado IN ("+f_coloca_comillas(idw_general.getitemstring(1,'otros_colegiados'))+")"
	end if
else
	if not isnull(idw_general.getitemstring(1,'otros_colegiados')) then
		i_sql_nuevo = i_sql_nuevo + " WHERE colegiados.n_colegiado IN ("+f_coloca_comillas(idw_general.getitemstring(1,'otros_colegiados'))+")"
	end if
end if

f_sql('aviso','LIKE INSIDE','avisos',idw_general,i_sql_nuevo,'1','Aviso')
f_sql('observaciones','LIKE INSIDE','observ',idw_general,i_sql_nuevo,'1','Observaciones')

// Indicamos que queremos cambiar el idioma
if g_usar_idioma = 'S' then g_idioma.of_cambia_textos(this)
end event

event csd_consulta_profesional();// Agrupaciones
boolean coma
string codigos = '',sql_aux,operador,opcion
string alta,sql_aux2=''
datetime df_inicio,hf_inicio,df_fin,hf_fin
int i

idw_datos_agrupacion.AcceptText()

df_inicio 	= idw_datos_agrupacion.GetItemDatetime(1,'df_inicio')
df_fin 		= idw_datos_agrupacion.GetItemDatetime(1,'df_fin')
hf_inicio 	= idw_datos_agrupacion.GetItemDatetime(1,'hf_inicio')
hf_fin 		= idw_datos_agrupacion.GetItemDatetime(1,'hf_fin')

if not isnull(df_inicio) then sql_aux= sql_aux + " and agrupaciones.f_inicio>='"+string(date(df_inicio),'yyyymmdd')+"'"
if not isnull(hf_inicio) then sql_aux= sql_aux + " and agrupaciones.f_inicio<'"+string(date(hf_inicio),'yyyymmdd')+"'"
if not isnull(df_fin) then sql_aux= sql_aux + " and agrupaciones.f_fin>='"+string(date(df_fin),'yyyymmdd')+"'"
if not isnull(hf_fin) then sql_aux= sql_aux + " and agrupaciones.f_fin<'"+string(date(df_fin),'yyyymmdd')+"'"

//Todos los colegiados que pertenezcan a las agrupaciones elegidas, ya q se pueden elegir varias de una lista
coma=false
opcion = idw_opcion_agr.GetItemString(1,'opcion')
if opcion<>'%' then
	for i=1 to idw_agrupaciones.RowCount()
		if idw_agrupaciones.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_agrupaciones.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
end if

if sql_aux <> '' or codigos <> '' then
	i_sql_nuevo = f_sql_join(i_sql_nuevo, {'colegiados.id_colegiado = agrupaciones.id_colegiado'})
	i_sql_nuevo += sql_aux
	if codigos <> '' then i_sql_nuevo += ' and agrupaciones.agrupacion IN ( '+codigos+')'
end if

//Incompatibilidades
string pob,org
sql_aux=''
pob = idw_datos_sitprof.GetItemString(1,'poblacion')
org = idw_datos_sitprof.GetItemString(1,'organismo')
df_inicio 	= idw_datos_sitprof.GetItemDatetime(1,'df_inicio')
df_fin 		= idw_datos_sitprof.GetItemDatetime(1,'df_fin')
hf_inicio 	= idw_datos_sitprof.GetItemDatetime(1,'hf_inicio')
hf_fin 		= idw_datos_sitprof.GetItemDatetime(1,'hf_fin')

if not f_es_vacio(pob) then sql_aux= sql_aux + " and incompatibilidades.cod_pob like '"+pob+"%'"
if not f_es_vacio(org) then sql_aux= sql_aux + " and incompatibilidades.organismo like'"+org+"%'"
if not isnull(df_inicio) then sql_aux= sql_aux + " and incompatibilidades.fecha_inicio>='"+string(date(df_inicio),'yyyymmdd')+"'"
if not isnull(hf_inicio) then sql_aux= sql_aux + " and incompatibilidades.fecha_inicio<'"+string(date(hf_inicio),'yyyymmdd')+"'"
if not isnull(df_fin) then sql_aux= sql_aux + " and incompatibilidades.fecha_fin>='"+string(date(df_fin),'yyyymmdd')+"'"
if not isnull(hf_fin) then sql_aux= sql_aux + " and incompatibilidades.fecha_fin<'"+string(date(hf_fin),'yyyymmdd')+"'"

//Todos los colegiados que pertenezcan a las Situaciones Profesionales elegidas, ya q se pueden elegir varias de una lista
string codigos_sitprof
opcion = idw_opcion_sitprof.GetItemString(1,'opcion')
coma=false
if opcion<>'%' then
	for i=1 to idw_sit_profesionales.RowCount()
		if idw_sit_profesionales.GetItemString(i,'activo') = 'S' then
			if coma then codigos_sitprof= codigos_sitprof+','
			codigos_sitprof = codigos_sitprof+"'"+idw_sit_profesionales.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
end if

//Todos los colegiados que Tengan las Incompatibilidades elegidas, ya q se pueden elegir varias de una lista
string codigos_incomp
opcion = idw_opcion_incompat.GetItemString(1,'opcion')
if opcion<>'%' then
	coma=false
	for i=1 to idw_incompatibilidades.RowCount()
		if idw_incompatibilidades.GetItemString(i,'activo') = 'S' then
			if coma then codigos_incomp= codigos_incomp+','
			codigos_incomp = codigos_incomp+"'"+idw_incompatibilidades.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
end if
if sql_aux <> '' or codigos_sitprof <> '' or codigos_incomp <> '' then
	i_sql_nuevo = f_sql_join(i_sql_nuevo, {'colegiados.id_colegiado = incompatibilidades.id_colegiado'})
	i_sql_nuevo += sql_aux
	if codigos_sitprof <> '' then i_sql_nuevo += ' and incompatibilidades.tipo_situacion IN ( '+codigos_sitprof+')'
	if codigos_incomp <> '' then i_sql_nuevo += ' and incompatibilidades.tipo_incompatibilidad IN ( '+codigos_incomp+')'	
end if

end event

event csd_consulta_servicios();string foto,firma,operador,sql_aux

foto = idw_servicios.getitemstring(1,'foto')
firma= idw_servicios.getitemstring(1,'firma')
//Cesi$$HEX1$$f300$$ENDHEX$$n de datos:
f_sql('colegiados.per_todos_datos','LIKE','per_todos_datos',idw_servicios,i_sql_nuevo,'1','Permiso para ceder datos a Colegio+Consejo+Terceros')
f_sql('colegiados.per_comer_notel','LIKE','per_comer_notel',idw_servicios,i_sql_nuevo,'1','Permiso para ceder datos a Colegio+Consejo')
f_sql('colegiados.per_comer_sitel','LIKE','per_comer_sitel',idw_servicios,i_sql_nuevo,'1','Permiso ceder informaci$$HEX1$$f300$$ENDHEX$$n sin tel$$HEX1$$e900$$ENDHEX$$fono')
f_sql('colegiados.recibir_c_postales','LIKE','recibir_c_postales',idw_servicios,i_sql_nuevo,'1','Desea recibir circulares impresas')
f_sql('colegiados.recibir_c_email','LIKE','recibir_c_email',idw_servicios,i_sql_nuevo,'1','Desea recibir circulares E-mail')
//f_sql('colegiados.todos_servicios','LIKE','todos_servicios',idw_servicios,i_sql_nuevo,'1','')
f_sql('colegiados.embargo_hacienda','LIKE','embargo_hacienda',idw_servicios,i_sql_nuevo,'1','Embargo Hacienda') // Modificado Ricardo 2005-03-15
f_sql('colegiados.moroso','LIKE','moroso',idw_servicios,i_sql_nuevo,'1','') 
f_sql('colegiados.visible_web','LIKE','visible_web',idw_servicios,i_sql_nuevo,'1','Visible en la web')
f_sql('colegiados.publicidad','LIKE','publicidad',idw_servicios,i_sql_nuevo,'1','Publicidad')

//Comprobamos si el colegiado tiene foto
if foto<>'%' then
	if foto = 'N' then operador = 'NOT' else operador = ''
	if PosA(upper(i_sql_nuevo), "WHERE") > 0  then
		sql_aux = " and colegiados.id_colegiado "+operador+" IN (SELECT id_colegiado from fotos_firmas_colegiados where tipo='O' and activa='S')"
	else
		sql_aux = " WHERE colegiados.id_colegiado "+operador+" IN (SELECT id_colegiado from fotos_firmas_colegiados where tipo='O' and activa='S')"
	end if	
	if not isnull(sql_aux) then i_sql_nuevo += sql_aux
end if

//Comprobamos si tienen firma
if firma<>'%' then
	if firma = 'N' then operador = 'NOT' else operador = ''
	if PosA(upper(i_sql_nuevo), "WHERE") > 0  then
		sql_aux = " and colegiados.id_colegiado "+operador+" IN (SELECT id_colegiado from fotos_firmas_colegiados where tipo='I' and activa='S')"
	else
		sql_aux = " WHERE colegiados.id_colegiado "+operador+" IN (SELECT id_colegiado from fotos_firmas_colegiados where tipo='I' and activa='S')"
	end if	
	if not isnull(sql_aux) then i_sql_nuevo += sql_aux
end if
end event

event csd_consulta_sit_colegial();string codigos,sql_aux,opcion,operador,alta
boolean coma
int i
//Todos los colegiados que pertenezcan a la situaci$$HEX1$$f300$$ENDHEX$$nes elegidas, ya q se pueden elegir varias de una lista

opcion = idw_opcion_sit.GetItemString(1,'opcion')
alta = idw_alta_sn.GetItemString(1,'alta')
if alta<>'%' then
		if PosA(upper(i_sql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.alta_baja = '"+alta+"'"
		else
			sql_aux = "WHERE colegiados.alta_baja = '"+alta+"'"
		end if	
		if not isnull(sql_aux) then i_sql_nuevo += sql_aux
end if
if opcion<>'%'  then
	coma=false
	for i=1 to idw_situaciones.RowCount()
		if idw_situaciones.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_situaciones.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	
	if codigos<>'' then
		if PosA(upper(i_sql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.situacion "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE colegiados.situacion "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then i_sql_nuevo += sql_aux
	end if
end if

//Todos los colegiados que pertenezcan al tipo de alta elegido, ya q se pueden elegir varias de una lista
coma=false
codigos=''
opcion = 'S' //idw_opcion_altas.GetItemString(1,'opcion')

if opcion<>'%' and idw_alta_sn.GetItemString(1,'alta')='S' then
	for i=1 to idw_t_alta.RowCount()
		if idw_t_alta.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_t_alta.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	if codigos<>'' then
		if PosA(upper(i_sql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.t_alta "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE colegiados.t_alta "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then i_sql_nuevo += sql_aux
	end if
end if

//Todos los colegiados que pertenezcan al tipo de baja elegido, ya q se pueden elegir varias de una lista
coma=false
codigos=''
opcion = 'S' //idw_opcion_bajas.GetItemString(1,'opcion')

if opcion<>'%' and idw_alta_sn.GetItemString(1,'alta')='N' then
	for i=1 to idw_t_baja.RowCount()
		if idw_t_baja.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_t_baja.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	if codigos<>'' then
		if PosA(upper(i_sql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.t_baja "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE colegiados.t_baja "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then i_sql_nuevo += sql_aux
	end if
end if
end event

event csd_consulta_otros_datos();int i
datetime fecha
double numero
string s_n,texto,codigo,sql_aux,operador='',codigos
boolean coma, lb_join_otros = false

//Apartado de 'Otros Datos'
for i = 1 to idw_otros_datos.rowcount()
	setnull(fecha)
	setnull(numero)
	sql_aux=''
	codigo = idw_otros_datos.getItemString(i,'codigo')
	fecha = idw_otros_datos.GetItemDatetime(i,'fecha')
	s_n = idw_otros_datos.getItemString(i,'s_n')
	texto = idw_otros_datos.getItemString(i,'texto')
	numero = idw_otros_datos.getItemNumber(i,'numero')
	
	if not f_es_vacio(string(fecha)) then sql_aux = sql_aux + " and fecha = '"+string(fecha, 'mm/dd/yyyy')+"'"
	if not f_es_vacio(texto) then sql_aux = sql_aux + " and texto like '"+texto+"'"
	if not f_es_vacio(string(numero)) then sql_aux = sql_aux + " and numero ="+string(numero)
	if s_n<>'%' then sql_aux= sql_aux + " and s_n like '"+s_n+"'"
	operador=''
	if sql_aux<>'' then
		if PosA(upper(i_sql_nuevo), "WHERE") > 0  then
			sql_aux = " and colegiados.id_colegiado "+operador+" IN (SELECT id_colegiado from otros_datos_colegiado where cod_caracteristica='"+codigo+"'"+sql_aux+")"
		else
			sql_aux = " WHERE colegiados.id_colegiado "+operador+" IN (SELECT id_colegiado from otros_datos_colegiado where cod_caracteristica='"+codigo+"'"+sql_aux+")"
		end if	
		if not isnull(sql_aux) then i_sql_nuevo += sql_aux
	end if
next

//Apartado 'Orientaciones Profesionales'
operador = idw_opcion_orientaciones.GetItemString(1,'opcion')
if operador<>'%' then
	coma=false
	for i=1 to idw_orientaciones.RowCount()
		if idw_orientaciones.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_orientaciones.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next

end if
if codigos <> '' then
	if  dw_listados_varios.GetItemString(dw_listados_varios.GetRow(),'dw') <> 'd_colegiados_listado_orientac_prof_gc' then
		i_sql_nuevo = f_sql_join(i_sql_nuevo, {'colegiados.id_colegiado = orientaciones_profesionales.id_colegiado'})
		if codigos <> '' then i_sql_nuevo += ' and orientaciones_profesionales.orientacion_profesional IN ( '+codigos+')'
	else 
		if PosA(upper(i_sql_nuevo), "UNION") > 0  then
			sql_aux =Mid(i_sql_nuevo,0,PosA(upper(i_sql_nuevo), "UNION")-1)+' and orientaciones_profesionales.orientacion_profesional IN ( '+codigos+')'
			i_sql_nuevo=sql_aux +" "+ Mid(i_sql_nuevo,PosA(upper(i_sql_nuevo), "UNION"),Len (i_sql_nuevo)+1 - PosA(upper(i_sql_nuevo), "UNION"))
	
		end if
	end if
	
end if

end event

event csd_consulta_musaat();string sql_aux, src_alta, src_cober, acci_alta, tasa_alta, tasa_cober, exc_alta, exc_cober
string exc_n_poliza,alta_otros_src,cia_otros_src,peritos_alta,peritos_n_poliza, peritos_cia
double src_bonus_d, src_bonus_h, src_importe_d, src_importe_h, acci_importe_d, acci_importe_h
double tasa_importe_d, tasa_importe_h

// Seguro Responsabilidad Civil
src_alta = idw_musaat.getItemString(1,'src_de_alta')
src_cober = idw_musaat.getItemString(1,'src_cober')
src_bonus_d = idw_musaat.getItemNumber(1,'src_bonus_malus_desde')
src_bonus_h = idw_musaat.getItemNumber(1,'src_bonus_malus_hasta')
exc_alta = idw_musaat.getItemString(1,'exceso_alta')
exc_cober = idw_musaat.getItemString(1,'exceso_cober')
exc_n_poliza = idw_musaat.getItemString(1,'exceso_n_poliza')

// Otros seguros SRC
alta_otros_src = idw_musaat.getItemString(1,'alta_otros_src')
cia_otros_src = idw_musaat.getItemString(1,'cia_otros_src')

// Seguro Accidentes
acci_alta = idw_musaat.getItemString(1,'acci_de_alta')

// Seguro Tasaciones
tasa_alta = idw_musaat.getItemString(1,'tasa_de_alta')
tasa_cober = idw_musaat.getItemString(1,'tasa_cober')

// Seguro Peritos
peritos_alta = idw_musaat.getItemString(1,'peritos_alta')
peritos_n_poliza = idw_musaat.getItemString(1,'peritos_n_poliza')
peritos_cia = idw_musaat.getItemString(1,'peritos_cia')

if (src_alta <> '%') or (f_es_vacio(src_cober) = false) or (f_es_vacio(string(src_bonus_d)) = false ) &
or (f_es_vacio(string(src_bonus_h)) = false ) or (acci_alta <> '%' ) or (tasa_alta <> '%') or (f_es_vacio(tasa_cober)= false) &
or (exc_alta <> '%') or (f_es_vacio(exc_cober) = false) or (f_es_vacio(exc_n_poliza) = false) or (alta_otros_src <> '%') or  (f_es_vacio(cia_otros_src) = false) &
or (f_es_vacio(peritos_n_poliza) = false) or (peritos_alta <> '%') or  (f_es_vacio(peritos_cia)=false) then
	i_sql_nuevo = f_sql_join(i_sql_nuevo, {'( colegiados.id_colegiado = musaat.id_col )'})
end if

// Seguro Responsabilidad Civil
if src_alta <> '%' then i_sql_nuevo += " and ( musaat.src_alta like'"+src_alta+"')"
if not f_es_vacio(src_cober) then i_sql_nuevo += " and ( musaat.src_cober like'"+src_cober+"')"
if not f_es_vacio(string(src_bonus_d)) then i_sql_nuevo += " and ( musaat.src_coef_cm>="+f_cambia_comas_decimales(src_bonus_d)+")"
if not f_es_vacio(string(src_bonus_h)) then i_sql_nuevo += " and ( musaat.src_coef_cm<="+f_cambia_comas_decimales(src_bonus_h)+")"
if exc_alta <> '%' then i_sql_nuevo += " and ( musaat.exceso like'"+exc_alta+"')"
if not f_es_vacio(exc_cober) then i_sql_nuevo += " and ( musaat.exceso_cobertura like'"+exc_cober+"')"
if not f_es_vacio(exc_n_poliza) then i_sql_nuevo += " and ( musaat.exceso_n_poliza like'"+exc_n_poliza+"')"

// Otros seguros SRC
if (alta_otros_src <> '%' or  (f_es_vacio(cia_otros_src) = false)) then
		i_sql_nuevo = f_sql_join(i_sql_nuevo, {'( musaat.id_col = src_colegiado.id_colegiado)'})
		i_sql_nuevo += " and ( src_colegiado.alta like '"+alta_otros_src+"') "
end if 
if (f_es_vacio(cia_otros_src) = false) then i_sql_nuevo += " and ( src_colegiado.src_cia = '" + cia_otros_src + "') "

// Seguro Accidentes
if acci_alta <> '%' then i_sql_nuevo += " and ( musaat.accidentes_alta like'"+acci_alta+"')"

// Seguro Tasaciones
if tasa_alta <> '%' then i_sql_nuevo += " and ( musaat.tasadores_alta like'"+tasa_alta+"')"
if not f_es_vacio(tasa_cober) then i_sql_nuevo += " and ( musaat.tasadores_cober like'"+tasa_cober+"')"

// Seguro Peritos
if peritos_alta <> '%' then i_sql_nuevo += " and ( musaat.peritos_alta like'"+peritos_alta+"')"
if not f_es_vacio(peritos_n_poliza) then i_sql_nuevo += " and ( musaat.peritos_n_poliza like'"+peritos_n_poliza+"')"
if not f_es_vacio(peritos_cia) then i_sql_nuevo += " and ( musaat.peritos_cia like'"+peritos_cia+"')"
end event

event csd_consulta_premaat();string sql_aux, alta, grupo, comple_1, comple_2
double importe_cobrar_d, importe_cobrar_h, importe_pagar_d, importe_pagar_h

alta = idw_premaat.getItemString(1,'alta_total')
grupo = idw_premaat.getItemString(1,'grupo')
comple_1 = idw_premaat.getItemString(1,'comple1')
comple_2 = idw_premaat.getItemString(1,'comple2')
importe_cobrar_d = idw_premaat.getItemNumber(1,'importe_cobrar_desde')
importe_cobrar_h = idw_premaat.getItemNumber(1,'importe_cobrar_hasta')

if ( alta <> '%' ) or (f_es_vacio(grupo) = false) or (comple_1 <> '%') or (comple_2 <> '%') or (f_es_vacio(string(importe_cobrar_d)) = false) &
or (f_es_vacio(string(importe_cobrar_h)) = false) then
	i_sql_nuevo = f_sql_join(i_sql_nuevo, {'( colegiados.id_colegiado = premaat.id_col )'})
end if

if alta <> '%' then i_sql_nuevo += " and ( premaat.alta like'"+alta+"')"
if not f_es_vacio(grupo) then i_sql_nuevo += " and ( premaat.grupo like'"+grupo+"')"
if comple_1 <> '%' then i_sql_nuevo += " and ( premaat.grupo_comple1 like'"+comple_1+"')"
if comple_2 <> '%' then i_sql_nuevo += " and ( premaat.grupo_comple2 like'"+comple_2+"')"
if not f_es_vacio(string(importe_cobrar_d)) then i_sql_nuevo += " and ( premaat.importe_cobrar>="+f_cambia_comas_decimales(importe_cobrar_d)+")"
if not f_es_vacio(string(importe_cobrar_h)) then i_sql_nuevo += " and ( premaat.importe_cobrar<="+f_cambia_comas_decimales(importe_cobrar_h)+")"
end event

event csd_consulta_residente();boolean coma
string codigos,sql_aux,operador,opcion
string alta,sql_aux2=''
int i

//Todos los colegiados que Tengan el residente elegido, ya q se pueden elegir varias de una lista
opcion = idw_opcion_residente.GetItemString(1,'opcion')
if opcion<>'%' then
	if not f_es_vacio(sql_aux2) then sql_aux2 = 'and '+sql_aux2
	coma=false
	for i=1 to idw_residente.RowCount()
		if idw_residente.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_residente.GetItemString(i,'c_geografico')+"'"
			coma = true
		end if
	next
	if codigos<>'' then
		if PosA(upper(i_sql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.c_geografico "+operador+" IN ("+codigos+")" 
		else
			sql_aux = "WHERE colegiados.c_geografico "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then i_sql_nuevo += sql_aux
	end if
end if

// Ejerciente
f_sql('ejerciente','like','ejerciente',idw_ejerciente_sn,i_sql_nuevo,'1','')

end event

event csd_oculta();boolean alta,baja,sit,agr,sitprof,incompat,orient, sitresi
string data
 
//situaciones = idw_opcion_situaciones
//agrupaciones = 
 
sit = (idw_opcion_sit.GetItemString(1,'opcion')='S')
agr = (idw_opcion_agr.GetItemString(1,'opcion')='S')
 
sitprof = (idw_opcion_sitprof.GetItemString(1,'opcion')='S')  
incompat = (idw_opcion_incompat.GetItemString(1,'opcion')='S')
orient = (idw_opcion_orientaciones.GetItemString(1,'opcion')='S') 
 
sitresi = ( idw_opcion_residente.GetItemString(1,'opcion')='S')  
 
idw_situaciones.visible = sit
tab_1.tabpage_4.cb_todos1.visible = sit
tab_1.tabpage_4.cb_borrar1.visible = sit
 
idw_agrupaciones.visible = agr
tab_1.tabpage_5.cb_incluir4.visible = agr
tab_1.tabpage_5.cb_borrar4.visible = agr
 
idw_sit_profesionales.visible = sitprof
tab_1.tabpage_5.cb_3.visible = sitprof
tab_1.tabpage_5.cb_4.visible = sitprof
 
idw_incompatibilidades.visible = incompat
tab_1.tabpage_5.cb_5.visible = incompat
tab_1.tabpage_5.cb_6.visible = incompat
 
idw_orientaciones.visible = orient
tab_1.tabpage_6.cb_7.visible = orient
tab_1.tabpage_6.cb_8.visible = orient
 
idw_residente.visible = sitresi
tab_1.tabpage_10.cb_todos5.visible = sitresi
tab_1.tabpage_10.cb_borrar5.visible = sitresi

data = idw_alta_sn.GetItemString(1,'alta')
choose case data 
 case 'S' 
  alta = true
  baja = false
  //tab_1.tabpage_4.cb_todos2.TriggerEvent(Clicked!)
 case 'N'
  alta = false
  baja = true
  tab_1.tabpage_4.cb_todos3.TriggerEvent(Clicked!)
 case else
  alta = false
  baja = false
end choose
 
tab_1.tabpage_4.gb_3.visible= baja
tab_1.tabpage_4.cb_todos3.visible= baja
tab_1.tabpage_4.cb_borrar3.visible = baja
idw_t_baja.visible = baja
tab_1.tabpage_4.gb_2.visible=alta
tab_1.tabpage_4.cb_todos2.visible=alta
tab_1.tabpage_4.cb_borrar2.visible = alta
idw_t_alta.visible = alta
end event

event csd_listado_peritos_judiciales(datawindow dw_listado);//Rellena el listado de peritos judiciales de zaragoza

int i,li_cuenta
string ls_id_colegiado

setpointer(hourGlass!)

//Rellenamos las columnas falsas

for i=1 to dw_listado.rowcount()
	ls_id_colegiado=dw_listado.getitemstring(i,'id_colegiado')
	
	//Buscamos las agrupaciones
	select count(*) into :li_cuenta from agrupaciones where id_colegiado=:ls_id_colegiado
	and agrupacion='P1';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'P1','S')
	end if
	
	select count(*) into :li_cuenta from agrupaciones where id_colegiado=:ls_id_colegiado
	and agrupacion='P2';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'P2','S')
	end if
	
	select count(*) into :li_cuenta from agrupaciones where id_colegiado=:ls_id_colegiado
	and agrupacion='P3';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'P3','S')
	end if
	
	select count(*) into :li_cuenta from agrupaciones where id_colegiado=:ls_id_colegiado
	and agrupacion='P4';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'P4','S')
	end if
	

	select count(*) into :li_cuenta from agrupaciones where id_colegiado=:ls_id_colegiado
	and agrupacion='P5';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'P5','S')
	end if
	
	select count(*) into :li_cuenta from agrupaciones where id_colegiado=:ls_id_colegiado
	and agrupacion='P6';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'P6','S')
	end if
	
	select count(*) into :li_cuenta from agrupaciones where id_colegiado=:ls_id_colegiado
	and agrupacion='P7';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'P7','S')
	end if
	
	//Ahora las especialidades
	
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='01';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o01','S')
	end if
	
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='02';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o02','S')
	end if
		
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='03';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o03','S')
	end if
		
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='04';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o04','S')
	end if
		
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='05';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o05','S')
	end if
	
next 

end event

event csd_listado_partido_judicial(datawindow dw_listado);//Rellena el listado de un partido judicial de zaragoza

int i,li_cuenta
string ls_id_colegiado

setpointer(hourGlass!)

//Rellenamos las columnas falsas
for i=1 to dw_listado.rowcount()
	ls_id_colegiado=dw_listado.getitemstring(i,'id_colegiado')
			
	//las especialidades
	
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='01';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o01','S')
	end if
	
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='02';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o02','S')
	end if
		
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='03';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o03','S')
	end if
		
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='04';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o04','S')
	end if
		
	select count(*) into :li_cuenta from orientaciones_profesionales where id_colegiado=:ls_id_colegiado
	and orientacion_profesional='05';
	
	if li_cuenta>0 then 
		dw_listado.setitem(i,'o05','S')
	end if
	
next 

end event

event csd_colegiado_listado_peritaje(datawindow dw_listado);//Rellena el listado de peritos judiciales de zaragoza

int i,li_cuenta
string ls_id_colegiado, ls_texto
datetime ldt_fecha

setpointer(hourGlass!)

//Rellenamos las columnas falsas

for i=1 to dw_listado.rowcount()
	ls_id_colegiado=dw_listado.getitemstring(i,'otros_datos_colegiado_id_colegiado')
	
	ls_texto = ""
	//Buscamos las definiciones de los conceptos para las caracter$$HEX1$$ed00$$ENDHEX$$sticas seleccionadas
	// FECHA DE DESIGNACION
	  SELECT otros_datos_colegiado.fecha  
    INTO :ldt_fecha  
    FROM otros_conceptos,   
         otros_datos_colegiado  
   WHERE ( otros_conceptos.codigo = otros_datos_colegiado.cod_caracteristica ) and  
         ( ( otros_datos_colegiado.id_colegiado = :ls_id_colegiado ) AND  
         ( otros_datos_colegiado.cod_caracteristica = 'PF' ) )   ;

	
	if  not isnull(ldt_fecha) then 
		dw_listado.setitem(i,'f_desig',string(date(ldt_fecha)))
	end if
	
	ls_texto = ""
	//NRO. DE JUZGADO
	  SELECT otros_datos_colegiado.texto  
    INTO :ls_texto  
    FROM otros_conceptos,   
         otros_datos_colegiado  
   WHERE ( otros_conceptos.codigo = otros_datos_colegiado.cod_caracteristica ) and  
         ( ( otros_datos_colegiado.id_colegiado = :ls_id_colegiado ) AND  
         ( otros_datos_colegiado.cod_caracteristica = 'NJ' ) )   ;
	if ls_texto <>"" then 
		dw_listado.setitem(i,'n_juzgado',ls_texto)
	end if	

	ls_texto = ""
	//NRO. DE AUTO	
	SELECT otros_datos_colegiado.texto  
    INTO :ls_texto  
    FROM otros_conceptos,   
         otros_datos_colegiado  
   WHERE ( otros_conceptos.codigo = otros_datos_colegiado.cod_caracteristica ) and  
         ( ( otros_datos_colegiado.id_colegiado = :ls_id_colegiado ) AND  
         ( otros_datos_colegiado.cod_caracteristica = 'NA' ) )   ;
	if ls_texto <>"" then 
		dw_listado.setitem(i,'n_auto',ls_texto)
	end if	
	
	ls_texto = ""
	//FECHA DE PRESENTACI$$HEX1$$d300$$ENDHEX$$N	
	SELECT otros_datos_colegiado.fecha  
    INTO :ldt_fecha  
    FROM otros_conceptos,   
         otros_datos_colegiado  
   WHERE ( otros_conceptos.codigo = otros_datos_colegiado.cod_caracteristica ) and  
         ( ( otros_datos_colegiado.id_colegiado = :ls_id_colegiado ) AND  
         ( otros_datos_colegiado.cod_caracteristica = 'FP' ) )   ;
			
	if not isnull(ldt_fecha) then 
		dw_listado.setitem(i,'f_present',string(date(ldt_fecha)))
	end if		
	
	ls_texto = ""
	//SITUACI$$HEX1$$d300$$ENDHEX$$N
	SELECT otros_datos_colegiado.texto  
    INTO :ls_texto  
    FROM otros_conceptos,   
         otros_datos_colegiado  
   WHERE ( otros_conceptos.codigo = otros_datos_colegiado.cod_caracteristica ) and  
         ( ( otros_datos_colegiado.id_colegiado = :ls_id_colegiado ) AND  
         ( otros_datos_colegiado.cod_caracteristica = 'SI' ) )   ;
	if ls_texto <>"" then 
		dw_listado.setitem(i,'situacion',ls_texto)
	end if		
	
	
next 

end event

on w_colegiados_listados.create
int iCurrent
call super::create
this.gb_12=create gb_12
this.tab_1=create tab_1
this.rb_num_col=create rb_num_col
this.rb_apellidos=create rb_apellidos
this.rb_cp=create rb_cp
this.rb_nif=create rb_nif
this.rb_1=create rb_1
this.rb_2=create rb_2
this.gb_11=create gb_11
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.gb_12
this.Control[iCurrent+2]=this.tab_1
this.Control[iCurrent+3]=this.rb_num_col
this.Control[iCurrent+4]=this.rb_apellidos
this.Control[iCurrent+5]=this.rb_cp
this.Control[iCurrent+6]=this.rb_nif
this.Control[iCurrent+7]=this.rb_1
this.Control[iCurrent+8]=this.rb_2
this.Control[iCurrent+9]=this.gb_11
end on

on w_colegiados_listados.destroy
call super::destroy
destroy(this.gb_12)
destroy(this.tab_1)
destroy(this.rb_num_col)
destroy(this.rb_apellidos)
destroy(this.rb_cp)
destroy(this.rb_nif)
destroy(this.rb_1)
destroy(this.rb_2)
destroy(this.gb_11)
end on

event open;call super::open;int i


// Indicamos que queremos cambiar el idioma
/*gnv_string = create u_csd_string
if g_usar_idioma = 'S' then g_idioma.of_cambia_textos(this)*/

dw_listados_varios.SetTrans(sqlca)
dw_listados_varios.retrieve(this.classname())
dw_listados_varios.SetRow(1)   

// Se desplaza el apuntador al primer registro
dw_listados_varios.scrolltorow(1)
dw_listados_varios.setfocus()

inv_resize.of_Register (cb_recuperar_pantalla, "Fixedtotop")

// Le quitamos el foco al campo E/S, se seleccionar$$HEX2$$e1002000$$ENDHEX$$en f(tipo de listado)
//dw_listados.SetTabOrder('es_listados',0)

f_centrar_ventana(this) 

idw_general = tab_1.tabpage_1.dw_datos_personales
idw_fechas = tab_1.tabpage_2.dw_fechas
idw_servicios =tab_1.tabpage_3.dw_servicios
idw_situaciones = tab_1.tabpage_4.dw_situaciones
idw_t_alta = tab_1.tabpage_4.dw_t_alta
idw_t_baja = tab_1.tabpage_4.dw_t_baja
idw_alta_sn = tab_1.tabpage_4.dw_alta_si_no
idw_agrupaciones = tab_1.tabpage_5.dw_agrupaciones
idw_datos_agrupacion = tab_1.tabpage_5.dw_datos_agrupacion
idw_sit_profesionales = tab_1.tabpage_5.dw_sit_profesionales 
idw_datos_sitprof = tab_1.tabpage_5.dw_datos_sitprof
idw_incompatibilidades = tab_1.tabpage_5.dw_incompatibilidades
idw_otros_datos = tab_1.tabpage_6.dw_otros_datos
idw_orientaciones = tab_1.tabpage_6.dw_consulta_orientaciones
idw_musaat = tab_1.tabpage_7.dw_datos_musaat
idw_premaat = tab_1.tabpage_8.dw_datos_premaat
idw_residente = tab_1.tabpage_10.dw_residente
idw_ejerciente_sn	= tab_1.tabpage_10.dw_ejerciente_si_no

idw_opcion_residente = tab_1.tabpage_10.dw_opcion_residente
idw_opcion_sit = tab_1.tabpage_4.dw_opcion_situaciones
idw_opcion_altas = tab_1.tabpage_4.dw_opcion_altas
idw_opcion_bajas = tab_1.tabpage_4.dw_opcion_bajas
idw_opcion_agr	  = tab_1.tabpage_5.dw_opcion_agr
idw_opcion_sitprof   = tab_1.tabpage_5.dw_opcion_sit
idw_opcion_incompat = tab_1.tabpage_5.dw_opcion_incomp
idw_opcion_orientaciones = tab_1.tabpage_6.dw_opciones_orientaciones

idw_opcion_sit.insertrow(1)
idw_opcion_altas.insertrow(1)
idw_opcion_bajas.insertrow(1)
idw_opcion_agr.insertrow(1)
idw_opcion_sitprof.insertrow(1)
idw_opcion_incompat.insertrow(1)
idw_general.InsertRow(1)
idw_fechas.InsertRow(1)
idw_servicios.InsertRow(1)
idw_datos_agrupacion.InsertRow(1)
idw_datos_sitprof.InsertRow(1)
idw_opcion_orientaciones.InsertRow(1)
idw_alta_sn.InsertRow(1)
idw_musaat.InsertRow(1)
idw_premaat.InsertRow(1)
idw_opcion_residente.insertrow(1)
idw_ejerciente_sn.insertrow(1)

idw_residente.retrieve()
idw_situaciones.Retrieve()
idw_t_alta.Retrieve()
idw_t_baja.Retrieve()
idw_agrupaciones.retrieve()
idw_incompatibilidades.retrieve()
idw_sit_profesionales.retrieve()
idw_otros_datos.retrieve()
idw_orientaciones.retrieve()
end event

event pfc_postopen;call super::pfc_postopen;this.event csd_oculta()		



end event

type cb_recuperar_pantalla from w_listados`cb_recuperar_pantalla within w_colegiados_listados
boolean visible = true
integer x = 37
integer y = 2076
integer width = 503
integer height = 96
string text = "&Recuperar Consulta"
end type

event cb_recuperar_pantalla::clicked;call super::clicked;parent.event csd_oculta()
end event

type cb_guardar_pantalla from w_listados`cb_guardar_pantalla within w_colegiados_listados
integer x = 3616
integer y = 1888
integer width = 503
integer height = 96
string text = "&Guardar Consulta"
end type

type cb_limpiar from w_listados`cb_limpiar within w_colegiados_listados
integer x = 3616
integer y = 1964
integer textsize = -8
end type

type dw_listados_varios from w_listados`dw_listados_varios within w_colegiados_listados
integer x = 2743
integer y = 160
integer width = 887
integer height = 1504
end type

type cb_ver from w_listados`cb_ver within w_colegiados_listados
end type

event cb_ver::clicked;call super::clicked;string listado,lista,miembro,sql_aux,codigos,sql_fin
int indice,li_mes
long i
boolean coma

g_ultima_consulta = ''
g_parametros_listados=''
g_etiquetas_listados=''
dw_1.accepttext()
dw_listados.accepttext()
idw_general.AcceptText()
idw_fechas.AcceptText()
idw_servicios.AcceptText()
idw_situaciones.AcceptText()
idw_t_alta.AcceptText()
idw_t_baja.AcceptText()
idw_agrupaciones.AcceptText()
idw_datos_agrupacion.AcceptText()
idw_sit_profesionales.AcceptText()
idw_incompatibilidades.AcceptText()
idw_datos_sitprof.AcceptText()
idw_otros_datos.AcceptText()
idw_orientaciones.AcceptText()
idw_musaat.AcceptText()
idw_premaat.AcceptText()
idw_residente.AcceptText()

dw_1.of_setprintpreview(TRUE)

// Asignar objeto dw en funcion de la fila seleccionada de la dw dw_listados_varios
listado = dw_listados_varios.GetItemString(dw_listados_varios.GetRow(),'dw')
dw_1.dataobject = listado
indice = dw_listados_varios.GetRow()

dw_1.of_SetTransObject(SQLCA)
i_sql_nuevo = dw_1.describe("datawindow.table.select")
SetPointer(HourGlass!)

//if listado = 'd_colegiado_listado_altabaja_mca' then
//	if isnull(idw_fechas.GetItemDatetime(1,'f_alta_desde')) or isnull(idw_fechas.GetItemDatetime(1,'f_alta_hasta')) or & 
//	isnull(idw_fechas.GetItemDatetime(1,'f_baja_desde')) or isnull(idw_fechas.GetItemDatetime(1,'f_baja_hasta')) then
//	
//		messagebox(g_titulo,'Debe Ingresar un periodo de fecha Alta y Baja')
//		return -1
//	end if

//end if
	parent.TriggerEvent('csd_consulta_general')
	parent.TriggerEvent('csd_consulta_fechas')
	parent.TriggerEvent('csd_consulta_sit_colegial')
	parent.TriggerEvent('csd_consulta_servicios')
	parent.TriggerEvent('csd_consulta_profesional')
	parent.TriggerEvent('csd_consulta_otros_datos')
	parent.TriggerEvent('csd_consulta_musaat')
	parent.TriggerEvent('csd_consulta_premaat')
	parent.TriggerEvent('csd_consulta_residente')

//FIN CODIGO TRASLADADO DE CONSULTA
//messagebox('kk', i_sql_nuevo)
dw_1.SetTransobject(sqlca)

// Miramos el permiso para ver colegiados de baja (INC.8779)
// Si est$$HEX2$$e1002000$$ENDHEX$$como lectura (denegado) modificamos la sql, si no est$$HEX2$$e1002000$$ENDHEX$$en la lista o est$$HEX2$$e1002000$$ENDHEX$$como escritura no hacemos nada
int n_reg
select count(*) into :n_reg from t_permisos where cod_usuario = :g_usuario and cod_aplicacion = 'PCOLBAJA00' and permiso = 'L' ;
if n_reg > 0 then 
	if PosA(upper(i_sql_nuevo), "WHERE") > 0  then
		i_sql_nuevo += " AND colegiados.alta_baja = 'S'"
	else
		i_sql_nuevo += "WHERE colegiados.alta_baja = 'S'"
	end if
end if

dw_1.Modify("DataWindow.Table.Select= ~"" + i_sql_nuevo + "~"")
//messagebox("Sql",i_sql_nuevo)
if (listado =  'd_colegiados_listado_completo_exportable') then
	if ( rb_1.Checked = TRUE) then
		dw_1.retrieve('S')
	else
		dw_1.retrieve('N')
	end if	
else
	dw_1.retrieve()
end if

//Andr$$HEX1$$e900$$ENDHEX$$s 07/07/2005: Algunos listados hay que rellenarlos parcialmente con un evento

if listado='d_colegiados_listado_peritos_jud_za' or listado = 'd_colegiados_listado_peritos_jud_za_web' then
	event csd_listado_peritos_judiciales(dw_1)
end if

if listado='d_colegiados_listado_peritaje' then
	event csd_colegiado_listado_peritaje(dw_1)
end if

if LeftA(listado,32)='d_colegiados_listado_partido_jud' then
	event csd_listado_partido_judicial(dw_1)
end if

if dw_1.rowcount() > 0 then
	// En este caso no le dejamos que aplique 
	if listado <> 'd_colegiados_listado_etiquetas_gc' and listado <> 'd_colegiados_listado_soc_coleg' and &
		listado <> 'd_colegiados_listado_orientaciones_prof' and listado <> 'd_colegiados_listado_orient_prof_za' and &
		listado <> 'd_colegiados_listado_etiquetas_por_cp_bu' and listado <> 'd_colegiado_listado_altabaja_mca'  and &
		listado <> 'd_colegiados_listados_reclamacion_dat_mca' then
//		string orden
//		orden = dw_1.Describe ("DataWindow.Table.Sort")
		if rb_num_col.checked = TRUE then
			int j
			j = dw_1.SetSort("n_colegiado A")
			dw_1.Sort()
			dw_1.groupcalc()
		end if
		if rb_apellidos.checked = TRUE then
			j = dw_1.SetSort("apellidos A, nombre A")
			dw_1.Sort()
			dw_1.groupcalc()		
		end if
		if rb_cp.checked = TRUE then
			j = dw_1.SetSort("poblacion_activa A")
			dw_1.Sort()
			dw_1.groupcalc()		
		end if
		if rb_nif.checked = TRUE then
			j = dw_1.SetSort("nif A")
			dw_1.Sort()
			dw_1.groupcalc()		
		end if		
	end if	
	
	if listado = 'd_colegiados_listados_reclamacion_dat_mca' then
		if isnull(idw_fechas.GetItemDatetime(1,'f_alta_desde')) and &
		   isnull(idw_fechas.GetItemDatetime(1,'f_alta_hasta')) then
		   li_mes = Month(date(today()))
		   for i = 1 to dw_1.RowCount() 
			   dw_1.Setitem(i,'mes',li_mes)
		   next
	     else
		   li_mes = Month(date(idw_fechas.GetItemDatetime(1,'f_alta_desde')))
		for i = 1 to dw_1.RowCount() 
			dw_1.Setitem(i,'mes',li_mes)
			next
	end if
		
	end if

	if listado = 'd_colegiados_listado_etiquetas_por_cp_bu' then
		dw_1.SetSort("poblacion_activa A, apellidos A, nombre A")
		dw_1.Sort()
		dw_1.groupcalc()			
	end if
	
	if listado = 'd_colegiado_listado_por_municipio' then
		dw_1.SetSort("poblacion_activa A, apellidos A, nombre A")
		dw_1.Sort()
		dw_1.groupcalc()			
	end if
	
	if listado = 'd_colegiado_listado_por_sexo' then
		dw_1.SetSort("sexo A, apellidos A, nombre A")
		dw_1.Sort()
		dw_1.groupcalc()		
		
		dw_1.setfilter("sexo='M' or sexo='F'")
		dw_1.filter()		
	end if	
	
	if listado = 'd_colegiado_listado_por_edad' then
		dw_1.SetSort("tramo_edad A, apellidos A, nombre A")
		dw_1.Sort()
		dw_1.groupcalc()		
		
		dw_1.setfilter("tramo_edad >=20")
		dw_1.filter()
	end if		
	
if listado ='d_colegiado_listado_resumen_col'  then
//


int r, posini,posadd
string  sql_parcial ,nombre,numero,sql_oldi,sql_inject
sql_oldi=dw_1.describe("datawindow.table.select")
datawindowchild dwc
datastore id_guardar0,id_guardar

id_guardar= CREATE datastore
id_guardar.dataobject = 'd_colegiado_listado_resumen_col_nested_x' 
id_guardar.settransobject(SQLCA)

id_guardar0= CREATE datastore
id_guardar0.dataobject = 'd_colegiado_listado_resumen_col_x' 
id_guardar0.settransobject(SQLCA)
dw_1.GetChild("dw_1", dwc)



if Pos(upper(sql_oldi), " WHERE ")>0 then
	posini=Pos(upper(sql_oldi)," WHERE ")+6
	posadd= len(sql_oldi)-(Pos(upper(sql_oldi), " WHERE ")+6)
	i_sql_nuevo = mid(sql_oldi,posini ,posadd)
	
	sql_parcial =id_guardar0.describe("datawindow.table.select")
	sql_parcial +=" and "+i_sql_nuevo
	id_guardar0.Modify("DataWindow.Table.Select= ~"" +sql_parcial+ "~"")


	
	sql_parcial =id_guardar.describe("datawindow.table.select")
	sql_parcial +=" where "+i_sql_nuevo
	id_guardar.Modify("DataWindow.Table.Select= ~"" +sql_parcial+ "~"")
	end if
	id_guardar0.retrieve()
	id_guardar.retrieve()
	dwc.reset()	
	
	id_guardar0.RowsCopy(1, id_guardar0.ROWCOUNT(), Primary!, dwc, 1, Primary!)
	dw_1.object.t_14.text=string(id_guardar.GetItemNumber(1,"compute_5"))
	dw_1.object.t_15.text=string(id_guardar.GetItemNumber(1,"compute_23"))
	dw_1.object.t_16.text=string(id_guardar.GetItemNumber(1,"compute_28"))
	dw_1.object.t_17.text=string(id_guardar.GetItemNumber(1,"compute_34"))
	
	dw_1.object.t_18.text=string(id_guardar.GetItemNumber(1,"compute_6"))
	dw_1.object.t_19.text=string(id_guardar.GetItemNumber(1,"compute_24"))
	dw_1.object.t_20.text=string(id_guardar.GetItemNumber(1,"compute_30"))
	dw_1.object.t_21.text=string(id_guardar.GetItemNumber(1,"compute_35"))
	
	dw_1.object.t_22.text=string(id_guardar.GetItemNumber(1,"compute_7"))
	dw_1.object.t_23.text=string(id_guardar.GetItemNumber(1,"compute_32"))
	dw_1.object.t_24.text=string(id_guardar.GetItemNumber(1,"compute_29"))
	dw_1.object.t_25.text=string(id_guardar.GetItemNumber(1,"compute_36"))
	
	dw_1.object.t_26.text=string(id_guardar.GetItemNumber(1,"compute_10"))
	dw_1.object.t_27.text=string(id_guardar.GetItemNumber(1,"compute_25"))
	dw_1.object.t_28.text=string(id_guardar.GetItemNumber(1,"compute_31"))
	dw_1.object.t_29.text=string(id_guardar.GetItemNumber(1,"compute_37"))
	
	dw_1.object.t_30.text=string(id_guardar.GetItemNumber(1,"compute_11"))
	dw_1.object.t_31.text=string(id_guardar.GetItemNumber(1,"compute_26"))
	dw_1.object.t_32.text=string(id_guardar.GetItemNumber(1,"compute_27"))
	dw_1.object.t_33.text=string(id_guardar.GetItemNumber(1,"compute_38"))
	
	dw_1.object.t_34.text=string(id_guardar.GetItemNumber(1,"compute_8"))
	dw_1.object.t_35.text=string(id_guardar.GetItemNumber(1,"compute_9"))
	dw_1.object.t_36.text=string(id_guardar.GetItemNumber(1,"compute_39"))
	dw_1.object.t_37.text=string(id_guardar.GetItemNumber(1,"compute_40"))
	






		

//




end if

	
	
	dw_1.visible 		  = true                                    
	// No tiene reports y no son etiquetas, hacemos el preview
	if dw_1.Describe("DataWindow.Nested") = "no" and dw_1.describe("Datawindow.Label.Columns") = "0" then
		dw_1.event pfc_printpreview()
	end if
	if dw_1.describe("t_parametros.name") = "t_parametros" then dw_1.object.t_parametros.text = g_ultima_consulta	
	this.enabled        = false
	cb_zoom.enabled     = true
	cb_imprimir.enabled = true
	cb_guardar.enabled  = true
	cb_escala.enabled  = true
	cb_ordenar.enabled  = true
else
	messagebox(g_titulo,'No se han encontrado registros seg$$HEX1$$fa00$$ENDHEX$$n las especificaciones.')
end if

end event

type cb_salir from w_listados`cb_salir within w_colegiados_listados
end type

type dw_listados from w_listados`dw_listados within w_colegiados_listados
event csd_situaciones_colegiales ( )
integer x = 3026
integer y = 764
integer width = 119
integer height = 100
end type

event dw_listados::csd_oculta;call super::csd_oculta;string listado
listado = dw_listados_varios.GetItemString(dw_listados_varios.GetRow(),'dw')

choose case listado
	case 'd_colegiados_listado_completo_exportable'
		gb_12.visible = true;
		rb_1.visible = true;
		rb_2.visible = true;

	case else 
		gb_12.visible = false;
		rb_1.visible = false;
		rb_2.visible = false;
end choose
end event

type cb_imprimir from w_listados`cb_imprimir within w_colegiados_listados
end type

type cb_zoom from w_listados`cb_zoom within w_colegiados_listados
end type

type cb_esp from w_listados`cb_esp within w_colegiados_listados
end type

type cb_guardar from w_listados`cb_guardar within w_colegiados_listados
end type

type cb_escala from w_listados`cb_escala within w_colegiados_listados
end type

type cb_ordenar from w_listados`cb_ordenar within w_colegiados_listados
end type

type dw_listados_titulo from w_listados`dw_listados_titulo within w_colegiados_listados
integer x = 37
integer y = 2192
integer height = 108
end type

type dw_1 from w_listados`dw_1 within w_colegiados_listados
integer width = 3625
integer height = 2128
end type

type gb_12 from groupbox within w_colegiados_listados
string tag = "texto=general.ordenar_por"
integer x = 3214
integer y = 1672
integer width = 448
integer height = 376
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Email"
end type

type tab_1 from tab within w_colegiados_listados
event create ( )
event destroy ( )
integer x = 37
integer y = 156
integer width = 2683
integer height = 1888
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long backcolor = 79741120
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabpage_1 tabpage_1
tabpage_2 tabpage_2
tabpage_3 tabpage_3
tabpage_4 tabpage_4
tabpage_5 tabpage_5
tabpage_10 tabpage_10
tabpage_6 tabpage_6
tabpage_7 tabpage_7
tabpage_8 tabpage_8
end type

on tab_1.create
this.tabpage_1=create tabpage_1
this.tabpage_2=create tabpage_2
this.tabpage_3=create tabpage_3
this.tabpage_4=create tabpage_4
this.tabpage_5=create tabpage_5
this.tabpage_10=create tabpage_10
this.tabpage_6=create tabpage_6
this.tabpage_7=create tabpage_7
this.tabpage_8=create tabpage_8
this.Control[]={this.tabpage_1,&
this.tabpage_2,&
this.tabpage_3,&
this.tabpage_4,&
this.tabpage_5,&
this.tabpage_10,&
this.tabpage_6,&
this.tabpage_7,&
this.tabpage_8}
end on

on tab_1.destroy
destroy(this.tabpage_1)
destroy(this.tabpage_2)
destroy(this.tabpage_3)
destroy(this.tabpage_4)
destroy(this.tabpage_5)
destroy(this.tabpage_10)
destroy(this.tabpage_6)
destroy(this.tabpage_7)
destroy(this.tabpage_8)
end on

type tabpage_1 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 100
integer width = 2647
integer height = 1772
long backcolor = 79741120
string text = "General"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_datos_personales dw_datos_personales
end type

on tabpage_1.create
this.dw_datos_personales=create dw_datos_personales
this.Control[]={this.dw_datos_personales}
end on

on tabpage_1.destroy
destroy(this.dw_datos_personales)
end on

type dw_datos_personales from u_dw within tabpage_1
integer x = 101
integer y = 44
integer width = 2171
integer height = 1724
integer taborder = 40
string dataobject = "d_colegiados_consulta_datos_personales"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event buttonclicked;call super::buttonclicked;string pob,codigos=''
int i

CHOOSE CASE dwo.name
	CASE 'b_poblacion'
		
		g_busqueda.titulo='Poblaciones'
		g_busqueda.dw='d_poblaciones_lista_busqueda'
		pob=f_busqueda_poblaciones()
		if f_es_vacio(pob) then return
		this.SetItem(row,'cod_pob',pob)
	case 'b_listas'
		Open(w_listas_seleccion)
		this.SetItem(1,'lista_colegiados',Message.Stringparm)
		
				
END CHOOSE

end event

type tabpage_2 from userobject within tab_1
event create ( )
event destroy ( )
string tag = "texto=general.fechas"
integer x = 18
integer y = 100
integer width = 2647
integer height = 1772
long backcolor = 79741120
string text = "Fechas"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_fechas dw_fechas
end type

on tabpage_2.create
this.dw_fechas=create dw_fechas
this.Control[]={this.dw_fechas}
end on

on tabpage_2.destroy
destroy(this.dw_fechas)
end on

type dw_fechas from u_dw within tabpage_2
integer x = 105
integer y = 116
integer width = 2139
integer height = 744
integer taborder = 40
string dataobject = "d_colegiados_consulta_fechas"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event constructor;call super::constructor;this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)


this.setformat('f_alta_desde','dd/mm/yyyy')
this.setformat('f_baja_desde','dd/mm/yyyy')
this.setformat('f_colegiacion_desde','dd/mm/yyyy')
this.setformat('f_titulacion_desde','dd/mm/yyyy')
this.setformat('f_nacimiento_desde','dd/mm/yyyy')

this.setformat('f_alta_hasta','dd/mm/yyyy')
this.setformat('f_baja_hasta','dd/mm/yyyy')
this.setformat('f_colegiacion_hasta','dd/mm/yyyy')
this.setformat('f_titulacion_hasta','dd/mm/yyyy')
this.setformat('f_nacimiento_hasta','dd/mm/yyyy')
this.PostEvent('csd_oculta')
end event

type tabpage_3 from userobject within tab_1
event create ( )
event destroy ( )
string tag = "texto=general.secretaria"
integer x = 18
integer y = 100
integer width = 2647
integer height = 1772
long backcolor = 79741120
string text = "Secretar$$HEX1$$ed00$$ENDHEX$$a"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_servicios dw_servicios
end type

on tabpage_3.create
this.dw_servicios=create dw_servicios
this.Control[]={this.dw_servicios}
end on

on tabpage_3.destroy
destroy(this.dw_servicios)
end on

type dw_servicios from u_dw within tabpage_3
integer x = 59
integer y = 36
integer width = 2281
integer height = 1412
integer taborder = 40
string dataobject = "d_colegiados_consulta_otros_servicios"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

type tabpage_4 from userobject within tab_1
event create ( )
event destroy ( )
string tag = "texto=colegiados.sit_colegial"
integer x = 18
integer y = 100
integer width = 2647
integer height = 1772
long backcolor = 79741120
string text = "Sit.Colegial"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_alta_si_no dw_alta_si_no
cb_borrar1 cb_borrar1
cb_todos1 cb_todos1
dw_situaciones dw_situaciones
dw_t_alta dw_t_alta
dw_t_baja dw_t_baja
cb_todos2 cb_todos2
cb_borrar2 cb_borrar2
cb_todos3 cb_todos3
cb_borrar3 cb_borrar3
cbx_alta cbx_alta
cbx_baja cbx_baja
dw_opcion_situaciones dw_opcion_situaciones
dw_opcion_altas dw_opcion_altas
dw_opcion_bajas dw_opcion_bajas
gb_1 gb_1
gb_2 gb_2
gb_3 gb_3
end type

on tabpage_4.create
this.dw_alta_si_no=create dw_alta_si_no
this.cb_borrar1=create cb_borrar1
this.cb_todos1=create cb_todos1
this.dw_situaciones=create dw_situaciones
this.dw_t_alta=create dw_t_alta
this.dw_t_baja=create dw_t_baja
this.cb_todos2=create cb_todos2
this.cb_borrar2=create cb_borrar2
this.cb_todos3=create cb_todos3
this.cb_borrar3=create cb_borrar3
this.cbx_alta=create cbx_alta
this.cbx_baja=create cbx_baja
this.dw_opcion_situaciones=create dw_opcion_situaciones
this.dw_opcion_altas=create dw_opcion_altas
this.dw_opcion_bajas=create dw_opcion_bajas
this.gb_1=create gb_1
this.gb_2=create gb_2
this.gb_3=create gb_3
this.Control[]={this.dw_alta_si_no,&
this.cb_borrar1,&
this.cb_todos1,&
this.dw_situaciones,&
this.dw_t_alta,&
this.dw_t_baja,&
this.cb_todos2,&
this.cb_borrar2,&
this.cb_todos3,&
this.cb_borrar3,&
this.cbx_alta,&
this.cbx_baja,&
this.dw_opcion_situaciones,&
this.dw_opcion_altas,&
this.dw_opcion_bajas,&
this.gb_1,&
this.gb_2,&
this.gb_3}
end on

on tabpage_4.destroy
destroy(this.dw_alta_si_no)
destroy(this.cb_borrar1)
destroy(this.cb_todos1)
destroy(this.dw_situaciones)
destroy(this.dw_t_alta)
destroy(this.dw_t_baja)
destroy(this.cb_todos2)
destroy(this.cb_borrar2)
destroy(this.cb_todos3)
destroy(this.cb_borrar3)
destroy(this.cbx_alta)
destroy(this.cbx_baja)
destroy(this.dw_opcion_situaciones)
destroy(this.dw_opcion_altas)
destroy(this.dw_opcion_bajas)
destroy(this.gb_1)
destroy(this.gb_2)
destroy(this.gb_3)
end on

type dw_alta_si_no from u_dw within tabpage_4
integer x = 905
integer y = 60
integer width = 955
integer height = 136
integer taborder = 50
string dataobject = "d_colegiados_consulta_alta"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;boolean alta,baja

choose case data 
	case 'S' 
		alta = true
		baja = false
		cb_todos2.TriggerEvent(Clicked!)
	case 'N'
		alta = false
		baja = true
		cb_todos3.TriggerEvent(Clicked!)
	case else
		alta = false
		baja = false
end choose
gb_3.visible= baja
cb_todos3.visible= baja
cb_borrar3.visible = baja
idw_t_baja.visible = baja
gb_2.visible=alta
cb_todos2.visible=alta
cb_borrar2.visible = alta
idw_t_alta.visible = alta
		
end event

type cb_borrar1 from commandbutton within tabpage_4
boolean visible = false
integer x = 343
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_situaciones.rowcount() 
	idw_situaciones.SetItem(i,'activo','N')
next
end event

type cb_todos1 from commandbutton within tabpage_4
boolean visible = false
integer x = 14
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_situaciones.rowcount() 
	idw_situaciones.SetItem(i,'activo','S')
next
end event

type dw_situaciones from u_dw within tabpage_4
boolean visible = false
integer x = 32
integer y = 232
integer width = 800
integer height = 1296
integer taborder = 20
string dataobject = "d_colegiados_situaciones_consulta"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;string opcion

opcion = idw_opcion_sit.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_sit.SetItem(1,'opcion','S')
end event

type dw_t_alta from u_dw within tabpage_4
boolean visible = false
integer x = 928
integer y = 280
integer width = 800
integer height = 1240
integer taborder = 20
string dataobject = "d_colegiados_t_alta_consulta"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;string opcion

opcion = idw_opcion_altas.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_altas.SetItem(1,'opcion','S')
end event

type dw_t_baja from u_dw within tabpage_4
boolean visible = false
integer x = 1797
integer y = 276
integer width = 823
integer height = 1244
integer taborder = 20
string dataobject = "d_colegiados_t_baja_consulta"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;string opcion

opcion = idw_opcion_bajas.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_bajas.SetItem(1,'opcion','S')
end event

type cb_todos2 from commandbutton within tabpage_4
boolean visible = false
integer x = 901
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_situaciones.rowcount() 
	idw_t_alta.SetItem(i,'activo','S')
next
end event

type cb_borrar2 from commandbutton within tabpage_4
boolean visible = false
integer x = 1230
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_situaciones.rowcount() 
	idw_t_alta.SetItem(i,'activo','N')
next
end event

type cb_todos3 from commandbutton within tabpage_4
boolean visible = false
integer x = 1787
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_t_baja.rowcount() 
	idw_t_baja.SetItem(i,'activo','S')
next
end event

type cb_borrar3 from commandbutton within tabpage_4
boolean visible = false
integer x = 2117
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_t_baja.rowcount() 
	idw_t_baja.SetItem(i,'activo','N')
next
end event

type cbx_alta from checkbox within tabpage_4
integer x = -59
integer y = -556
integer width = 343
integer height = 64
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Alta"
boolean checked = true
end type

event clicked;if this.checked=true then
	cb_todos2.Event Clicked()
	cb_borrar2.enabled=true
	cb_todos2.enabled=true
	idw_t_alta.enabled=true
else
	cb_borrar2.event Clicked()
	cb_borrar2.enabled=false
	cb_todos2.enabled=false
	idw_t_alta.enabled=false
end if

end event

type cbx_baja from checkbox within tabpage_4
integer x = -59
integer y = -556
integer width = 402
integer height = 64
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Baja"
end type

event clicked;if this.checked=true then
	cb_todos3.Event Clicked()
	cb_borrar3.enabled=true
	cb_todos3.enabled=true
	idw_t_baja.enabled=true
else
	cb_borrar3.event Clicked()
	cb_borrar3.enabled=false
	cb_todos3.enabled=false
	idw_t_baja.enabled=false
end if

end event

type dw_opcion_situaciones from u_dw within tabpage_4
integer x = 69
integer y = 100
integer width = 745
integer height = 112
integer taborder = 50
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;if data ='S' then
	cb_todos1.visible=true
	cb_borrar1.visible=true
	dw_situaciones.visible = true
else
	cb_todos1.visible=false
	cb_borrar1.visible=false
	dw_situaciones.visible=false
end if 
end event

type dw_opcion_altas from u_dw within tabpage_4
boolean visible = false
integer x = 974
integer y = 100
integer width = 745
integer height = 112
integer taborder = 50
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos2.visible=true
	cb_borrar2.visible=true
	dw_t_alta.visible = true
else
	cb_todos2.visible=false
	cb_borrar2.visible=false
	dw_t_alta.visible=false
end if 
end event

type dw_opcion_bajas from u_dw within tabpage_4
boolean visible = false
integer x = 1842
integer y = 100
integer width = 727
integer height = 112
integer taborder = 50
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos3.visible=true
	cb_borrar3.visible=true
	dw_t_baja.visible = true
else
	cb_todos3.visible=false
	cb_borrar3.visible=false
	dw_t_baja.visible=false
end if 
end event

type gb_1 from groupbox within tabpage_4
integer x = 9
integer y = 36
integer width = 846
integer height = 1500
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Situaciones"
end type

type gb_2 from groupbox within tabpage_4
integer x = 901
integer y = 228
integer width = 846
integer height = 1308
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Altas"
end type

type gb_3 from groupbox within tabpage_4
integer x = 1787
integer y = 232
integer width = 846
integer height = 1304
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Bajas"
end type

type tabpage_5 from userobject within tab_1
event create ( )
event destroy ( )
string tag = "texto=colegiados.sit_profesional"
integer x = 18
integer y = 100
integer width = 2647
integer height = 1772
long backcolor = 79741120
string text = "Sit.Profesional"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_agrupaciones dw_agrupaciones
cb_incluir4 cb_incluir4
cb_borrar4 cb_borrar4
dw_sit_profesionales dw_sit_profesionales
dw_incompatibilidades dw_incompatibilidades
cb_3 cb_3
cb_4 cb_4
cb_5 cb_5
cb_6 cb_6
dw_opcion_agr dw_opcion_agr
dw_opcion_sit dw_opcion_sit
dw_opcion_incomp dw_opcion_incomp
gb_4 gb_4
gb_5 gb_5
gb_6 gb_6
gb_7 gb_7
dw_datos_agrupacion dw_datos_agrupacion
gb_8 gb_8
dw_datos_sitprof dw_datos_sitprof
end type

on tabpage_5.create
this.dw_agrupaciones=create dw_agrupaciones
this.cb_incluir4=create cb_incluir4
this.cb_borrar4=create cb_borrar4
this.dw_sit_profesionales=create dw_sit_profesionales
this.dw_incompatibilidades=create dw_incompatibilidades
this.cb_3=create cb_3
this.cb_4=create cb_4
this.cb_5=create cb_5
this.cb_6=create cb_6
this.dw_opcion_agr=create dw_opcion_agr
this.dw_opcion_sit=create dw_opcion_sit
this.dw_opcion_incomp=create dw_opcion_incomp
this.gb_4=create gb_4
this.gb_5=create gb_5
this.gb_6=create gb_6
this.gb_7=create gb_7
this.dw_datos_agrupacion=create dw_datos_agrupacion
this.gb_8=create gb_8
this.dw_datos_sitprof=create dw_datos_sitprof
this.Control[]={this.dw_agrupaciones,&
this.cb_incluir4,&
this.cb_borrar4,&
this.dw_sit_profesionales,&
this.dw_incompatibilidades,&
this.cb_3,&
this.cb_4,&
this.cb_5,&
this.cb_6,&
this.dw_opcion_agr,&
this.dw_opcion_sit,&
this.dw_opcion_incomp,&
this.gb_4,&
this.gb_5,&
this.gb_6,&
this.gb_7,&
this.dw_datos_agrupacion,&
this.gb_8,&
this.dw_datos_sitprof}
end on

on tabpage_5.destroy
destroy(this.dw_agrupaciones)
destroy(this.cb_incluir4)
destroy(this.cb_borrar4)
destroy(this.dw_sit_profesionales)
destroy(this.dw_incompatibilidades)
destroy(this.cb_3)
destroy(this.cb_4)
destroy(this.cb_5)
destroy(this.cb_6)
destroy(this.dw_opcion_agr)
destroy(this.dw_opcion_sit)
destroy(this.dw_opcion_incomp)
destroy(this.gb_4)
destroy(this.gb_5)
destroy(this.gb_6)
destroy(this.gb_7)
destroy(this.dw_datos_agrupacion)
destroy(this.gb_8)
destroy(this.dw_datos_sitprof)
end on

type dw_agrupaciones from u_dw within tabpage_5
boolean visible = false
integer x = 50
integer y = 688
integer width = 800
integer height = 840
integer taborder = 20
string dataobject = "d_colegiados_consulta_agrupaciones"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;string opcion

opcion = idw_opcion_agr.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_agr.SetItem(1,'opcion','S')
end event

type cb_incluir4 from commandbutton within tabpage_5
boolean visible = false
integer x = 41
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_agrupaciones.rowcount() 
	idw_agrupaciones.SetItem(i,'activo','S')
next
end event

type cb_borrar4 from commandbutton within tabpage_5
boolean visible = false
integer x = 366
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "BorrarTodos"
end type

event clicked;int i

for i=1 to idw_agrupaciones.rowcount() 
	idw_agrupaciones.SetItem(i,'activo','N')
next
end event

type dw_sit_profesionales from u_dw within tabpage_5
boolean visible = false
integer x = 951
integer y = 688
integer width = 763
integer height = 840
integer taborder = 20
string dataobject = "d_colegiados_consulta_sit_profesional"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_sitprof.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_sitprof.SetItem(1,'opcion','S')
end event

type dw_incompatibilidades from u_dw within tabpage_5
boolean visible = false
integer x = 1806
integer y = 688
integer width = 777
integer height = 840
integer taborder = 20
string dataobject = "d_colegiados_consulta_incompatibilidades"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;string opcion

opcion = idw_opcion_incompat.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_incompat.SetItem(1,'opcion','S')
end event

type cb_3 from commandbutton within tabpage_5
boolean visible = false
integer x = 933
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_sit_profesionales.rowcount() 
	idw_sit_profesionales.SetItem(i,'activo','S')
next
end event

type cb_4 from commandbutton within tabpage_5
boolean visible = false
integer x = 1257
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "BorrarTodos"
end type

event clicked;int i

for i=1 to idw_sit_profesionales.rowcount() 
	idw_sit_profesionales.SetItem(i,'activo','N')
next
end event

type cb_5 from commandbutton within tabpage_5
boolean visible = false
integer x = 1797
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_incompatibilidades.rowcount() 
	idw_incompatibilidades.SetItem(i,'activo','S')
next
end event

type cb_6 from commandbutton within tabpage_5
boolean visible = false
integer x = 2126
integer y = 1548
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "BorrarTodos"
end type

event clicked;int i

for i=1 to idw_incompatibilidades.rowcount() 
	idw_incompatibilidades.SetItem(i,'activo','N')
next
end event

type dw_opcion_agr from u_dw within tabpage_5
integer x = 78
integer y = 556
integer width = 731
integer height = 120
integer taborder = 50
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_incluir4.visible=true
	cb_borrar4.visible=true
	dw_agrupaciones.visible = true
else
	cb_incluir4.visible=false
	cb_borrar4.visible=false
	dw_agrupaciones.visible=false
end if 
end event

type dw_opcion_sit from u_dw within tabpage_5
integer x = 969
integer y = 556
integer width = 727
integer height = 112
integer taborder = 50
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_3.visible=true
	cb_4.visible=true
	dw_sit_profesionales.visible = true
else
	cb_3.visible=false
	cb_4.visible=false
	dw_sit_profesionales.visible=false
end if 
end event

type dw_opcion_incomp from u_dw within tabpage_5
integer x = 1829
integer y = 556
integer width = 731
integer height = 112
integer taborder = 50
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_5.visible=true
	cb_6.visible=true
	dw_incompatibilidades.visible = true
else
	cb_5.visible=false
	cb_6.visible=false
	dw_incompatibilidades.visible=false
end if 
end event

type gb_4 from groupbox within tabpage_5
integer x = 41
integer y = 488
integer width = 827
integer height = 1048
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Agrupaciones"
end type

type gb_5 from groupbox within tabpage_5
integer x = 933
integer y = 488
integer width = 800
integer height = 1048
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Situaciones Profesionales"
end type

type gb_6 from groupbox within tabpage_5
integer x = 1797
integer y = 488
integer width = 800
integer height = 1048
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Incompatibilidades"
end type

type gb_7 from groupbox within tabpage_5
integer x = 46
integer y = 12
integer width = 1102
integer height = 428
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 79741120
string text = "Datos Agrupaci$$HEX1$$f300$$ENDHEX$$n"
end type

type dw_datos_agrupacion from u_dw within tabpage_5
integer x = 69
integer y = 88
integer width = 1065
integer height = 328
integer taborder = 90
boolean bringtotop = true
string dataobject = "d_colegiados_consulta_datos_agrupacion"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event constructor;call super::constructor;
// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

type gb_8 from groupbox within tabpage_5
integer x = 1166
integer y = 12
integer width = 1417
integer height = 428
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Datos Situaciones,Incompatibilidades"
end type

type dw_datos_sitprof from u_dw within tabpage_5
integer x = 1202
integer y = 76
integer width = 1335
integer height = 348
integer taborder = 90
boolean bringtotop = true
string dataobject = "d_colegiados_consulta_datos_sitprof"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event buttonclicked;call super::buttonclicked;string pob 

g_busqueda.titulo='Poblaciones'
g_busqueda.dw='d_poblaciones_lista_busqueda'
pob=f_busqueda_poblaciones()
if f_es_vacio(pob) then return
this.SetItem(1,'poblacion',pob)

end event

event constructor;call super::constructor;
// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

type tabpage_10 from userobject within tab_1
event create ( )
event destroy ( )
string tag = " texto=colegiados.sit_resid_ejer"
integer x = 18
integer y = 100
integer width = 2647
integer height = 1772
long backcolor = 79741120
string text = "Sit.Resid. Ejerc."
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_ejerciente_si_no dw_ejerciente_si_no
cb_todos5 cb_todos5
cb_borrar5 cb_borrar5
dw_residente dw_residente
dw_opcion_residente dw_opcion_residente
gb_15 gb_15
end type

on tabpage_10.create
this.dw_ejerciente_si_no=create dw_ejerciente_si_no
this.cb_todos5=create cb_todos5
this.cb_borrar5=create cb_borrar5
this.dw_residente=create dw_residente
this.dw_opcion_residente=create dw_opcion_residente
this.gb_15=create gb_15
this.Control[]={this.dw_ejerciente_si_no,&
this.cb_todos5,&
this.cb_borrar5,&
this.dw_residente,&
this.dw_opcion_residente,&
this.gb_15}
end on

on tabpage_10.destroy
destroy(this.dw_ejerciente_si_no)
destroy(this.cb_todos5)
destroy(this.cb_borrar5)
destroy(this.dw_residente)
destroy(this.dw_opcion_residente)
destroy(this.gb_15)
end on

type dw_ejerciente_si_no from u_dw within tabpage_10
integer x = 1042
integer y = 68
integer width = 1111
integer height = 136
integer taborder = 31
string dataobject = "d_colegiados_consulta_ejerciente"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

type cb_todos5 from commandbutton within tabpage_10
boolean visible = false
integer x = 14
integer y = 1576
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_residente.rowcount() 
	idw_residente.SetItem(i,'activo','S')
next
end event

type cb_borrar5 from commandbutton within tabpage_10
boolean visible = false
integer x = 343
integer y = 1576
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_residente.rowcount() 
	idw_residente.SetItem(i,'activo','N')
next
end event

type dw_residente from u_dw within tabpage_10
boolean visible = false
integer x = 41
integer y = 280
integer width = 800
integer height = 1256
integer taborder = 10
string dataobject = "d_colegiados_consulta_residente"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_residente.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_residente.SetItem(1,'opcion','S')
end event

type dw_opcion_residente from u_dw within tabpage_10
integer x = 78
integer y = 128
integer width = 736
integer height = 112
integer taborder = 10
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos5.visible=true
	cb_borrar5.visible=true
	dw_residente.visible = true
else
	cb_todos5.visible=false
	cb_borrar5.visible=false
	dw_residente.visible=false
end if 
end event

type gb_15 from groupbox within tabpage_10
integer x = 9
integer y = 48
integer width = 846
integer height = 1508
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Residente"
end type

type tabpage_6 from userobject within tab_1
string tag = " texto=colegiados.otros_datos"
integer x = 18
integer y = 100
integer width = 2647
integer height = 1772
long backcolor = 79741120
string text = "Otros Datos"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_7 cb_7
cb_8 cb_8
dw_consulta_orientaciones dw_consulta_orientaciones
gb_10 gb_10
dw_opciones_orientaciones dw_opciones_orientaciones
gb_9 gb_9
dw_otros_datos dw_otros_datos
end type

on tabpage_6.create
this.cb_7=create cb_7
this.cb_8=create cb_8
this.dw_consulta_orientaciones=create dw_consulta_orientaciones
this.gb_10=create gb_10
this.dw_opciones_orientaciones=create dw_opciones_orientaciones
this.gb_9=create gb_9
this.dw_otros_datos=create dw_otros_datos
this.Control[]={this.cb_7,&
this.cb_8,&
this.dw_consulta_orientaciones,&
this.gb_10,&
this.dw_opciones_orientaciones,&
this.gb_9,&
this.dw_otros_datos}
end on

on tabpage_6.destroy
destroy(this.cb_7)
destroy(this.cb_8)
destroy(this.dw_consulta_orientaciones)
destroy(this.gb_10)
destroy(this.dw_opciones_orientaciones)
destroy(this.gb_9)
destroy(this.dw_otros_datos)
end on

type cb_7 from commandbutton within tabpage_6
boolean visible = false
integer x = 1545
integer y = 1504
integer width = 329
integer height = 72
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Selecc.Todos"
end type

event clicked;int i

for i = 1 to idw_orientaciones.rowcount()
	idw_orientaciones.SetItem(i,'activo','S')
next

end event

type cb_8 from commandbutton within tabpage_6
boolean visible = false
integer x = 1883
integer y = 1504
integer width = 329
integer height = 72
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i = 1 to idw_orientaciones.rowcount()
	idw_orientaciones.SetItem(i,'activo','N')
next

end event

type dw_consulta_orientaciones from u_dw within tabpage_6
boolean visible = false
integer x = 1582
integer y = 220
integer width = 928
integer height = 1168
integer taborder = 30
string dataobject = "d_colegiados_consulta_orientaciones"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_orientaciones.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_orientaciones.SetItem(1,'opcion','S')
end event

type gb_10 from groupbox within tabpage_6
integer x = 32
integer y = 32
integer width = 1431
integer height = 1460
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 79741120
string text = "Otros Datos"
end type

type dw_opciones_orientaciones from u_dw within tabpage_6
integer x = 1646
integer y = 92
integer width = 736
integer height = 132
integer taborder = 100
boolean bringtotop = true
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;if data ='S' then
	cb_7.visible=true
	cb_8.visible=true
	dw_consulta_orientaciones.visible = true
else
	cb_7.visible=false
	cb_8.visible=false
	dw_consulta_orientaciones.visible=false
end if 
end event

type gb_9 from groupbox within tabpage_6
integer x = 1541
integer y = 32
integer width = 992
integer height = 1460
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 79741120
string text = "Orientaciones Profesionales"
end type

type dw_otros_datos from u_dw within tabpage_6
integer x = 91
integer y = 112
integer width = 1330
integer height = 1304
integer taborder = 30
boolean bringtotop = true
string dataobject = "d_colegiados_consulta_otros_datos"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event constructor;call super::constructor;this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)

end event

type tabpage_7 from userobject within tab_1
integer x = 18
integer y = 100
integer width = 2647
integer height = 1772
long backcolor = 79741120
string text = "MUSAAT"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_datos_musaat dw_datos_musaat
end type

on tabpage_7.create
this.dw_datos_musaat=create dw_datos_musaat
this.Control[]={this.dw_datos_musaat}
end on

on tabpage_7.destroy
destroy(this.dw_datos_musaat)
end on

type dw_datos_musaat from u_dw within tabpage_7
integer x = 46
integer y = 84
integer width = 2446
integer height = 1608
integer taborder = 30
string dataobject = "d_colegiados_consulta_musaat"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event buttonclicked;string pob,codigos=''
int i

CHOOSE CASE dwo.name
	CASE 'b_poblacion'
		
		g_busqueda.titulo='Poblaciones'
		g_busqueda.dw='d_poblaciones_lista_busqueda'
		pob=f_busqueda_poblaciones()
		if f_es_vacio(pob) then return
		this.SetItem(row,'cod_pob',pob)
	case 'b_listas'
		Open(w_listas_seleccion)
		this.SetItem(1,'lista_colegiados',Message.Stringparm)
		
END CHOOSE

end event

type tabpage_8 from userobject within tab_1
integer x = 18
integer y = 100
integer width = 2647
integer height = 1772
long backcolor = 79741120
string text = "PREMAAT"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_datos_premaat dw_datos_premaat
end type

on tabpage_8.create
this.dw_datos_premaat=create dw_datos_premaat
this.Control[]={this.dw_datos_premaat}
end on

on tabpage_8.destroy
destroy(this.dw_datos_premaat)
end on

type dw_datos_premaat from u_dw within tabpage_8
integer x = 69
integer y = 84
integer width = 1746
integer height = 992
integer taborder = 40
string dataobject = "d_colegiados_consulta_premaat"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event buttonclicked;string pob,codigos=''
int i

CHOOSE CASE dwo.name
	CASE 'b_poblacion'
		
		g_busqueda.titulo='Poblaciones'
		g_busqueda.dw='d_poblaciones_lista_busqueda'
		pob=f_busqueda_poblaciones()
		if f_es_vacio(pob) then return
		this.SetItem(row,'cod_pob',pob)
	case 'b_listas'
		Open(w_listas_seleccion)
		this.SetItem(1,'lista_colegiados',Message.Stringparm)
		
END CHOOSE

end event

type rb_num_col from radiobutton within w_colegiados_listados
string tag = "texto=colegiados.n_colegiado"
integer x = 2770
integer y = 1732
integer width = 402
integer height = 64
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "N$$HEX2$$ba002000$$ENDHEX$$Colegiado"
boolean checked = true
end type

type rb_apellidos from radiobutton within w_colegiados_listados
string tag = "texto=colegiados.apellidos"
integer x = 2770
integer y = 1808
integer width = 402
integer height = 64
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Apellidos"
end type

type rb_cp from radiobutton within w_colegiados_listados
string tag = "texto=general.cp"
integer x = 2770
integer y = 1884
integer width = 402
integer height = 64
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "C.P."
end type

type rb_nif from radiobutton within w_colegiados_listados
string tag = "texto=general.nif"
integer x = 2770
integer y = 1960
integer width = 402
integer height = 64
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "NIF"
end type

type rb_1 from radiobutton within w_colegiados_listados
integer x = 3259
integer y = 1740
integer width = 343
integer height = 72
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Profesional"
boolean checked = true
end type

type rb_2 from radiobutton within w_colegiados_listados
integer x = 3259
integer y = 1832
integer width = 343
integer height = 72
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Personal"
end type

type gb_11 from groupbox within w_colegiados_listados
string tag = "texto=general.ordenar_por"
integer x = 2743
integer y = 1668
integer width = 448
integer height = 376
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Ordenar por"
end type


HA$PBExportHeader$w_fases_consulta.srw
forward
global type w_fases_consulta from w_consulta
end type
type rb_completa from radiobutton within w_fases_consulta
end type
type rb_preasignada from radiobutton within w_fases_consulta
end type
type dw_2 from u_dw within w_fases_consulta
end type
type dw_tipos_estados from u_dw within w_fases_consulta
end type
type tab_1 from tab within w_fases_consulta
end type
type tabpage_1 from userobject within tab_1
end type
type st_1 from statictext within tabpage_1
end type
type lb_1 from listbox within tabpage_1
end type
type dw_principal from u_dw within tabpage_1
end type
type dw_pem_hono from u_dw within tabpage_1
end type
type tabpage_1 from userobject within tab_1
st_1 st_1
lb_1 lb_1
dw_principal dw_principal
dw_pem_hono dw_pem_hono
end type
type tabpage_5 from userobject within tab_1
end type
type dw_minutas from u_dw within tabpage_5
end type
type tabpage_5 from userobject within tab_1
dw_minutas dw_minutas
end type
type tabpage_9 from userobject within tab_1
end type
type dw_destino_seleccion from u_dw within tabpage_9
end type
type dw_tipo_obra_seleccion from u_dw within tabpage_9
end type
type dw_tipo_actuacion_seleccion from u_dw within tabpage_9
end type
type dw_destino from u_dw within tabpage_9
end type
type dw_tipoobra from u_dw within tabpage_9
end type
type dw_tipoact from u_dw within tabpage_9
end type
type cb_todos1_est from commandbutton within tabpage_9
end type
type cb_borrar1_est from commandbutton within tabpage_9
end type
type cb_todos2_est from commandbutton within tabpage_9
end type
type cb_borrar2_est from commandbutton within tabpage_9
end type
type cb_todos3_est from commandbutton within tabpage_9
end type
type cb_borrar3_est from commandbutton within tabpage_9
end type
type gb_11 from groupbox within tabpage_9
end type
type gb_9 from groupbox within tabpage_9
end type
type gb_1est from groupbox within tabpage_9
end type
type tabpage_9 from userobject within tab_1
dw_destino_seleccion dw_destino_seleccion
dw_tipo_obra_seleccion dw_tipo_obra_seleccion
dw_tipo_actuacion_seleccion dw_tipo_actuacion_seleccion
dw_destino dw_destino
dw_tipoobra dw_tipoobra
dw_tipoact dw_tipoact
cb_todos1_est cb_todos1_est
cb_borrar1_est cb_borrar1_est
cb_todos2_est cb_todos2_est
cb_borrar2_est cb_borrar2_est
cb_todos3_est cb_todos3_est
cb_borrar3_est cb_borrar3_est
gb_11 gb_11
gb_9 gb_9
gb_1est gb_1est
end type
type tabpage_2 from userobject within tab_1
end type
type gb_12 from groupbox within tabpage_2
end type
type cb_todos7 from commandbutton within tabpage_2
end type
type cb_todos4 from commandbutton within tabpage_2
end type
type cb_borrar3 from commandbutton within tabpage_2
end type
type cb_todos3 from commandbutton within tabpage_2
end type
type cb_borrar2 from commandbutton within tabpage_2
end type
type cb_todos2 from commandbutton within tabpage_2
end type
type dw_seleccion_modalidad from u_dw within tabpage_2
end type
type dw_seleccion_gestion from u_dw within tabpage_2
end type
type cb_borrar1 from commandbutton within tabpage_2
end type
type cb_todos1 from commandbutton within tabpage_2
end type
type dw_seleccion_estados from u_dw within tabpage_2
end type
type dw_estados_contrato from u_dw within tabpage_2
end type
type dw_modalidad_contrato from u_dw within tabpage_2
end type
type gb_estados from groupbox within tabpage_2
end type
type gb_modalidad from groupbox within tabpage_2
end type
type gb_gestion from groupbox within tabpage_2
end type
type dw_gestion_contrato from u_dw within tabpage_2
end type
type dw_seleccion_col_destino from u_dw within tabpage_2
end type
type dw_consulta_col_destino from u_dw within tabpage_2
end type
type tabpage_2 from userobject within tab_1
gb_12 gb_12
cb_todos7 cb_todos7
cb_todos4 cb_todos4
cb_borrar3 cb_borrar3
cb_todos3 cb_todos3
cb_borrar2 cb_borrar2
cb_todos2 cb_todos2
dw_seleccion_modalidad dw_seleccion_modalidad
dw_seleccion_gestion dw_seleccion_gestion
cb_borrar1 cb_borrar1
cb_todos1 cb_todos1
dw_seleccion_estados dw_seleccion_estados
dw_estados_contrato dw_estados_contrato
dw_modalidad_contrato dw_modalidad_contrato
gb_estados gb_estados
gb_modalidad gb_modalidad
gb_gestion gb_gestion
dw_gestion_contrato dw_gestion_contrato
dw_seleccion_col_destino dw_seleccion_col_destino
dw_consulta_col_destino dw_consulta_col_destino
end type
type tabpage_7 from userobject within tab_1
end type
type dw_otros_docs from u_dw within tabpage_7
end type
type dw_otros_doc_contrato from u_dw within tabpage_7
end type
type tabpage_7 from userobject within tab_1
dw_otros_docs dw_otros_docs
dw_otros_doc_contrato dw_otros_doc_contrato
end type
type tabpage_6 from userobject within tab_1
end type
type dw_renuncias from u_csd_dw within tabpage_6
end type
type dw_registro_es from u_dw within tabpage_6
end type
type dw_reclamaciones from u_dw within tabpage_6
end type
type dw_reparos from u_dw within tabpage_6
end type
type dw_final_obra from u_dw within tabpage_6
end type
type dw_garantias from u_dw within tabpage_6
end type
type tabpage_6 from userobject within tab_1
dw_renuncias dw_renuncias
dw_registro_es dw_registro_es
dw_reclamaciones dw_reclamaciones
dw_reparos dw_reparos
dw_final_obra dw_final_obra
dw_garantias dw_garantias
end type
type tabpage_8 from userobject within tab_1
end type
type dw_arquitectos from u_dw within tabpage_8
end type
type tabpage_8 from userobject within tab_1
dw_arquitectos dw_arquitectos
end type
type tabpage_3 from userobject within tab_1
end type
type dw_datos_sitprof from u_dw within tabpage_3
end type
type cb_6 from commandbutton within tabpage_3
end type
type cb_5 from commandbutton within tabpage_3
end type
type cb_4 from commandbutton within tabpage_3
end type
type cb_3 from commandbutton within tabpage_3
end type
type cb_borrar4 from commandbutton within tabpage_3
end type
type cb_incluir4 from commandbutton within tabpage_3
end type
type dw_incompatibilidades from u_dw within tabpage_3
end type
type dw_sit_profesionales from u_dw within tabpage_3
end type
type dw_agrupaciones from u_dw within tabpage_3
end type
type dw_opcion_incomp from u_dw within tabpage_3
end type
type dw_opcion_sit from u_dw within tabpage_3
end type
type dw_opcion_agr from u_dw within tabpage_3
end type
type dw_datos_agrupacion from u_dw within tabpage_3
end type
type gb_7 from groupbox within tabpage_3
end type
type gb_6 from groupbox within tabpage_3
end type
type gb_5 from groupbox within tabpage_3
end type
type gb_4 from groupbox within tabpage_3
end type
type gb_8 from groupbox within tabpage_3
end type
type tabpage_3 from userobject within tab_1
dw_datos_sitprof dw_datos_sitprof
cb_6 cb_6
cb_5 cb_5
cb_4 cb_4
cb_3 cb_3
cb_borrar4 cb_borrar4
cb_incluir4 cb_incluir4
dw_incompatibilidades dw_incompatibilidades
dw_sit_profesionales dw_sit_profesionales
dw_agrupaciones dw_agrupaciones
dw_opcion_incomp dw_opcion_incomp
dw_opcion_sit dw_opcion_sit
dw_opcion_agr dw_opcion_agr
dw_datos_agrupacion dw_datos_agrupacion
gb_7 gb_7
gb_6 gb_6
gb_5 gb_5
gb_4 gb_4
gb_8 gb_8
end type
type tabpage_4 from userobject within tab_1
end type
type dw_t_baja from u_dw within tabpage_4
end type
type dw_opcion_altas from u_dw within tabpage_4
end type
type cb_borrar30 from commandbutton within tabpage_4
end type
type cb_todos30 from commandbutton within tabpage_4
end type
type cb_borrar20 from commandbutton within tabpage_4
end type
type cb_todos20 from commandbutton within tabpage_4
end type
type cb_borrar10 from commandbutton within tabpage_4
end type
type cb_todos10 from commandbutton within tabpage_4
end type
type dw_opcion_bajas from u_dw within tabpage_4
end type
type dw_t_alta from u_dw within tabpage_4
end type
type dw_situaciones from u_dw within tabpage_4
end type
type dw_alta_si_no from u_dw within tabpage_4
end type
type dw_opcion_situaciones from u_dw within tabpage_4
end type
type gb_2 from groupbox within tabpage_4
end type
type gb_10 from groupbox within tabpage_4
end type
type gb_3 from groupbox within tabpage_4
end type
type tabpage_4 from userobject within tab_1
dw_t_baja dw_t_baja
dw_opcion_altas dw_opcion_altas
cb_borrar30 cb_borrar30
cb_todos30 cb_todos30
cb_borrar20 cb_borrar20
cb_todos20 cb_todos20
cb_borrar10 cb_borrar10
cb_todos10 cb_todos10
dw_opcion_bajas dw_opcion_bajas
dw_t_alta dw_t_alta
dw_situaciones dw_situaciones
dw_alta_si_no dw_alta_si_no
dw_opcion_situaciones dw_opcion_situaciones
gb_2 gb_2
gb_10 gb_10
gb_3 gb_3
end type
type tabpage_10 from userobject within tab_1
end type
type cb_todos5 from commandbutton within tabpage_10
end type
type cb_borrar5 from commandbutton within tabpage_10
end type
type dw_residente from u_dw within tabpage_10
end type
type dw_opcion_residente from u_dw within tabpage_10
end type
type gb_15 from groupbox within tabpage_10
end type
type tabpage_10 from userobject within tab_1
cb_todos5 cb_todos5
cb_borrar5 cb_borrar5
dw_residente dw_residente
dw_opcion_residente dw_opcion_residente
gb_15 gb_15
end type
type tabpage_11 from userobject within tab_1
end type
type dw_opcion_tarifa from u_dw within tabpage_11
end type
type dw_honos_tarifas from u_dw within tabpage_11
end type
type cb_borrar6 from commandbutton within tabpage_11
end type
type cb_todos6 from commandbutton within tabpage_11
end type
type gb_16 from groupbox within tabpage_11
end type
type tabpage_11 from userobject within tab_1
dw_opcion_tarifa dw_opcion_tarifa
dw_honos_tarifas dw_honos_tarifas
cb_borrar6 cb_borrar6
cb_todos6 cb_todos6
gb_16 gb_16
end type
type tab_1 from tab within w_fases_consulta
tabpage_1 tabpage_1
tabpage_5 tabpage_5
tabpage_9 tabpage_9
tabpage_2 tabpage_2
tabpage_7 tabpage_7
tabpage_6 tabpage_6
tabpage_8 tabpage_8
tabpage_3 tabpage_3
tabpage_4 tabpage_4
tabpage_10 tabpage_10
tabpage_11 tabpage_11
end type
type cbx_minutas from checkbox within w_fases_consulta
end type
type gb_1 from groupbox within w_fases_consulta
end type
end forward

global type w_fases_consulta from w_consulta
integer x = 214
integer y = 80
integer width = 3287
integer height = 2536
string title = "Consulta de Contratos"
event csd_consulta_control ( )
event csd_consulta_principal ( )
event csd_consulta_colegiado ( )
event csd_consulta_colegiado_col ( )
event csd_consulta_pem_hono ( )
event csd_consulta_minutas ( )
event csd_consulta_otros_documentos ( )
event csd_consulta_finales_obra ( )
event csd_consulta_garantias ( )
event csd_consulta_reclamaciones ( )
event csd_consulta_reparos ( )
event csd_consulta_registros ( )
event csd_consulta_arquitectos ( )
event csd_consulta_residente ( )
event csd_oculta ( )
event csd_consulta_estadistica ( )
event csd_consulta_tarifas ( )
event csd_consulta_renuncia ( )
rb_completa rb_completa
rb_preasignada rb_preasignada
dw_2 dw_2
dw_tipos_estados dw_tipos_estados
tab_1 tab_1
cbx_minutas cbx_minutas
gb_1 gb_1
end type
global w_fases_consulta w_fases_consulta

type variables
u_dw idw_principal, idw_estados_contrato, idw_gestion_contrato, idw_modalidad_contrato
u_dw idw_datos_agrupacion, idw_datos_sitprof, idw_agrupaciones, idw_sit_profesionales
u_dw idw_incompatibilidades, idw_alta_si_no, idw_opcion_situaciones, idw_opcion_bajas
u_dw idw_situaciones, idw_t_alta, idw_t_baja, idw_opcion_altas
u_dw idw_pem_hono, idw_renuncias,  idw_colegio_dest, idw_seleccion_col_dest

u_dw idw_seleccion_estados, idw_seleccion_gestion, idw_seleccion_modalidad
u_dw idw_opcion_agr, idw_opcion_sit, idw_opcion_incomp
u_dw idw_minutas, idw_gestion_contrato_minutas, idw_final_obra, idw_garantias, idw_reclamaciones
u_dw idw_reparos, idw_registro_es, idw_otros_doc_contrato, idw_otros_docs, idw_arquitectos
u_dw idw_opcion_residente, idw_residente

u_dw idw_tipo_actuacion_seleccion, idw_tipo_obra_seleccion, idw_destino_seleccion
u_dw idw_tipoact, idw_tipoobra, idw_destino, idw_tarifas, idw_opcion_tarifas

st_fases_colegiados_sociedades ist_fases_col_soc 
string i_exp,i_reg,i_resultado,isql_nuevo
integer i_tab

long i_tabs_visitados[11]  //separados por comas

end variables

event csd_consulta_control();string codigos,sql_aux,opcion,operador,alta
boolean coma
int i


//Estados contrato
opcion = idw_seleccion_estados.GetItemString(1,'opcion')
if opcion<>'%' then 
	coma=false
	for i=1 to idw_estados_contrato.RowCount()
		if idw_estados_contrato.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_estados_contrato.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and fases.estado "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE fases.estado "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if
end if

//Tipo_gestion contrato
coma=false
codigos=''
opcion = idw_seleccion_gestion.GetItemString(1,'opcion')
if opcion<>'%' then 
	for i=1 to idw_gestion_contrato.RowCount()
		if idw_gestion_contrato.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_gestion_contrato.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and fases.tipo_gestion "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE fases.tipo_gestion "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if
end if
	
//Modalidad contrato
coma=false
codigos=''
opcion = idw_seleccion_modalidad.GetItemString(1,'opcion')
if opcion<>'%' then 
	for i=1 to idw_modalidad_contrato.RowCount()
		if idw_modalidad_contrato.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_modalidad_contrato.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and fases.modalidad "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE fases.modalidad "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if	
end if

//Colegio Destino
coma=false
codigos=''
opcion = idw_seleccion_col_dest.GetItemString(1,'opcion')
if opcion<>'%' then 
	for i=1 to idw_colegio_dest.RowCount()
		if idw_colegio_dest.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_colegio_dest.GetItemString(i,'cod_colegio')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and fases.cod_colegio_dest "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE fases.cod_colegio_dest "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if	
end if
end event

event csd_consulta_principal();string n_colegiado,n_nif, sql_cliente, sql_representante, ls_sql_aux, ls_trabajos_intercolegiales
int li_col, li_i

//Se inicializan los id de Colegiado y cliente para no alterar el sql
idw_principal.setitem(1,'id_colegiado','')
idw_principal.setitem(1,'id_cliente','')

// Se preparan los id de Colegiados y Cliente
n_colegiado = idw_principal.getitemstring(1,'n_colegiado')
if not f_es_vacio(n_colegiado) then
idw_principal.setitem(1,'id_colegiado',f_busca_id_colegiado_por_codigo(n_colegiado))
end if	

n_nif = idw_principal.getitemstring(1,'nif_promotor')

// ICC-57
if g_colegio = 'COAATCC' then
	string n_registro
	n_registro =  idw_principal.getitemstring(1,'n_registro')
	if not f_es_vacio(n_registro) and len(n_registro) < 6 then
		n_registro = 'C' + right(g_ejercicio,2) + right('00000' + n_registro,5) + f_delegacion_siglas(g_cod_delegacion)
		idw_principal.setitem(1,'n_registro',n_registro)
	end if
end if


f_sql('fases.n_registro','LIKE','n_registro',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.f_entrada','>=','f_entrada_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.f_entrada','<','f_entrada_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.f_visado','>=','f_visado_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.f_visado','<','f_visado_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.f_abono','>=','f_abono_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.f_abono','<','f_abono_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.titulo','LIKE','descripcion_trabajo',idw_principal,isql_nuevo,g_tipo_base_datos,'')

f_sql('fases.honorarios','>=','honorarios_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.honorarios','<','honorarios_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')

f_sql('fases.tipo_registro','LIKE','tipo_registro',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.fase','LIKE','fase',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.n_calle','LIKE','n_calle',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.trabajo','=','trabajo',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.tipo_trabajo','=','tipo_trabajo',idw_principal,isql_nuevo,'1','')
f_sql('fases.id_tramite','LIKE','tipo_tramite',idw_principal,isql_nuevo,'1','')
f_sql('fases.poblacion','=','poblacion',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('poblaciones.descripcion','=','des_poblacion',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.emplazamiento','LIKE INSIDE','emplazamiento',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('expedientes.administracion','=','obra_oficial',idw_principal,isql_nuevo,g_tipo_base_datos,'')	
f_sql('expedientes.r_catastral','=','r_catastral',idw_principal,isql_nuevo,g_tipo_base_datos,'')	


// Se prepara el formato del Nro. Registro
if not f_es_vacio(idw_principal.getitemstring(1,'n_expediente')) then
	isql_nuevo=isql_nuevo + "and expedientes.n_expedi LIKE '" + i_exp + "%'"
end if

///* Alexis. Se modifica para dar soporte a la selecci$$HEX1$$f300$$ENDHEX$$n de datos de varios colegiados asociados a sociedades. 01/02/2010***///
 li_col = UpperBound(ist_fases_col_soc.id_colegiados)
 if (not f_es_vacio(ist_fases_col_soc.id_sociedad) and li_col > 0) then
	
	ls_sql_aux = ''
	
	For li_i = 1 To li_col
		if not f_es_vacio(ist_fases_col_soc.id_colegiados[li_i]) then
			if f_es_vacio(ls_sql_aux) then
				ls_sql_aux = " (fases_colegiados.id_col = '"+ ist_fases_col_soc.id_colegiados[li_i] + "' "	
			else
				ls_sql_aux += " or fases_colegiados.id_col = '"+ ist_fases_col_soc.id_colegiados[li_i] + "' "	
			end if	
		end if	
	next
	if not f_es_vacio(ls_sql_aux) then 
		ls_sql_aux += ") "
		if PosA(upper(isql_nuevo), "WHERE") > 0 then
			isql_nuevo += ' and '+ ls_sql_aux
		else
			isql_nuevo += ' WHERE '+ ls_sql_aux
		end if	
	end if
else 
f_sql('fases_colegiados.id_col','=','id_colegiado',idw_principal,isql_nuevo,g_tipo_base_datos,'')  // El LIKE no funciona bien en COAATLR
f_sql('colegiados.apellidos','LIKE','nombre_colegiado',idw_principal,isql_nuevo,g_tipo_base_datos,'')

end if
///**** Fin modificado por Alexis.01/02/2010 ****///

f_sql('fases_clientes.id_cliente','LIKE','id_cliente',idw_principal,isql_nuevo,g_tipo_base_datos,'') 
f_sql('fases_clientes.id_representante','LIKE','id_representante',idw_principal,isql_nuevo,g_tipo_base_datos,'')

// Modificado por David - 19/10/2005
// Hay que hacerlo asi para que no falle (i3568)
string nombre, nif, t_pers
nombre 	= idw_principal.GetItemstring(1,'nombre_promotor')
nif		= idw_principal.GetItemstring(1,'nif_promotor')
t_pers	= idw_principal.GetItemstring(1,'t_persona')

if (not isnull(nombre)) or (not isnull(nif)) or (not isnull(t_pers)) then
	// Clientes
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases_clientes.id_cliente = clientes.id_cliente )'})
	
	if (not isnull(nombre)) then isql_nuevo +=  " and ( clientes.apellidos LIKE '" + nombre + "%')"
	if (not isnull(nif)) 	then isql_nuevo +=  " and ( clientes.nif LIKE '" + nif + "%')"
	if (not isnull(t_pers)) then isql_nuevo +=  " and ( clientes.tipo_persona LIKE '" + t_pers + "%')"
else
	// Representantes
	nombre 	= idw_principal.GetItemstring(1,'nombre_representante')
	nif		= idw_principal.GetItemstring(1,'nif_representante')
	
	if (not isnull(nombre)) or (not isnull(nif)) then
		isql_nuevo = f_sql_join(isql_nuevo, {'( fases_clientes.id_representante = clientes.id_cliente )'})
		
		if (not isnull(nombre)) then isql_nuevo +=  " and ( clientes.apellidos LIKE '" + nombre + "%')"
		if (not isnull(nif)) 	then isql_nuevo +=  " and ( clientes.nif LIKE '" + nif + "%')"
	end if
end if

//SCP-1702
ls_sql_aux = ''
ls_trabajos_intercolegiales = idw_principal.GetItemString(1,'trabajos_intercolegiales')
choose case ls_trabajos_intercolegiales
	case 'I'
		ls_sql_aux = " (fases.cod_colegio_dest <> '" + g_cod_colegio + "' "	
	case 'P'
		ls_sql_aux = " (fases.cod_colegio_dest = '" + g_cod_colegio + "' "			
		// No se tiene en cuenta en caso de que el valor sea 'T'	
end choose
if not f_es_vacio(ls_sql_aux) then 
	ls_sql_aux += ") "
	if PosA(upper(isql_nuevo), "WHERE") > 0 then
		isql_nuevo += ' and '+ ls_sql_aux
	else
		isql_nuevo += ' WHERE '+ ls_sql_aux
	end if	
end if

// Modificado Ricardo 04-04-05

f_sql('expedientes.archivo','LIKE','archivo',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.archivo','LIKE','archivo_fases',idw_principal,isql_nuevo,g_tipo_base_datos,'')// Modificado por Ricardo 04-04-02
f_sql('fases.num_coac','LIKE','coac',idw_principal,isql_nuevo,g_tipo_base_datos,'')// Modificado por Ricardo 04-04-05
f_sql('fases.e_mail','LIKE','visared',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.descripcion','LIKE','descripcion',idw_principal,isql_nuevo,g_tipo_base_datos,'')//Modificado por Yexaira 28-08-07

f_sql('expedientes.f_cierre','>=','f_cfo_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('expedientes.f_cierre','<','f_cfo_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('expedientes.cerrado','LIKE','cerrado',idw_principal,isql_nuevo,g_tipo_base_datos,'')

f_sql('poblaciones.pob_mopu','LIKE','cod_mopu',idw_principal,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.observaciones','LIKE INSIDE','obs',idw_principal,isql_nuevo,g_tipo_base_datos,'')



//A$$HEX1$$f100$$ENDHEX$$adido por Eloy 9/7/09
integer b,pos
string fases_a_incluir,fase,sql_aux2
fases_a_incluir = idw_principal.GetItemString(1,'fases')

b=1
pos=1
if not(f_es_vacio(fases_a_incluir)) then
	pos=PosA(fases_a_incluir,',',b)
	sql_aux2 = " and ( 1 = 2 " 
	do while b<LenA(fases_a_incluir)
		if pos=0 then pos=LenA(fases_a_incluir)+1
		fase = MidA(fases_a_incluir,b,pos - b)
		if not isnull(fase) then 
			fase = fase + '%'
			sql_aux2 = sql_aux2 + " or (fases.fase like '" + fase + "')" 
		end if
		b=pos+1
		pos=PosA(fases_a_incluir,',',b)
	loop
	sql_aux2 = sql_aux2 + ")"
end if

isql_nuevo = isql_nuevo + sql_aux2

// <-- Hasta aqui


end event

event csd_consulta_colegiado();boolean coma
string codigos,sql_aux,operador,opcion
string alta,sql_aux2=''
datetime df_inicio,hf_inicio,df_fin,hf_fin
int i

idw_datos_agrupacion.AcceptText()

df_inicio 	= idw_datos_agrupacion.GetItemDatetime(1,'df_inicio')
df_fin 		= idw_datos_agrupacion.GetItemDatetime(1,'df_fin')
hf_inicio 	= idw_datos_agrupacion.GetItemDatetime(1,'hf_inicio')
hf_fin 		= idw_datos_agrupacion.GetItemDatetime(1,'hf_fin')

if not isnull(df_inicio) then sql_aux= sql_aux + " and agrupaciones.f_inicio>='"+string(date(df_inicio),'yyyymmdd')+"'"
if not isnull(hf_inicio) then sql_aux= sql_aux + " and agrupaciones.f_inicio<='"+string(date(hf_inicio),'yyyymmdd')+"'"
if not isnull(df_fin) then sql_aux= sql_aux + " and agrupaciones.f_fin>='"+string(date(df_fin),'yyyymmdd')+"'"
if not isnull(hf_fin) then sql_aux= sql_aux + " and agrupaciones.f_fin<='"+string(date(hf_fin),'yyyymmdd')+"'"

//Todos los colegiados que pertenezcan a las agrupaciones elegidas, ya q se pueden elegir varias de una lista
coma=false
opcion = idw_opcion_agr.GetItemString(1,'opcion')
if opcion<>'%' then
	for i=1 to idw_agrupaciones.RowCount()
		if idw_agrupaciones.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_agrupaciones.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
end if

if sql_aux <> '' or codigos <> '' then
	isql_nuevo = f_sql_join(isql_nuevo, {'( colegiados.id_colegiado = agrupaciones.id_colegiado )'})
	isql_nuevo += sql_aux
	if codigos <> '' then isql_nuevo += ' and agrupaciones.agrupacion IN ( '+codigos+')'
end if

//Incompatibilidades
string pob,org
sql_aux=''
pob = idw_datos_sitprof.GetItemString(1,'poblacion')
org = idw_datos_sitprof.GetItemString(1,'organismo')
df_inicio 	= idw_datos_sitprof.GetItemDatetime(1,'df_inicio')
df_fin 		= idw_datos_sitprof.GetItemDatetime(1,'df_fin')
hf_inicio 	= idw_datos_sitprof.GetItemDatetime(1,'hf_inicio')
hf_fin 		= idw_datos_sitprof.GetItemDatetime(1,'hf_fin')

if not f_es_vacio(pob) then sql_aux= sql_aux + " and incompatibilidades.cod_pob like '"+pob+"%'"
if not f_es_vacio(org) then sql_aux= sql_aux + " and incompatibilidades.organismo like'"+org+"%'"
if not isnull(df_inicio) then sql_aux= sql_aux + " and incompatibilidades.fecha_inicio>='"+string(date(df_inicio),'yyyymmdd')+"'"
if not isnull(hf_inicio) then sql_aux= sql_aux + " and incompatibilidades.fecha_inicio<'"+string(date(hf_inicio),'yyyymmdd')+"'"
if not isnull(df_fin) then sql_aux= sql_aux + " and incompatibilidades.fecha_fin>='"+string(date(df_fin),'yyyymmdd')+"'"
if not isnull(hf_fin) then sql_aux= sql_aux + " and incompatibilidades.fecha_fin<'"+string(date(hf_fin),'yyyymmdd')+"'"

//Todos los colegiados que pertenezcan a las Situaciones Profesionales elegidas, ya q se pueden elegir varias de una lista
string codigos_sitprof
opcion = idw_opcion_sit.GetItemString(1,'opcion')
coma=false
if opcion<>'%' then
	for i=1 to idw_sit_profesionales.RowCount()
		if idw_sit_profesionales.GetItemString(i,'activo') = 'S' then
			if coma then codigos_sitprof= codigos_sitprof+','
			codigos_sitprof = codigos_sitprof+"'"+idw_sit_profesionales.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
end if

//Todos los colegiados que Tengan las Incompatibilidades elegidas, ya q se pueden elegir varias de una lista
string codigos_incomp
opcion = idw_opcion_incomp.GetItemString(1,'opcion')
if opcion<>'%' then
	coma=false
	for i=1 to idw_incompatibilidades.RowCount()
		if idw_incompatibilidades.GetItemString(i,'activo') = 'S' then
			if coma then codigos_incomp= codigos_incomp+','
			codigos_incomp = codigos_incomp+"'"+idw_incompatibilidades.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
end if
if sql_aux <> '' or codigos_sitprof <> '' or codigos_incomp <> '' then
	isql_nuevo = f_sql_join(isql_nuevo, {'colegiados.id_colegiado = incompatibilidades.id_colegiado'})
	isql_nuevo += sql_aux
	if codigos_sitprof <> '' then isql_nuevo += ' and incompatibilidades.tipo_situacion IN ( '+codigos_sitprof+')'
	if codigos_incomp <> '' then isql_nuevo += ' and incompatibilidades.tipo_incompatibilidad IN ( '+codigos_incomp+')'	
end if

end event

event csd_consulta_colegiado_col;string codigos,sql_aux,opcion,operador,alta
boolean coma
int i
//Todos los colegiados que pertenezcan a la situaci$$HEX1$$f300$$ENDHEX$$nes elegidas, ya q se pueden elegir varias de una lista

opcion = idw_opcion_sit.GetItemString(1,'opcion')
alta = idw_alta_si_no.GetItemString(1,'alta')
if alta<>'%' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.alta_baja = '"+alta+"'"
		else
			sql_aux = "WHERE colegiados.alta_baja = '"+alta+"'"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
end if
if opcion<>'%'  then
	coma=false
	for i=1 to idw_situaciones.RowCount()
		if idw_situaciones.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_situaciones.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.situacion "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE colegiados.situacion "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if
end if

//Todos los colegiados que pertenezcan al tipo de alta elegido, ya q se pueden elegir varias de una lista
coma=false
codigos=''
opcion = 'S' //idw_opcion_altas.GetItemString(1,'opcion')

if opcion<>'%' and idw_alta_si_no.GetItemString(1,'alta')='S' then
	for i=1 to idw_t_alta.RowCount()
		if idw_t_alta.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_t_alta.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.t_alta "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE colegiados.t_alta "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if
end if

//Todos los colegiados que pertenezcan al tipo de baja elegido, ya q se pueden elegir varias de una lista
coma=false
codigos=''
opcion = 'S' //idw_opcion_bajas.GetItemString(1,'opcion')

if opcion<>'%' and idw_alta_si_no.GetItemString(1,'alta')='N' then
	for i=1 to idw_t_baja.RowCount()
		if idw_t_baja.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_t_baja.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.t_baja "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE colegiados.t_baja "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if
end if

end event

event csd_consulta_pem_hono();boolean coma
string codigos,sql_aux,operador,opcion
string n_aviso, pendiente, sql_aux2=''
double pemd, pemh,honorariosd, honorariosh
int i

idw_pem_hono.AcceptText()

f_sql('fases.honorarios','>=','honorariosd',idw_pem_hono,isql_nuevo,g_tipo_base_datos,'')
f_sql('fases.honorarios','<=','honorariosh',idw_pem_hono,isql_nuevo,g_tipo_base_datos,'')

pemd			= idw_pem_hono.GetItemnumber(1,'pemd')
pemh			= idw_pem_hono.GetItemnumber(1,'pemh')

sql_aux = ''
if not isnull(pemd) then sql_aux +=  " and (fases_usos.pem >="+string(pemd)+")"
if not isnull(pemh) then sql_aux +=  " and (fases_usos.pem <="+string(pemh)+")"

if sql_aux <> ''  then
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases.id_fase = fases_usos.id_fase )'})
	isql_nuevo += sql_aux
end if

if sql_aux <> ''  then isql_nuevo += sql_aux

end event

event csd_consulta_minutas();boolean coma
string codigos,sql_aux,operador,opcion
string n_aviso, pendiente, sql_aux2='', tipo_gest
datetime fechad, fechah, fecha_pagod,fecha_pagoh
double imported, importeh,honorariosd, honorariosh
int i

idw_minutas.AcceptText()

n_aviso		= idw_minutas.GetItemString(1,'n_aviso')
imported		= idw_minutas.GetItemnumber(1,'imported')
importeh 	= idw_minutas.GetItemnumber(1,'importeh')
honorariosd	= idw_minutas.GetItemnumber(1,'honorariosd')
honorariosh	= idw_minutas.GetItemnumber(1,'honorariosh')
fechad 		= idw_minutas.GetItemDatetime(1,'fechad')
fechah 		= idw_minutas.GetItemDatetime(1,'fechah')
fecha_pagod = idw_minutas.GetItemDatetime(1,'fecha_pagod')
fecha_pagoh = idw_minutas.GetItemDatetime(1,'fecha_pagoh')
pendiente 	= idw_minutas.GetItemstring(1,'pendiente')
tipo_gest	= idw_minutas.GetItemString(1,'tipo_gestion')

if not isnull(n_aviso) then sql_aux += " and (fases_minutas.n_aviso like '"+n_aviso+"%')" 
if not isnull(imported) then sql_aux += " and (fases_minutas.total_aviso >="+f_cambia_comas_decimales(imported)+")"
if not isnull(importeh) then sql_aux += " and (fases_minutas.total_aviso <="+f_cambia_comas_decimales(importeh)+")" 
if not isnull(honorariosd) then sql_aux += " and (fases_minutas.base_honos >="+f_cambia_comas_decimales(honorariosd)+")" 
if not isnull(honorariosh) then sql_aux += " and ( fases_minutas.base_honos <="+f_cambia_comas_decimales(honorariosh)+")" 
if not isnull(fechad) then sql_aux += " and ( fases_minutas.fecha >='"+string(date(fechad),'yyyymmdd')+"')" 
if not isnull(fechah) then sql_aux += " and ( fases_minutas.fecha <='"+string(date(fechah),'yyyymmdd')+"')" 
if not isnull(fecha_pagod) then sql_aux += " and ( fases_minutas.fecha_pago >='"+string(date(fecha_pagod),'yyyymmdd')+"')" 
if not isnull(fecha_pagoh) then sql_aux += " and ( fases_minutas.fecha_pago <='"+string(date(fecha_pagoh),'yyyymmdd')+"')" 
if not isnull(pendiente) and pendiente <> '%' then sql_aux += " and ( fases_minutas.pendiente like '"+pendiente+"%')" 
if not isnull(tipo_gest) and tipo_gest <> '%' then sql_aux += " and ( fases_minutas.tipo_gestion like '"+tipo_gest+"%')" 

//// Tipos_gestion
//coma=false
//
//if opcion<>'%' then
//	for i=1 to idw_gestion_contrato_minutas.RowCount()
//		if idw_gestion_contrato_minutas.GetItemString(i,'activo') = 'S' then
//			if coma then codigos= codigos+','
//			codigos = codigos+"'"+idw_gestion_contrato_minutas.GetItemString(i,'codigo')+"'"
//			coma = true
//		end if
//	next
//end if

if sql_aux <> '' or codigos <> '' then
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases.id_fase = fases_minutas.id_fase )'})
	isql_nuevo += sql_aux
//	if codigos <> '' then isql_nuevo += ' and fases_minutas.tipo_gestion IN ( '+codigos+')'
end if
end event

event csd_consulta_otros_documentos();boolean coma
string codigos,sql_aux,operador,opcion
string registro, pendiente, sql_aux2=''
datetime fechad, fechah, fecha_rd,fecha_rh

int i

idw_otros_docs.AcceptText()

registro		= idw_otros_docs.GetItemString(1,'registro')
fechad 		= idw_otros_docs.GetItemDatetime(1,'fechad')
fechah 		= idw_otros_docs.GetItemDatetime(1,'fechah')
fecha_rd 	= idw_otros_docs.GetItemDatetime(1,'fecha_rd')
fecha_rh 	= idw_otros_docs.GetItemDatetime(1,'fecha_rh')


if not isnull(registro) then sql_aux += " and (fases_documentos.n_reg like '"+registro+"%')"
if not isnull(fechad) then sql_aux += " and (fases_documentos.f_entrada >='"+string(date(fechad),'yyyymmdd')+"')"
if not isnull(fechah) then sql_aux += " and (fases_documentos.f_entrada <='"+string(date(fechah),'yyyymmdd')+"')"
if not isnull(fecha_rd) then sql_aux += " and (fases_documentos.f_retira >='"+string(date(fecha_rd),'yyyymmdd')+"')"
if not isnull(fecha_rh) then sql_aux += " and (fases_documentos.f_retira <='"+string(date(fecha_rh),'yyyymmdd')+"')"

//Otros Documentos
coma=false
opcion = idw_otros_docs.GetItemString(1,'tipo')
if opcion<>'%' then
	for i=1 to idw_otros_doc_contrato.RowCount()
		if idw_otros_doc_contrato.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_otros_doc_contrato.GetItemString(i,'codigo')+"'"
			coma = true
		end if
	next

end if

if sql_aux <> '' or codigos <> '' then
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases.id_fase = fases_documentos.id_fase )'})
	isql_nuevo += sql_aux
	if codigos <> '' then isql_nuevo += ' and fases_documentos.tipo IN ( '+codigos+')'
end if

end event

event csd_consulta_finales_obra();string sql_aux,sql_aux2='', tipo, web
datetime fechad, fechah, f_intro_d, f_intro_h
double presupuestod,presupuestoh
int i

idw_final_obra.AcceptText()

fechad 			= idw_final_obra.GetItemDatetime(1,'fechad')
fechah 			= idw_final_obra.GetItemDatetime(1,'fechah')
f_intro_d		     = idw_final_obra.GetItemDatetime(1,'f_intro_d')
f_intro_h 		= idw_final_obra.GetItemDatetime(1,'f_intro_h')
presupuestod	= idw_final_obra.GetItemnumber(1,'presupuestod')
presupuestoh 	= idw_final_obra.GetItemnumber(1,'presupuestoh')
tipo		 		= idw_final_obra.GetItemstring(1,'tipo')
web		 		= idw_final_obra.GetItemstring(1,'web')

if (not isnull(f_intro_d)) or (not isnull(f_intro_h)) or (not isnull(fechad)) or (not isnull(fechah)) or (not isnull(presupuestod)) or (not isnull(presupuestoh)) or ((not isnull(tipo)) AND (tipo <> '%' ))  or ((not isnull(web)) AND (web <> '%' ))  then
	isql_nuevo = f_sql_join(isql_nuevo, {'fases.id_fase = fases_finales.id_fase'})
end if

if not isnull(fechad) then isql_nuevo += " and ( fases_finales.fecha >='"+string(date(fechad),'yyyymmdd')+"')"
if not isnull(fechah) then isql_nuevo += " and ( fases_finales.fecha <='"+string(date(fechah),'yyyymmdd')+"')"
if not isnull(f_intro_d) then isql_nuevo += " and ( fases_finales.f_intro >='"+string(date(f_intro_d),'yyyymmdd')+"')"
if not isnull(f_intro_h) then isql_nuevo += " and ( fases_finales.f_intro <='"+string(date(f_intro_h),'yyyymmdd')+"')"
if not isnull(presupuestod) then isql_nuevo += " and ( fases_finales.presupuesto >="+string(presupuestod)+")"
if not isnull(presupuestoh) then isql_nuevo += " and ( fases_finales.presupuesto <="+string(presupuestoh)+")"
if not isnull(tipo) and tipo <> '%' then isql_nuevo += " and ( fases_finales.total_parcial like '"+tipo+"%')"
if not isnull(web) and web <> '%' then isql_nuevo += " and ( fases_finales.web like '"+web+"%')"







end event

event csd_consulta_garantias();string sql_aux,sql_aux2='', tipo
datetime fechad, fechah, fechafd, fechafh
double presupuestod,presupuestoh
int i

idw_garantias.AcceptText()

fechad 		= idw_garantias.GetItemDatetime(1,'fechad')
fechah 		= idw_garantias.GetItemDatetime(1,'fechah')
fechafd 		= idw_garantias.GetItemDatetime(1,'fechafd')
fechafh 		= idw_garantias.GetItemDatetime(1,'fechafh')
presupuestod		= idw_garantias.GetItemnumber(1,'presupuestod')
presupuestoh 	= idw_garantias.GetItemnumber(1,'presupuestoh')

if (not isnull(fechad)) or (not isnull(fechah)) or (not isnull(fechafd)) or (not isnull(fechafh)) or (not isnull(presupuestod)) or (not isnull(presupuestoh) ) then
	isql_nuevo = f_sql_join(isql_nuevo, {'fases.id_fase = fases_garantias.id_fase'})
end if

if not isnull(fechad) then isql_nuevo += " and ( fases_garantias.f_in >='"+string(date(fechad),'yyyymmdd')+"')"
if not isnull(fechah) then isql_nuevo += " and ( fases_garantias.f_in <='"+string(date(fechah),'yyyymmdd')+"')"
if not isnull(fechafd) then isql_nuevo += " and ( fases_garantias.f_out >='"+string(date(fechafd),'yyyymmdd')+"')"
if not isnull(fechafh) then isql_nuevo += " and ( fases_garantias.f_out <='"+string(date(fechafh),'yyyymmdd')+"')"
if not isnull(presupuestod) then isql_nuevo += " and ( fases_garantias.importe >="+string(presupuestod)+")"
if not isnull(presupuestoh) then isql_nuevo += " and ( fases_garantias. importe <="+string(presupuestoh)+")"


end event

event csd_consulta_reclamaciones();string sql_aux,sql_aux2='', n_aviso
datetime fechad, fechah
int i

idw_reclamaciones.AcceptText()

fechad 		= idw_reclamaciones.GetItemDatetime(1,'fechad')
fechah 		= idw_reclamaciones.GetItemDatetime(1,'fechah')
n_aviso		= idw_reclamaciones.GetItemstring(1,'n_aviso')

if not isnull(fechad) then sql_aux= sql_aux + " and (fases_reclamaciones.f_reclamacion >='"+string(date(fechad),'yyyymmdd')+"')"
if not isnull(fechah) then sql_aux= sql_aux + " and (fases_reclamaciones.f_reclamacion <='"+string(date(fechah),'yyyymmdd')+"')"
if not isnull(n_aviso) then sql_aux= sql_aux + " and (fases_minutas.n_aviso like '"+n_aviso+"%')"

if sql_aux <> ''  then
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases.id_fase = fases_minutas.id_fase )', '( fases_minutas.id_minuta = fases_reclamaciones.id_minuta )'})
	isql_nuevo += sql_aux
end if
end event

event csd_consulta_reparos();string sql_aux,sql_aux2='', tipo
datetime fechad, fechah, fechafd, fechafh
double presupuestod,presupuestoh
int i

idw_reparos.AcceptText()

fechad 		= idw_reparos.GetItemDatetime(1,'fechad')
fechah 		= idw_reparos.GetItemDatetime(1,'fechah')
fechafd 		= idw_reparos.GetItemDatetime(1,'fechafd')
fechafh 		= idw_reparos.GetItemDatetime(1,'fechafh')

if not isnull(fechad) then sql_aux += " and ( fases_reparos.f_emision >='"+string(date(fechad),'yyyymmdd')+"')"
if not isnull(fechah) then sql_aux += " and ( fases_reparos.f_emision <='"+string(date(fechah),'yyyymmdd')+"')"
if not isnull(fechafd) then sql_aux +=" and ( fases_reparos.f_subsanacion >='"+string(date(fechafd),'yyyymmdd')+"')"
if not isnull(fechafh) then sql_aux +=" and ( fases_reparos.f_subsanacion <='"+string(date(fechafh),'yyyymmdd')+"')"

if sql_aux <> ''  then
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases.id_fase = fases_reparos.id_fase )'})
	isql_nuevo += sql_aux
end if


end event

event csd_consulta_registros();string sql_aux,sql_aux2='', tipo
datetime fechad, fechah
double presupuestod,presupuestoh
int i

idw_registro_es.AcceptText()

fechad 		= idw_registro_es.GetItemDatetime(1,'fechad')
fechah 		= idw_registro_es.GetItemDatetime(1,'fechah')

if not isnull(fechad) then sql_aux += " and (registro.fecha >='"+string(date(fechad),'yyyymmdd')+"')"
if not isnull(fechah) then sql_aux += " and (registro.fecha <='"+string(date(fechah),'yyyymmdd')+"')"

if sql_aux <> ''  then
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases.n_registro = registro.n_expediente)'})
	isql_nuevo += sql_aux
end if
end event

event csd_consulta_arquitectos();string sql_aux,sql_aux2='', nombre, apellidos
int i

idw_arquitectos.AcceptText()

nombre 		= idw_arquitectos.GetItemstring(1,'nombre')
apellidos	= idw_arquitectos.GetItemstring(1,'apellidos')

if (not isnull(nombre)) or (not isnull(apellidos) ) then
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases.id_fase = fases_arquitectos.id_fase )'})
else
	return
end if

if (not isnull(nombre))  then isql_nuevo +=  " and ( fases_arquitectos.nombre like '" + nombre + "%')"
if (not isnull(apellidos))  then isql_nuevo +=  " and ( fases_arquitectos.apellidos like '" + apellidos + "%')"

end event

event csd_consulta_residente();boolean coma
string codigos,sql_aux,operador,opcion
string alta,sql_aux2=''
int i

//Todos los colegiados que Tengan el residente elegido, ya q se pueden elegir varias de una lista
opcion = idw_opcion_residente.GetItemString(1,'opcion')
if opcion<>'%' then
	if not f_es_vacio(sql_aux2) then sql_aux2 = 'and '+sql_aux2
	coma=false
	for i=1 to idw_residente.RowCount()
		if idw_residente.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_residente.GetItemString(i,'c_geografico')+"'"
			coma = true
		end if
	next
	if opcion='S' then operador=''
	if opcion='N' then operador='NOT'
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and colegiados.c_geografico "+operador+" IN  ("+codigos+")"
		else
			sql_aux = "WHERE colegiados.c_geografico "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if
else
	if not(f_es_vacio(sql_aux2)) then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = 'and ' + sql_aux2
		else
			sql_aux = "WHERE " + sql_aux2
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if
end if

end event

event csd_oculta();boolean gest_min, estado_cont, gest_cont, modal_cont, tipo_docs, agr, sitprof, incomp, sitresi, alta, baja, situ
boolean tipoact, tipoobra, destino

//gest_min = (idw_minutas.getitemstring(1, 'tipo_gestion') = 'S')
//idw_gestion_contrato_minutas.visible = gest_min

estado_cont = (idw_seleccion_estados.getitemstring(1, 'opcion') = 'S')
idw_estados_contrato.visible = estado_cont
tab_1.tabpage_2.cb_todos1.visible = estado_cont
tab_1.tabpage_2.cb_borrar1.visible = estado_cont

gest_cont = (idw_seleccion_gestion.getitemstring(1, 'opcion') = 'S')
idw_gestion_contrato.visible = gest_cont
tab_1.tabpage_2.cb_todos2.visible = gest_cont
tab_1.tabpage_2.cb_borrar2.visible = gest_cont

modal_cont = (idw_seleccion_modalidad.getitemstring(1, 'opcion') = 'S')
idw_modalidad_contrato.visible = modal_cont
tab_1.tabpage_2.cb_todos3.visible = modal_cont
tab_1.tabpage_2.cb_borrar3.visible = modal_cont

tipo_docs = (idw_otros_docs.getitemstring(1, 'tipo') = 'S')
idw_otros_doc_contrato.visible = tipo_docs

agr = (idw_opcion_agr.GetItemString(1,'opcion')='S')
idw_agrupaciones.visible = agr
tab_1.tabpage_3.cb_incluir4.visible = agr
tab_1.tabpage_3.cb_borrar4.visible = agr

sitprof = (idw_opcion_sit.GetItemString(1,'opcion')='S')  
idw_sit_profesionales.visible = sitprof
tab_1.tabpage_3.cb_3.visible = sitprof
tab_1.tabpage_3.cb_4.visible = sitprof

incomp = (idw_opcion_incomp.GetItemString(1,'opcion')='S')
idw_incompatibilidades.visible = incomp
tab_1.tabpage_3.cb_5.visible = incomp
tab_1.tabpage_3.cb_6.visible = incomp

sitresi = ( idw_opcion_residente.GetItemString(1,'opcion')='S')  
idw_residente.visible = sitresi
tab_1.tabpage_10.cb_todos5.visible = sitresi
tab_1.tabpage_10.cb_borrar5.visible = sitresi


situ = ( idw_opcion_situaciones.GetItemString(1,'opcion')='S')  
idw_situaciones.visible = situ
tab_1.tabpage_4.cb_todos10.visible = situ
tab_1.tabpage_4.cb_borrar10.visible = situ

tipoact =  ( idw_tipo_actuacion_seleccion.GetItemString(1,'opcion')='S')  
idw_tipoact.visible = tipoact
tab_1.tabpage_9.cb_todos1_est.visible = tipoact
tab_1.tabpage_9.cb_borrar1_est.visible = tipoact

tipoobra =  ( idw_tipo_obra_seleccion.GetItemString(1,'opcion')='S')  
idw_tipoobra.visible = tipoobra
tab_1.tabpage_9.cb_todos2_est.visible = tipoobra
tab_1.tabpage_9.cb_borrar2_est.visible = tipoobra

destino =  ( idw_destino_seleccion.GetItemString(1,'opcion')='S')  
idw_destino.visible = destino
tab_1.tabpage_9.cb_todos3_est.visible = destino
tab_1.tabpage_9.cb_borrar3_est.visible = destino


string data
data = idw_alta_si_no.GetItemString(1,'alta')
choose case data 
 case 'S' 
  alta = true
  baja = false
  //tab_1.tabpage_4.cb_todos2.TriggerEvent(Clicked!)
 case 'N'
  alta = false
  baja = true
//  tab_1.tabpage_4.cb_todos30.TriggerEvent(Clicked!)
 case else
  alta = false
  baja = false
end choose
 
tab_1.tabpage_4.gb_3.visible= baja
tab_1.tabpage_4.cb_todos30.visible= baja
tab_1.tabpage_4.cb_borrar30.visible = baja
idw_t_baja.visible = baja
tab_1.tabpage_4.gb_2.visible=alta
tab_1.tabpage_4.cb_todos20.visible=alta
tab_1.tabpage_4.cb_borrar20.visible = alta
idw_t_alta.visible = alta
end event

event csd_consulta_estadistica();string codigos,sql_aux,opcion,operador
boolean coma
int i



// Tipo de actuaci$$HEX1$$f300$$ENDHEX$$n
opcion = idw_tipo_actuacion_seleccion.GetItemString(1,'opcion')
if opcion<>'%' then 
	coma=false
	for i=1 to idw_tipoact.RowCount()
		if idw_tipoact.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_tipoact.GetItemString(i,'c_t_fase')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and fases.fase "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE fases.fase "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if
end if

//Tipo de obra
coma=false
codigos=''
opcion = idw_tipo_obra_seleccion.GetItemString(1,'opcion')
if opcion<>'%' then 
	for i=1 to idw_tipoobra.RowCount()
		if idw_tipoobra.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_tipoobra.GetItemString(i,'c_t_trabajo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and fases.tipo_trabajo "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE fases.tipo_trabajo "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if
end if
	
// Destino
coma=false
codigos=''
opcion = idw_destino_seleccion.GetItemString(1,'opcion')
if opcion<>'%' then 
	for i=1 to idw_destino.RowCount()
		if idw_destino.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_destino.GetItemString(i,'c_trabajo')+"'"
			coma = true
		end if
	next
	if opcion = 'S' then operador=''
	if opcion = 'N' then operador = 'NOT'
	if codigos<>'' then
		if PosA(upper(isql_nuevo), "WHERE") > 0  then
			sql_aux = "and fases.trabajo "+operador+" IN ("+codigos+")"
		else
			sql_aux = "WHERE fases.trabajo "+operador+" IN ("+codigos+")"
		end if	
		if not isnull(sql_aux) then isql_nuevo += sql_aux
	end if	
end if
end event

event csd_consulta_tarifas();// COAATZ
boolean coma
string codigos, sql_aux, opcion
long i

coma=false
opcion = idw_opcion_tarifas.GetItemString(1,'opcion')
if opcion<>'%' then
	for i=1 to idw_tarifas.RowCount()
		if idw_tarifas.GetItemString(i,'activo') = 'S' then
			if coma then codigos= codigos+','
			codigos = codigos+"'"+idw_tarifas.GetItemString(i,'cod_tarifa')+"'"
			coma = true
		end if
	next

end if

if codigos <> '' then
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases.id_fase = fases_cip_tfe.id_fase )'})
	isql_nuevo += sql_aux
	if codigos <> '' then isql_nuevo += ' and fases_cip_tfe.tarifa IN ( '+codigos+')'
end if

end event

event csd_consulta_renuncia();// Juli$$HEX1$$e100$$ENDHEX$$n Melero

string sql_aux,sql_aux2='', tipo,renuncia,web
datetime fechad, fechah
double presupuestod,presupuestoh
int i

idw_renuncias.AcceptText()

fechad 	= idw_renuncias.GetItemDatetime(1,'fechad')
fechah 	= idw_renuncias.GetItemDatetime(1,'fechah')
renuncia =  idw_renuncias.GetItemstring(1,'renuncia')
web       =  idw_renuncias.GetItemstring(1,'web')

if not isnull(fechad) then sql_aux += " and (fases_renuncias.fecha >='"+string(date(fechad),'yyyymmdd 00:00:00')+"')"
if not isnull(fechah) then sql_aux += " and (fases_renuncias.fecha <='"+string(date(fechah),'yyyymmdd 23:59:59')+"')"
//if not isnull(renuncia) then sql_aux += " and (fases_renuncias.id_renuncia like '"+right('0000000000' + renuncia,10)+"')"
if not isnull(renuncia) then sql_aux += " and (fases_renuncias.n_renuncia like '"+renuncia+"%')"
if not isnull(web) and web <> '%' then sql_aux += " and ( fases_renuncias.web like '"+web+"%')"


if sql_aux <> ''  then
	isql_nuevo = f_sql_join(isql_nuevo, {'( fases.id_fase = fases_renuncias.id_fase)'})
	isql_nuevo += sql_aux
end if
end event

on w_fases_consulta.create
int iCurrent
call super::create
this.rb_completa=create rb_completa
this.rb_preasignada=create rb_preasignada
this.dw_2=create dw_2
this.dw_tipos_estados=create dw_tipos_estados
this.tab_1=create tab_1
this.cbx_minutas=create cbx_minutas
this.gb_1=create gb_1
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.rb_completa
this.Control[iCurrent+2]=this.rb_preasignada
this.Control[iCurrent+3]=this.dw_2
this.Control[iCurrent+4]=this.dw_tipos_estados
this.Control[iCurrent+5]=this.tab_1
this.Control[iCurrent+6]=this.cbx_minutas
this.Control[iCurrent+7]=this.gb_1
end on

on w_fases_consulta.destroy
call super::destroy
destroy(this.rb_completa)
destroy(this.rb_preasignada)
destroy(this.dw_2)
destroy(this.dw_tipos_estados)
destroy(this.tab_1)
destroy(this.cbx_minutas)
destroy(this.gb_1)
end on

event open;call super::open;
f_centrar_ventana(this) 

idw_principal = tab_1.tabpage_1.dw_principal
idw_pem_hono = tab_1.tabpage_1.dw_pem_hono

idw_estados_contrato = tab_1.tabpage_2.dw_estados_contrato
idw_gestion_contrato = tab_1.tabpage_2.dw_gestion_contrato
idw_modalidad_contrato = tab_1.tabpage_2.dw_modalidad_contrato
idw_seleccion_estados = tab_1.tabpage_2.dw_seleccion_estados
idw_seleccion_gestion = tab_1.tabpage_2.dw_seleccion_gestion
idw_seleccion_modalidad = tab_1.tabpage_2.dw_seleccion_modalidad

idw_colegio_dest =  tab_1.tabpage_2.dw_consulta_col_destino
idw_seleccion_col_dest =  tab_1.tabpage_2.dw_seleccion_col_destino

idw_datos_agrupacion = tab_1.tabpage_3.dw_datos_agrupacion
idw_datos_sitprof = tab_1.tabpage_3.dw_datos_sitprof
idw_agrupaciones = tab_1.tabpage_3.dw_agrupaciones
idw_sit_profesionales = tab_1.tabpage_3.dw_sit_profesionales
idw_incompatibilidades = tab_1.tabpage_3.dw_incompatibilidades
idw_opcion_agr = tab_1.tabpage_3.dw_opcion_agr
idw_opcion_sit = tab_1.tabpage_3.dw_opcion_sit
idw_opcion_incomp = tab_1.tabpage_3.dw_opcion_incomp

idw_alta_si_no = tab_1.tabpage_4.dw_alta_si_no
idw_opcion_situaciones = tab_1.tabpage_4.dw_opcion_situaciones
idw_opcion_altas = tab_1.tabpage_4.dw_opcion_altas
idw_opcion_bajas = tab_1.tabpage_4.dw_opcion_bajas
idw_situaciones = tab_1.tabpage_4.dw_situaciones
idw_t_alta = tab_1.tabpage_4.dw_t_alta
idw_t_baja = tab_1.tabpage_4.dw_t_baja
idw_minutas = tab_1.tabpage_5.dw_minutas
idw_final_obra = tab_1.tabpage_6.dw_final_obra
idw_garantias = tab_1.tabpage_6.dw_garantias
idw_reclamaciones = tab_1.tabpage_6.dw_reclamaciones
idw_reparos = tab_1.tabpage_6.dw_reparos
idw_registro_es = tab_1.tabpage_6.dw_registro_es
idw_otros_docs = tab_1.tabpage_7.dw_otros_docs
idw_otros_doc_contrato = tab_1.tabpage_7.dw_otros_doc_contrato
idw_arquitectos = tab_1.tabpage_8.dw_arquitectos
idw_residente = tab_1.tabpage_10.dw_residente
idw_opcion_residente = tab_1.tabpage_10.dw_opcion_residente
idw_tipo_actuacion_seleccion = tab_1.tabpage_9.dw_tipo_actuacion_seleccion
idw_tipo_obra_seleccion = tab_1.tabpage_9.dw_tipo_obra_seleccion
idw_destino_seleccion = tab_1.tabpage_9.dw_destino_seleccion
idw_tipoact = tab_1.tabpage_9.dw_tipoact
idw_tipoobra = tab_1.tabpage_9.dw_tipoobra
idw_destino = tab_1.tabpage_9.dw_destino
idw_tarifas = tab_1.tabpage_11.dw_honos_tarifas
idw_opcion_tarifas = tab_1.tabpage_11.dw_opcion_tarifa
idw_renuncias =     tab_1.tabpage_6.dw_renuncias

idw_principal.insertrow(0)
idw_pem_hono.insertrow(0)
idw_seleccion_estados.insertrow(0)
idw_seleccion_gestion.insertrow(0)
idw_seleccion_col_dest.insertrow(0)
idw_seleccion_modalidad.insertrow(0)
idw_datos_agrupacion.insertrow(0)
idw_datos_sitprof.insertrow(0)
idw_opcion_agr.insertrow(0)
idw_opcion_sit.insertrow(0)
idw_opcion_incomp.insertrow(0)
idw_datos_agrupacion.insertrow(0)
idw_alta_si_no.insertrow(0)
idw_opcion_situaciones.insertrow(0)
idw_opcion_altas.insertrow(0)
idw_opcion_bajas.insertrow(0)
idw_minutas.insertrow(0)
idw_final_obra.insertrow(0)
idw_garantias.insertrow(0)
idw_reclamaciones.insertrow(0)
idw_renuncias.insertrow(0)


idw_reparos.insertrow(0)
idw_registro_es.insertrow(0)
idw_otros_docs.insertrow(0)
idw_arquitectos.insertrow(0)
idw_opcion_residente.insertrow(0)
idw_tipo_actuacion_seleccion.insertrow(0)
idw_tipo_obra_seleccion.insertrow(0)
idw_destino_seleccion.insertrow(0)
idw_opcion_tarifas.insertrow(0)

/*  //SE RETRIVEAN AL CAMBIAR EL TAB.
    // MIRAR EL EVENTO TAB_1.SELECTIONCHAGED
idw_estados_contrato.retrieve() //tabpage_2
idw_gestion_contrato.retrieve() //tabpage_2
idw_modalidad_contrato.retrieve() //tabpage_2
idw_agrupaciones.retrieve() //tabpage_2
idw_sit_profesionales.retrieve() //tabpage_3
idw_incompatibilidades.retrieve() //tabpage_3
idw_situaciones.retrieve() //tabpage_4
idw_t_alta.retrieve()
idw_t_baja.retrieve()
//idw_gestion_contrato_minutas.retrieve()
idw_otros_doc_contrato.retrieve()
idw_residente.retrieve()
idw_tipoact.retrieve()
idw_tipoobra.retrieve()
idw_destino.retrieve()
*/

if g_colegio = 'COAATZ' then
	idw_tarifas.retrieve()
	tab_1.tabpage_11.visible = true	
end if

idw_principal.SetFocus()
idw_principal.SetColumn('n_expediente')

if g_colegio = 'COAATGU' then cbx_minutas.visible = true

// Llamamos al control de eventos con el dw_principal
st_control_eventos c_evento
c_evento.evento = 'ABRIR_CONSULTA_FASES'
c_evento.dw = idw_principal
if f_control_eventos(c_evento)=-1 then return



end event

event clicked;//dw_tipos_estados.visible = false

end event

event pfc_postopen;call super::pfc_postopen;// Llamamos al control de eventos con el idw_renuncias
st_control_eventos c_evento1
c_evento1.evento = 'ABRIR_CONSULTA_FASES'
c_evento1.dw = idw_renuncias
if f_control_eventos(c_evento1)=-1 then return

// Llamamos al control de eventos con el idw_renuncias
st_control_eventos c_evento2
c_evento2.evento = 'ABRIR_CONSULTA_FASES'
c_evento2.dw = idw_final_obra
if f_control_eventos(c_evento2)=-1 then return

this.post event csd_oculta()


end event

type cb_recuperar_pantalla from w_consulta`cb_recuperar_pantalla within w_fases_consulta
boolean visible = true
integer x = 2811
integer y = 516
integer width = 402
integer height = 80
integer taborder = 50
string text = "Recuperar "
end type

event cb_recuperar_pantalla::clicked;call super::clicked;parent.post event csd_oculta()
end event

type cb_guardar_pantalla from w_consulta`cb_guardar_pantalla within w_fases_consulta
boolean visible = true
integer x = 2811
integer y = 616
integer width = 402
integer height = 80
integer taborder = 70
string text = "Grabar "
end type

type cb_limpiar from w_consulta`cb_limpiar within w_fases_consulta
integer x = 2811
integer y = 1160
integer width = 402
integer taborder = 100
end type

type st_5 from w_consulta`st_5 within w_fases_consulta
integer x = 96
integer y = 16
end type

type cb_1 from w_consulta`cb_1 within w_fases_consulta
integer x = 2811
integer y = 316
integer width = 402
integer taborder = 30
fontcharset fontcharset = ansi!
end type

event cb_1::clicked;call super::clicked;string sql_aux,sql_copia
string n_colegiado, n_nif, n_fase
integer control_campo_por_defecto
boolean coma
string codigos
int i

idw_principal.AcceptText()
idw_estados_contrato.AcceptText()
idw_gestion_contrato.AcceptText()
idw_modalidad_contrato.AcceptText()
idw_datos_agrupacion.AcceptText()
idw_datos_sitprof.AcceptText()
idw_agrupaciones.AcceptText()
idw_sit_profesionales.AcceptText()
idw_incompatibilidades.AcceptText()
idw_alta_si_no.AcceptText()
idw_situaciones.AcceptText()
idw_t_alta.AcceptText()
idw_t_baja.AcceptText()
idw_minutas.AcceptText()
//idw_gestion_contrato_minutas.AcceptText()

idw_otros_docs.AcceptText()
idw_otros_doc_contrato.Accepttext()
idw_final_obra.Accepttext()
idw_garantias.Accepttext()
idw_reclamaciones.Accepttext()
idw_reparos.AcceptText()
idw_registro_es.AcceptText()
idw_arquitectos.AcceptText()
idw_residente.AcceptText()
idw_tarifas.AcceptText()

if i_resultado<>'mal' then
	i_resultado='ok'
	i_exp=idw_principal.getitemstring(1,'n_expediente')
	if i_exp='0' then i_exp=''
	
	if rb_completa.checked=true then
			g_dw_lista.dataobject='d_fases_lista'
			g_dw_lista.SetTransObject(SQLCA)			

			//	al final del todo colocamos lo siguiente
			// MODIFICADO RICARDO 04-07-07
			// Llamamos al control de eventos evento 'ABRIR_LISTA_FASES'
			st_control_eventos c_evento
			c_evento.evento = 'ABRIR_LISTA_FASES'
			c_evento.dw = g_dw_lista
			if f_control_eventos(c_evento)=-1 then return
			// MODIFICADO RICARDO 04-07-07
		
			isql_nuevo = g_dw_lista.describe("datawindow.table.select")	
			sql_copia=isql_nuevo

			parent.triggerevent ('csd_consulta_principal')			
			parent.triggerevent ('csd_consulta_pem_hono')		
			parent.triggerevent ('csd_consulta_control')	
			parent.TriggerEvent ('csd_consulta_estadistica')
			parent.triggerevent ('csd_consulta_colegiado')
			parent.triggerevent ('csd_consulta_colegiado_col')
			parent.triggerevent ('csd_consulta_minutas')
			
			parent.triggerevent ('csd_consulta_otros_documentos')
			parent.triggerevent ('csd_consulta_finales_obra')
			parent.triggerevent ('csd_consulta_garantias')
			parent.triggerevent ('csd_consulta_reclamaciones')
			parent.triggerevent ('csd_consulta_reparos')
			parent.triggerevent ('csd_consulta_registros')
			parent.triggerevent ('csd_consulta_arquitectos')
			parent.TriggerEvent ('csd_consulta_residente')
			parent.TriggerEvent ('csd_consulta_tarifas')
			parent.TriggerEvent ('csd_consulta_renuncia')
			
			if isql_nuevo=sql_copia then 
				MessageBox(g_titulo,g_idioma.of_getmsg('msg_musaat.especificar_param_busqueda','Ha de especificar al menos un par$$HEX1$$e100$$ENDHEX$$metro de b$$HEX1$$fa00$$ENDHEX$$squeda'))
			else

				
				// En Guadalajara por defecto no quieren ver las minutas
				if g_colegio = 'COAATGU' then
					if cbx_minutas.checked = true then 
						f_sql_valores('fases.tipo_registro','=','MI','CH',isql_nuevo,g_tipo_base_datos,'')
					else
						f_sql_valores('fases.tipo_registro','<>','MI','CH',isql_nuevo,g_tipo_base_datos,'')
					end if
				end if
				
				g_dw_lista.modify("datawindow.table.select= ~"" + isql_nuevo + "~"")
				closewithreturn(parent,1)
			end if
								
		else
			g_dw_lista.dataobject='d_fases_lista_pre'
			g_dw_lista.SetTransObject(SQLCA)			
			isql_nuevo = g_dw_lista.describe("datawindow.table.select")	
			sql_copia=isql_nuevo
		
			//f_sql('fases.n_expedi','LIKE','n_expediente',idw_principal,sql_nuevo,g_tipo_base_datos,'')
			if not f_es_vacio(idw_principal.getitemstring(1,'n_expediente')) then
				isql_nuevo=isql_nuevo + "and expedientes.n_expedi LIKE '" + i_exp + "%'"
			end if			
			f_sql('fases.n_registro','LIKE','n_registro',idw_principal,isql_nuevo,g_tipo_base_datos,'')
			f_sql('fases.f_entrada','>=','f_entrada_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
			f_sql('fases.f_entrada','<','f_entrada_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')
			
		
			//En el caso de los preasignados no es necesario que introduzcan al menos un par$$HEX1$$e100$$ENDHEX$$metro de b$$HEX1$$fa00$$ENDHEX$$squeda
			g_dw_lista.modify("datawindow.table.select= ~"" + isql_nuevo + "~"")
			closewithreturn(parent,1)
			
		end if
		
	end if

// Se vuelve a llamar a la funci$$HEX1$$f300$$ENDHEX$$n de traducci$$HEX1$$f300$$ENDHEX$$n porque se puede haber cambiado el dw por control de eventos	
if g_usar_idioma='S' then g_idioma.of_cambia_textos_dw(g_dw_lista)
end event

type cb_2 from w_consulta`cb_2 within w_fases_consulta
integer x = 2811
integer y = 416
integer width = 402
integer taborder = 40
end type

type cb_ayuda from w_consulta`cb_ayuda within w_fases_consulta
integer x = 2811
integer y = 1260
integer width = 402
integer taborder = 110
end type

type dw_1 from w_consulta`dw_1 within w_fases_consulta
event csd_borrar_codigos ( )
boolean visible = false
integer x = 3136
integer y = 1696
integer width = 101
integer height = 212
integer taborder = 60
string dataobject = "d_fases_consulta"
end type

event dw_1::csd_borrar_codigos;dw_1.setitem(1,message.stringparm,'')
setcolumn(i_tab)
end event

event dw_1::constructor;call super::constructor;this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)

this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)

end event

event dw_1::buttonclicked;call super::buttonclicked;string id_col, id_cliente
string pob, ls_anterior

choose case dwo.name
	case "b_busca_colegiado"
  		g_busqueda.titulo="B$$HEX1$$fa00$$ENDHEX$$squeda r$$HEX1$$e100$$ENDHEX$$pida de Colegiados"
		g_busqueda.dw="d_lista_busqueda_colegiados"
		id_col=f_busqueda_colegiados()   
		if NOT f_es_vacio(id_col)  then
			this.setitem(this.getrow(),'n_colegiado',f_colegiado_n_col(id_col))
//			 this.setitem(this.getrow(),'nombre_colegiado',f_colegiado_apellido(id_col))
//		else
//			this.setitem(this.getrow(),'n_colegiado',"")
//			this.setitem(this.getrow(),'nombre_colegiado',"")
		end if

case "b_busca_cliente"
	g_busqueda.titulo="B$$HEX1$$fa00$$ENDHEX$$squeda r$$HEX1$$e100$$ENDHEX$$pida de clientes"
	g_busqueda.dw="d_lista_busqueda_clientes"
	id_cliente=f_busqueda_clientes("")
	if NOT f_es_vacio(id_cliente)  then
		this.setitem(this.getrow(),'nif_promotor',f_dame_nif(id_cliente))
	//	this.setitem(this.getrow(),'nombre_promotor',f_dame_cliente(id_cliente))
//	else
//		this.setitem(this.getrow(),'nif_promotor',"")
//		this.setitem(this.getrow(),'nombre_promotor',"")
	end if


	CASE 'bb_poblacion'
		g_busqueda.titulo='Poblaciones'
		g_busqueda.dw='d_poblaciones_lista_busqueda'
		ls_anterior = g_bloqueo_fases
		g_bloqueo_fases = 'S'
		pob=f_busqueda_poblaciones()
		g_bloqueo_fases = ls_anterior
		if f_es_vacio(pob) then return
		this.SetItem(1,'poblacion',pob)

END CHOOSE
	
end event

event dw_1::itemerror;call super::itemerror;// messagebox(g_titulo,'La informaci$$HEX1$$f300$$ENDHEX$$n introducida en alg$$HEX1$$fa00$$ENDHEX$$n par$$HEX1$$e100$$ENDHEX$$metro es incorrecta')
return 1
end event

event dw_1::itemchanged;call super::itemchanged;integer i
string cod,exp
boolean sw
cod='***'
choose case dwo.name
	case 'n_expediente'
		i_exp=data
		if i_exp='0' then
			i_exp=''
			i_resultado='mal'
		else
			i_resultado='ok'
		end if
	case 'n_registro'

		case 'tipo_trabajo'
			SELECT tipos_trabajos.c_t_trabajo INTO :cod FROM tipos_trabajos WHERE tipos_trabajos.c_t_trabajo = :data;
			sw=true
		case 'trabajo'	
			SELECT trabajos.c_trabajo INTO :cod FROM trabajos WHERE trabajos.c_trabajo = :data ;
			sw=true
		case 'poblacion'
			SELECT poblaciones.cod_pob INTO :cod FROM poblaciones WHERE poblaciones.cod_pob = :data ;
			sw=true
		case 'estado'
			SELECT expedientes_estado.descripcion INTO :cod FROM expedientes_estado  
   			WHERE expedientes_estado.cod_estado = :data;
			sw=true
		case 'tipo_gestion'
			SELECT t_gestion.descripcion INTO :cod FROM t_gestion
					WHERE t_gestion.cod_gestion = :data;
			sw=true			
	end choose
	
	if cod='***' and sw=true then
		MessageBox(g_titulo,g_idioma.of_getmsg('fases.msg_codigo_inexistente','Este c$$HEX1$$f300$$ENDHEX$$digo no existe.'))
		message.stringparm=string(dwo.name)
		postevent ("csd_borrar_codigos")
	end if
end event

event dw_1::itemfocuschanged;dw_tipos_estados.visible=false

choose case dwo.name
	case 'n_expediente'
	case else
		dw_1.setitem(1,'n_expediente',i_exp)
end choose



end event

event dw_1::clicked;call super::clicked;int i
string codigos

choose case dwo.name
	case 'estado'

			if dw_tipos_estados.visible = false then
				dw_tipos_estados.visible = true
			else
				dw_tipos_estados.visible = false
				for i=1 to dw_tipos_estados.RowCount()
					if dw_tipos_estados.GetItemString(i,'activo')='S' then
						codigos = codigos +' '+dw_tipos_estados.GetItemString(i,'cod_estado')
					end if
				next
			end if
			this.SetItem(1,'estado',codigos)
end choose
end event

type rb_completa from radiobutton within w_fases_consulta
integer x = 2798
integer y = 52
integer width = 425
integer height = 64
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Completos"
boolean checked = true
end type

event clicked;rb_completa.enabled=false
rb_preasignada.enabled=true
dw_1.dataobject='d_fases_consulta'
dw_1.Event pfc_addrow()
dw_1.of_SetDropDownCalendar(false)
dw_1.of_SetDropDownCalendar(True)
dw_1.iuo_calendar.of_register(dw_1.iuo_calendar.DDLB)
dw_1.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
dw_1.iuo_calendar.of_SetInitialValue(True)

end event

type rb_preasignada from radiobutton within w_fases_consulta
integer x = 2798
integer y = 124
integer width = 425
integer height = 60
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Preasignados"
end type

event clicked;rb_completa.enabled=true
rb_preasignada.enabled=false
dw_1.dataobject='d_fases_consulta_pre'
dw_1.Event pfc_addrow()
dw_1.of_SetDropDownCalendar(false)
dw_1.of_SetDropDownCalendar(True)
dw_1.iuo_calendar.of_register(dw_1.iuo_calendar.DDLB)
dw_1.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
dw_1.iuo_calendar.of_SetInitialValue(True)
dw_2.visible = false
end event

type dw_2 from u_dw within w_fases_consulta
boolean visible = false
integer x = 2926
integer y = 1484
integer width = 279
integer height = 156
integer taborder = 90
boolean bringtotop = true
string dataobject = "d_fases_consulta_minutas"
boolean vscrollbar = false
boolean border = false
borderstyle borderstyle = stylebox!
end type

type dw_tipos_estados from u_dw within w_fases_consulta
boolean visible = false
integer x = 2930
integer y = 1688
integer width = 87
integer height = 228
integer taborder = 80
boolean bringtotop = true
string dataobject = "d_fases_t_estados_consulta"
borderstyle borderstyle = stylebox!
end type

type tab_1 from tab within w_fases_consulta
integer x = 37
integer y = 64
integer width = 2670
integer height = 2240
integer taborder = 10
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long backcolor = 79741120
boolean multiline = true
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabpage_1 tabpage_1
tabpage_5 tabpage_5
tabpage_9 tabpage_9
tabpage_2 tabpage_2
tabpage_7 tabpage_7
tabpage_6 tabpage_6
tabpage_8 tabpage_8
tabpage_3 tabpage_3
tabpage_4 tabpage_4
tabpage_10 tabpage_10
tabpage_11 tabpage_11
end type

on tab_1.create
this.tabpage_1=create tabpage_1
this.tabpage_5=create tabpage_5
this.tabpage_9=create tabpage_9
this.tabpage_2=create tabpage_2
this.tabpage_7=create tabpage_7
this.tabpage_6=create tabpage_6
this.tabpage_8=create tabpage_8
this.tabpage_3=create tabpage_3
this.tabpage_4=create tabpage_4
this.tabpage_10=create tabpage_10
this.tabpage_11=create tabpage_11
this.Control[]={this.tabpage_1,&
this.tabpage_5,&
this.tabpage_9,&
this.tabpage_2,&
this.tabpage_7,&
this.tabpage_6,&
this.tabpage_8,&
this.tabpage_3,&
this.tabpage_4,&
this.tabpage_10,&
this.tabpage_11}
end on

on tab_1.destroy
destroy(this.tabpage_1)
destroy(this.tabpage_5)
destroy(this.tabpage_9)
destroy(this.tabpage_2)
destroy(this.tabpage_7)
destroy(this.tabpage_6)
destroy(this.tabpage_8)
destroy(this.tabpage_3)
destroy(this.tabpage_4)
destroy(this.tabpage_10)
destroy(this.tabpage_11)
end on

event selectionchanged;if i_tabs_visitados[newindex]<>1 then
	i_tabs_visitados[newindex]=1
	choose case newindex
		case 3  //ESTADISTICAS
			idw_tipoact.retrieve()
			idw_tipoobra.retrieve()
			idw_destino.retrieve()			
		case 4  // CONTRATO CONTROL
			idw_estados_contrato.retrieve() 
			idw_gestion_contrato.retrieve() 
			idw_modalidad_contrato.retrieve() 
			idw_colegio_dest.retrieve()
		case 5  //OTROS DOCUMENTOS
			idw_otros_doc_contrato.retrieve()
		case 8 // COLEGIADOS SIT.PROFESIONAL
			idw_agrupaciones.retrieve()
			idw_sit_profesionales.retrieve() 
			idw_incompatibilidades.retrieve() 			
		case 9  // COLEGIADOS SIT.COLEGIAL
			idw_situaciones.retrieve() 
			idw_t_alta.retrieve()
			idw_t_baja.retrieve()
		case 10  // COLEGIADOS SIT. RESIDENTE
			idw_residente.retrieve()		
	end choose
	
end if
		

end event

type tabpage_1 from userobject within tab_1
event csd_consulta_principal ( )
string tag = "texto=fases.contrato_prinicpal"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Contrato Principal"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
st_1 st_1
lb_1 lb_1
dw_principal dw_principal
dw_pem_hono dw_pem_hono
end type

event csd_consulta_principal();//string n_colegiado,n_nif
//
////Se inicializan los id de Colegiado y cliente para no alterar el sql
//idw_principal.setitem(1,'id_colegiado','')
//idw_principal.setitem(1,'id_cliente','')
//
//// Se preparan los id de Colegiados y Cliente
//n_colegiado = idw_principal.getitemstring(1,'n_colegiado')
//if not f_es_vacio(n_colegiado) then
//idw_principal.setitem(1,'id_colegiado',f_busca_id_colegiado_por_codigo(n_colegiado))
//end if	
//
//n_nif = idw_principal.getitemstring(1,'nif_promotor')
//if not f_es_vacio(n_nif) then
//idw_principal.setitem(1,'id_cliente',f_cliente_id_cliente(n_nif))
//end if
//
//
////f_sql('expedientes.n_expedi','LIKE','n_expediente',idw_principal,sql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.n_registro','LIKE','n_registro',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.f_entrada','>=','f_entrada_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.f_entrada','<','f_entrada_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.f_visado','>=','f_visado_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.f_visado','<','f_visado_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.f_abono','>=','f_abono_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.f_abono','<','f_abono_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.titulo','LIKE','descripcion_trabajo',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.tipo_gestion','LIKE','tipo_gestion',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.honorarios','>=','honorarios_desde',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.honorarios','<','honorarios_hasta',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.modalidad','LIKE','codigo_especial',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.fase','LIKE','fase',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.n_calle','LIKE','n_calle',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//
//f_sql('fases.trabajo','=','trabajo',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.tipo_trabajo','=','tipo_trabajo',idw_principal,isql_nuevo,'1','')
//f_sql('fases.poblacion','=','poblacion',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('poblaciones.descripcion','=','des_poblacion',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('fases.emplazamiento','LIKE INSIDE','emplazamiento',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//
//f_sql('expedientes.administracion','=','obra_oficial',idw_principal,isql_nuevo,g_tipo_base_datos,'')	
////			f_sql('fases.aplicado_10','=','aplicado_10',idw_principal,sql_nuevo,g_tipo_base_datos,'')
//
//// Se prepara el formato del Nro. Registro
//if not f_es_vacio(idw_principal.getitemstring(1,'n_expediente')) then
//isql_nuevo=isql_nuevo + "and expedientes.n_expedi LIKE '" + i_exp + "%'"
//end if
//
//f_sql('fases_colegiados.id_col','LIKE','id_colegiado',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//f_sql('colegiados.apellidos','LIKE','nombre_colegiado',idw_principal,isql_nuevo,g_tipo_base_datos,'')
//
//f_sql('fases_clientes.id_cliente','LIKE','id_cliente',idw_principal,isql_nuevo,g_tipo_base_datos,'') 
//f_sql('clientes.apellidos','LIKE','nombre_promotor',idw_principal,isql_nuevo,g_tipo_base_datos,'') 
//
////			// Consulta por listas
////			if pos(upper(sql_nuevo), "WHERE") > 0 then
////				sql_aux = "and colegiados.id_colegiado IN (SELECT id_lista_miembro FROM listas_miembros WHERE id_lista='"+idw_principal.getitemstring(1,'lista_colegiados')+"')"
////			else
////				sql_aux = "WHERE colegiados.id_colegiado IN (SELECT id_lista_miembro FROM listas_miembros WHERE id_lista='"+idw_principal.getitemstring(1,'lista_colegiados')+"')"
////			end if	
////
////			if not isnull(sql_aux) then sql_nuevo += sql_aux
////	
////			if not(f_es_vacio(dw_2.getitemstring(1, 'n_minuta'))) then			
////				f_sql('fases_minutas.n_aviso','=','n_minuta',dw_2,sql_nuevo,g_tipo_base_datos,'') 
////			end if
//
////			// Consulta por total del aviso ( al tener comas hay que cambiarlas por puntos
////			double n_auxiliar
////			string sl_auxiliar
////			long posicion
////			if not(isnull(dw_2.getitemnumber(1, 'importe_desde'))) then	
////				n_auxiliar = dw_2.getitemnumber(1, 'importe_desde')
////				sl_auxiliar = string(n_auxiliar)
////				posicion = pos(sl_auxiliar,',',1)
////				if isnull(posicion) then posicion = 0
////				if posicion > 0 then
////					sl_auxiliar=replace(sl_auxiliar,posicion, 1,".")
////				end if					
////				sql_nuevo += ' and ( ' + ' fases_minutas.total_aviso >= ' + string(sl_auxiliar) + ' )'
////			end if
////			if not(isnull(dw_2.getitemnumber(1, 'importe_hasta'))) then			
////				n_auxiliar = dw_2.getitemnumber(1, 'importe_hasta')
////				sl_auxiliar = string(n_auxiliar)
////				posicion = pos(sl_auxiliar,',',1)
////				if isnull(posicion) then posicion = 0
////				if posicion > 0 then
////					sl_auxiliar=replace(sl_auxiliar,posicion, 1,".")
////				end if				
////				sql_nuevo += ' and ( ' + ' fases_minutas.total_aviso <= ' + string(sl_auxiliar) + ' )'
////			end if			
end event

on tabpage_1.create
this.st_1=create st_1
this.lb_1=create lb_1
this.dw_principal=create dw_principal
this.dw_pem_hono=create dw_pem_hono
this.Control[]={this.st_1,&
this.lb_1,&
this.dw_principal,&
this.dw_pem_hono}
end on

on tabpage_1.destroy
destroy(this.st_1)
destroy(this.lb_1)
destroy(this.dw_principal)
destroy(this.dw_pem_hono)
end on

type st_1 from statictext within tabpage_1
boolean visible = false
integer x = 2053
integer y = 100
integer width = 343
integer height = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Asociados"
boolean focusrectangle = false
end type

type lb_1 from listbox within tabpage_1
boolean visible = false
integer x = 2053
integer y = 160
integer width = 402
integer height = 60
integer taborder = 31
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type dw_principal from u_dw within tabpage_1
integer x = 41
integer y = 8
integer width = 2597
integer height = 1760
integer taborder = 11
string dataobject = "d_fases_consulta_principal"
boolean border = false
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)

end event

event itemchanged;call super::itemchanged;integer i, li_i, li_col
string cod,exp, ls_id_col
boolean sw
cod='***'

choose case dwo.name
	case 'n_expediente'
		i_exp=data
		if i_exp='0' then
			i_exp=''
			i_resultado='mal'
		else
			i_resultado='ok'
		end if
	case 'n_registro'
	case 'tipo_trabajo'
		SELECT tipos_trabajos.c_t_trabajo INTO :cod FROM tipos_trabajos WHERE tipos_trabajos.c_t_trabajo = :data;
		sw=true
	case 'trabajo'	
		SELECT trabajos.c_trabajo INTO :cod FROM trabajos WHERE trabajos.c_trabajo = :data ;
		sw=true
	case 'poblacion'
		SELECT poblaciones.cod_pob INTO :cod FROM poblaciones WHERE poblaciones.cod_pob = :data ;
		sw=true
	case 'estado'
		SELECT expedientes_estado.descripcion INTO :cod FROM expedientes_estado  
			WHERE expedientes_estado.cod_estado = :data;
		sw=true
	case 'tipo_gestion'
		SELECT t_gestion.descripcion INTO :cod FROM t_gestion
				WHERE t_gestion.cod_gestion = :data;
		sw=true
	// CASE CREADO POR RICARDO 04-04-05
	CASE 'nif_promotor', 'nombre_promotor', 't_persona'
		// VAciamos todos los campos que hayan podido poner de promotor
		this.setitem(row, 'nif_representante', '')
		this.setitem(row, 'nombre_representante', '')
		this.setitem(row, 'id_representante', '')
	// CASE CREADO POR RICARDO 04-04-05
	CASE 'nif_representante', 'nombre_representante'
		// Solo permitimos modificar los datos del resprensentante si no hay nada indicado en el cliente
		if this.GetItemNumber(1, 'indicado_cliente') = 1 then
			// Hay algo en cliente
			post Messagebox(g_titulo, g_idioma.of_getmsg('fases.msg_busca_cli_rep',"No es posible buscar por cliente y representante al mismo tiempo"), stopsign!)
			return 2
		end if
		
	CASE 't_descr'
		this.setitem(1, 'descripcion', data)
		
	///* A$$HEX1$$f100$$ENDHEX$$adido por Alexis.01/02/2010 **///
	CASE 'n_colegiado'
		ls_id_col = f_colegiado_id_col(data)
		if f_colegiado_es_sociedad(ls_id_col) then
			dw_principal.object.b_busca_colegiados_sociedades.visible = 1
			st_1.visible = True
			lb_1.visible = True
			ist_fases_col_soc.id_sociedad = ls_id_col
		else 
			dw_principal.object.b_busca_colegiados_sociedades.visible = 0
			st_1.visible = False
			lb_1.visible = False
			ist_fases_col_soc.id_sociedad = ''				
		end if	
		if dw_principal.getitemstring(dw_principal.getrow(),  'n_colegiado') <> data then
			li_col = UpperBound(ist_fases_col_soc.id_colegiados)
			For li_i = 1 To li_col
				setnull(ist_fases_col_soc.id_colegiados[li_i])
			next	
			
			lb_1.reset()
			
		end if
		
end choose
	
if cod='***' and sw=true then
	MessageBox(g_titulo,g_idioma.of_getmsg('fases.msg_codigo_inexistente','Este c$$HEX1$$f300$$ENDHEX$$digo no existe.'))
	message.stringparm=string(dwo.name)
	postevent ("csd_borrar_codigos")
end if

end event

event buttonclicked;call super::buttonclicked;string id_col, id_cliente, id_representante
string pob, ls_anterior
int li_i, li_col

choose case dwo.name
	case "b_busca_colegiado"
  		g_busqueda.titulo=g_idioma.of_getmsg('colegiados.busqueda_rapido_col',"B$$HEX1$$fa00$$ENDHEX$$squeda r$$HEX1$$e100$$ENDHEX$$pida de Colegiados")
		g_busqueda.dw="d_lista_busqueda_colegiados"
		id_col=f_busqueda_colegiados()   
		if NOT f_es_vacio(id_col)  then
			this.setitem(1,'n_colegiado', f_colegiado_n_col(id_col))
			
			///* Alexis. Modificado para habilitar la b$$HEX1$$fa00$$ENDHEX$$squeda de colegiados de una sociedad.01/02/2010 */
			if f_colegiado_es_sociedad(id_col) then
				dw_principal.object.b_busca_colegiados_sociedades.visible = 1
				st_1.visible = True
				lb_1.visible = True
				ist_fases_col_soc.id_sociedad = id_col
			else 
				dw_principal.object.b_busca_colegiados_sociedades.visible = 0
				st_1.visible = True
				lb_1.visible = True
				ist_fases_col_soc.id_sociedad = ''				
			end if	
			///* Fin modificado por Alexis	
			
		end if
		
		
	case "b_busca_cliente"
		g_busqueda.titulo=g_idioma.of_getmsg('colegiados.busqueda_rapido_cli',"B$$HEX1$$fa00$$ENDHEX$$squeda r$$HEX1$$e100$$ENDHEX$$pida de clientes")
		g_busqueda.dw="d_lista_busqueda_clientes"
		id_cliente=f_busqueda_clientes("")
		if NOT f_es_vacio(id_cliente)  then
			this.setitem(1,'nif_promotor',f_dame_nif(id_cliente))
			// Modificado por Ricardo 04-04-05
			// Vaciamos cualquier cosa que haya puesta en el representante
			this.setitem(1,'nif_representante','')
			this.setitem(1,'nombre_representante','')
			this.setitem(1,'id_representante','')
			// Modificado por Ricardo 04-04-05
		end if

	CASE 'bb_poblacion'
		g_busqueda.titulo='Poblaciones'
		g_busqueda.dw='d_poblaciones_lista_busqueda'
		ls_anterior = g_bloqueo_fases
		g_bloqueo_fases = 'S'
		pob=f_busqueda_poblaciones()
		g_bloqueo_fases = ls_anterior
		if f_es_vacio(pob) then return
		this.SetItem(1,'poblacion',pob)

	// Case creado por Ricardo 04-04-05
	case "b_busca_representante"
		if this.GetItemNumber(1, 'indicado_cliente') = 0 then
			g_busqueda.titulo=g_idioma.of_getmsg('colegiados.busqueda_rapido_cli',"B$$HEX1$$fa00$$ENDHEX$$squeda r$$HEX1$$e100$$ENDHEX$$pida de clientes")
			g_busqueda.dw="d_lista_busqueda_clientes"
			id_representante=f_busqueda_terceros(g_terceros_codigos.representantes)
			if NOT f_es_vacio(id_representante)  then
				this.setitem(1,'nif_representante',f_dame_nif(id_representante))
			end if
		else
			Messagebox(g_titulo, g_idioma.of_getmsg('fases.msg_busca_cli_rep',"No es posible buscar por cliente y representante al mismo tiempo"), stopsign!)
		end if
	
	///* Case creado por Alexis el 01/02/2010 ***///
	case "b_busca_colegiados_sociedades"

		g_busqueda.titulo = 'Selecci$$HEX1$$f300$$ENDHEX$$n de colegiados pertenecientes a una sociedad'
		if f_colegiado_es_sociedad(f_colegiado_id_col(dw_principal.getitemstring(dw_principal.getrow(),'n_colegiado' ))) then
			 openwithparm(w_fases_busqueda_coleg_sociedades, ist_fases_col_soc.id_sociedad)
			 
			if not isnull(message.powerobjectparm) then
				ist_fases_col_soc = message.powerobjectparm
			
				lb_1.reset()
				li_col = UpperBound(ist_fases_col_soc.id_colegiados)
				For li_i = 1 To li_col
					lb_1.additem(f_colegiado_n_col(ist_fases_col_soc.id_colegiados[li_i] ))
				next	
				
			end if	
			
		end if
			
END CHOOSE

end event

event itemerror;call super::itemerror;// messagebox(g_titulo,'La informaci$$HEX1$$f300$$ENDHEX$$n introducida en alg$$HEX1$$fa00$$ENDHEX$$n par$$HEX1$$e100$$ENDHEX$$metro es incorrecta')
return 1
end event

event itemfocuschanged;call super::itemfocuschanged;choose case dwo.name
	case 'n_expediente'
	case else
		idw_principal.setitem(1,'n_expediente',i_exp)
end choose


end event

type dw_pem_hono from u_dw within tabpage_1
integer x = 41
integer y = 1756
integer width = 2597
integer height = 248
integer taborder = 40
string dataobject = "d_fases_consulta_pem_hono"
boolean border = false
boolean ib_isupdateable = false
end type

type tabpage_5 from userobject within tab_1
string tag = "texto=fases.contrato_minutas"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Contrato Minutas"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_minutas dw_minutas
end type

on tabpage_5.create
this.dw_minutas=create dw_minutas
this.Control[]={this.dw_minutas}
end on

on tabpage_5.destroy
destroy(this.dw_minutas)
end on

type dw_minutas from u_dw within tabpage_5
integer x = 14
integer y = 36
integer width = 2597
integer height = 1676
integer taborder = 21
string dataobject = "d_fases_consulta_minutas"
boolean border = false
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)

end event

event itemchanged;call super::itemchanged;//choose case dwo.name
//	case 'tipo_gestion'
//	if data ='S' then
//		idw_gestion_contrato_minutas.visible = true
//	else
//		idw_gestion_contrato_minutas.visible=false
//	end if
//end choose
end event

event buttonclicked;call super::buttonclicked;//int i
//choose case dwo.name
//	case 'b_1'
//		for i=1 to idw_gestion_contrato_minutas.rowcount() 
//			idw_gestion_contrato_minutas.SetItem(i,'activo','S')
//		next
//	case 'b_2'
//		for i=1 to idw_gestion_contrato_minutas.rowcount() 
//			idw_gestion_contrato_minutas.SetItem(i,'activo','N')
//		next		
//end choose
end event

type tabpage_9 from userobject within tab_1
string tag = "texto=menu.estadisticas"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Estad$$HEX1$$ed00$$ENDHEX$$sticas"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_destino_seleccion dw_destino_seleccion
dw_tipo_obra_seleccion dw_tipo_obra_seleccion
dw_tipo_actuacion_seleccion dw_tipo_actuacion_seleccion
dw_destino dw_destino
dw_tipoobra dw_tipoobra
dw_tipoact dw_tipoact
cb_todos1_est cb_todos1_est
cb_borrar1_est cb_borrar1_est
cb_todos2_est cb_todos2_est
cb_borrar2_est cb_borrar2_est
cb_todos3_est cb_todos3_est
cb_borrar3_est cb_borrar3_est
gb_11 gb_11
gb_9 gb_9
gb_1est gb_1est
end type

on tabpage_9.create
this.dw_destino_seleccion=create dw_destino_seleccion
this.dw_tipo_obra_seleccion=create dw_tipo_obra_seleccion
this.dw_tipo_actuacion_seleccion=create dw_tipo_actuacion_seleccion
this.dw_destino=create dw_destino
this.dw_tipoobra=create dw_tipoobra
this.dw_tipoact=create dw_tipoact
this.cb_todos1_est=create cb_todos1_est
this.cb_borrar1_est=create cb_borrar1_est
this.cb_todos2_est=create cb_todos2_est
this.cb_borrar2_est=create cb_borrar2_est
this.cb_todos3_est=create cb_todos3_est
this.cb_borrar3_est=create cb_borrar3_est
this.gb_11=create gb_11
this.gb_9=create gb_9
this.gb_1est=create gb_1est
this.Control[]={this.dw_destino_seleccion,&
this.dw_tipo_obra_seleccion,&
this.dw_tipo_actuacion_seleccion,&
this.dw_destino,&
this.dw_tipoobra,&
this.dw_tipoact,&
this.cb_todos1_est,&
this.cb_borrar1_est,&
this.cb_todos2_est,&
this.cb_borrar2_est,&
this.cb_todos3_est,&
this.cb_borrar3_est,&
this.gb_11,&
this.gb_9,&
this.gb_1est}
end on

on tabpage_9.destroy
destroy(this.dw_destino_seleccion)
destroy(this.dw_tipo_obra_seleccion)
destroy(this.dw_tipo_actuacion_seleccion)
destroy(this.dw_destino)
destroy(this.dw_tipoobra)
destroy(this.dw_tipoact)
destroy(this.cb_todos1_est)
destroy(this.cb_borrar1_est)
destroy(this.cb_todos2_est)
destroy(this.cb_borrar2_est)
destroy(this.cb_todos3_est)
destroy(this.cb_borrar3_est)
destroy(this.gb_11)
destroy(this.gb_9)
destroy(this.gb_1est)
end on

type dw_destino_seleccion from u_dw within tabpage_9
integer x = 1842
integer y = 80
integer width = 736
integer height = 112
integer taborder = 21
string dataobject = "d_fases_consulta_seleccion"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos3_est.visible=true
	cb_borrar3_est.visible=true
	idw_destino.visible = true
else
	cb_todos3_est.visible=false
	cb_borrar3_est.visible=false
	idw_destino.visible=false
end if 
end event

type dw_tipo_obra_seleccion from u_dw within tabpage_9
integer x = 951
integer y = 80
integer width = 736
integer height = 112
integer taborder = 21
string dataobject = "d_fases_consulta_seleccion"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos2_est.visible=true
	cb_borrar2_est.visible=true
	idw_tipoobra.visible = true
else
	cb_todos2_est.visible=false
	cb_borrar2_est.visible=false
	idw_tipoobra.visible=false
end if 
end event

type dw_tipo_actuacion_seleccion from u_dw within tabpage_9
integer x = 78
integer y = 80
integer width = 736
integer height = 112
integer taborder = 21
string dataobject = "d_fases_consulta_seleccion"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos1_est.visible=true
	cb_borrar1_est.visible=true
	idw_tipoact.visible = true
else
	cb_todos1_est.visible=false
	cb_borrar1_est.visible=false
	idw_tipoact.visible=false
end if 
end event

type dw_destino from u_dw within tabpage_9
boolean visible = false
integer x = 1810
integer y = 224
integer width = 809
integer height = 1304
integer taborder = 21
string dataobject = "d_fases_consulta_destino"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
end type

type dw_tipoobra from u_dw within tabpage_9
boolean visible = false
integer x = 928
integer y = 224
integer width = 814
integer height = 1304
integer taborder = 21
string dataobject = "d_fases_consulta_tipoobra"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
end type

type dw_tipoact from u_dw within tabpage_9
boolean visible = false
integer x = 37
integer y = 224
integer width = 837
integer height = 1304
integer taborder = 21
string dataobject = "d_fases_consulta_tipoact"
boolean border = false
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
end type

type cb_todos1_est from commandbutton within tabpage_9
boolean visible = false
integer x = 32
integer y = 1548
integer width = 329
integer height = 68
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_tipoact.rowcount() 
	idw_tipoact.SetItem(i,'activo','S')
next
end event

type cb_borrar1_est from commandbutton within tabpage_9
boolean visible = false
integer x = 370
integer y = 1548
integer width = 329
integer height = 68
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_tipoact.rowcount() 
	idw_tipoact.SetItem(i,'activo','N')
next
end event

type cb_todos2_est from commandbutton within tabpage_9
boolean visible = false
integer x = 901
integer y = 1548
integer width = 329
integer height = 68
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_tipoobra.rowcount() 
	idw_tipoobra.SetItem(i,'activo','S')
next
end event

type cb_borrar2_est from commandbutton within tabpage_9
boolean visible = false
integer x = 1239
integer y = 1548
integer width = 329
integer height = 68
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_tipoobra.rowcount() 
	idw_tipoobra.SetItem(i,'activo','N')
next
end event

type cb_todos3_est from commandbutton within tabpage_9
boolean visible = false
integer x = 1765
integer y = 1548
integer width = 329
integer height = 68
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_destino.rowcount() 
	idw_destino.SetItem(i,'activo','S')
next
end event

type cb_borrar3_est from commandbutton within tabpage_9
boolean visible = false
integer x = 2098
integer y = 1548
integer width = 329
integer height = 68
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_destino.rowcount() 
	idw_destino.SetItem(i,'activo','N')
next
end event

type gb_11 from groupbox within tabpage_9
string tag = "texto=fases.destino"
integer x = 1797
integer y = 16
integer width = 846
integer height = 1516
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Destino"
end type

type gb_9 from groupbox within tabpage_9
string tag = "texto=fases.tipo_obra"
integer x = 896
integer y = 16
integer width = 859
integer height = 1516
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Tipo Obra"
end type

type gb_1est from groupbox within tabpage_9
string tag = "texto=fases.tipo_actuacion"
integer x = 23
integer y = 16
integer width = 859
integer height = 1516
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Tipo Actuaci$$HEX1$$f300$$ENDHEX$$n"
end type

type tabpage_2 from userobject within tab_1
string tag = "texto=fases.contrato_control"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Contrato Control"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
gb_12 gb_12
cb_todos7 cb_todos7
cb_todos4 cb_todos4
cb_borrar3 cb_borrar3
cb_todos3 cb_todos3
cb_borrar2 cb_borrar2
cb_todos2 cb_todos2
dw_seleccion_modalidad dw_seleccion_modalidad
dw_seleccion_gestion dw_seleccion_gestion
cb_borrar1 cb_borrar1
cb_todos1 cb_todos1
dw_seleccion_estados dw_seleccion_estados
dw_estados_contrato dw_estados_contrato
dw_modalidad_contrato dw_modalidad_contrato
gb_estados gb_estados
gb_modalidad gb_modalidad
gb_gestion gb_gestion
dw_gestion_contrato dw_gestion_contrato
dw_seleccion_col_destino dw_seleccion_col_destino
dw_consulta_col_destino dw_consulta_col_destino
end type

on tabpage_2.create
this.gb_12=create gb_12
this.cb_todos7=create cb_todos7
this.cb_todos4=create cb_todos4
this.cb_borrar3=create cb_borrar3
this.cb_todos3=create cb_todos3
this.cb_borrar2=create cb_borrar2
this.cb_todos2=create cb_todos2
this.dw_seleccion_modalidad=create dw_seleccion_modalidad
this.dw_seleccion_gestion=create dw_seleccion_gestion
this.cb_borrar1=create cb_borrar1
this.cb_todos1=create cb_todos1
this.dw_seleccion_estados=create dw_seleccion_estados
this.dw_estados_contrato=create dw_estados_contrato
this.dw_modalidad_contrato=create dw_modalidad_contrato
this.gb_estados=create gb_estados
this.gb_modalidad=create gb_modalidad
this.gb_gestion=create gb_gestion
this.dw_gestion_contrato=create dw_gestion_contrato
this.dw_seleccion_col_destino=create dw_seleccion_col_destino
this.dw_consulta_col_destino=create dw_consulta_col_destino
this.Control[]={this.gb_12,&
this.cb_todos7,&
this.cb_todos4,&
this.cb_borrar3,&
this.cb_todos3,&
this.cb_borrar2,&
this.cb_todos2,&
this.dw_seleccion_modalidad,&
this.dw_seleccion_gestion,&
this.cb_borrar1,&
this.cb_todos1,&
this.dw_seleccion_estados,&
this.dw_estados_contrato,&
this.dw_modalidad_contrato,&
this.gb_estados,&
this.gb_modalidad,&
this.gb_gestion,&
this.dw_gestion_contrato,&
this.dw_seleccion_col_destino,&
this.dw_consulta_col_destino}
end on

on tabpage_2.destroy
destroy(this.gb_12)
destroy(this.cb_todos7)
destroy(this.cb_todos4)
destroy(this.cb_borrar3)
destroy(this.cb_todos3)
destroy(this.cb_borrar2)
destroy(this.cb_todos2)
destroy(this.dw_seleccion_modalidad)
destroy(this.dw_seleccion_gestion)
destroy(this.cb_borrar1)
destroy(this.cb_todos1)
destroy(this.dw_seleccion_estados)
destroy(this.dw_estados_contrato)
destroy(this.dw_modalidad_contrato)
destroy(this.gb_estados)
destroy(this.gb_modalidad)
destroy(this.gb_gestion)
destroy(this.dw_gestion_contrato)
destroy(this.dw_seleccion_col_destino)
destroy(this.dw_consulta_col_destino)
end on

type gb_12 from groupbox within tabpage_2
integer x = 1755
integer y = 16
integer width = 878
integer height = 1568
integer taborder = 170
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Colegio Destino"
end type

type cb_todos7 from commandbutton within tabpage_2
boolean visible = false
integer x = 2103
integer y = 1596
integer width = 325
integer height = 68
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_colegio_dest.rowcount() 
	idw_colegio_dest.SetItem(i,'activo','N')
next
end event

type cb_todos4 from commandbutton within tabpage_2
boolean visible = false
integer x = 1774
integer y = 1596
integer width = 325
integer height = 68
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_colegio_dest.rowcount() 
	idw_colegio_dest.SetItem(i,'activo','S')
next
end event

type cb_borrar3 from commandbutton within tabpage_2
boolean visible = false
integer x = 1248
integer y = 1596
integer width = 325
integer height = 68
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_modalidad_contrato.rowcount() 
	idw_modalidad_contrato.SetItem(i,'activo','N')
next
end event

type cb_todos3 from commandbutton within tabpage_2
boolean visible = false
integer x = 919
integer y = 1596
integer width = 325
integer height = 68
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_modalidad_contrato.rowcount() 
	idw_modalidad_contrato.SetItem(i,'activo','S')
next
end event

type cb_borrar2 from commandbutton within tabpage_2
boolean visible = false
integer x = 1243
integer y = 732
integer width = 325
integer height = 68
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_gestion_contrato.rowcount() 
	idw_gestion_contrato.SetItem(i,'activo','N')
next
end event

type cb_todos2 from commandbutton within tabpage_2
boolean visible = false
integer x = 914
integer y = 732
integer width = 325
integer height = 68
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_gestion_contrato.rowcount() 
	idw_gestion_contrato.SetItem(i,'activo','S')
next
end event

type dw_seleccion_modalidad from u_dw within tabpage_2
integer x = 955
integer y = 912
integer width = 736
integer height = 112
integer taborder = 41
boolean bringtotop = true
string dataobject = "d_fases_consulta_seleccion"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos3.visible=true
	cb_borrar3.visible=true
	idw_modalidad_contrato.visible = true
else
	cb_todos3.visible=false
	cb_borrar3.visible=false
	idw_modalidad_contrato.visible=false
end if 
end event

type dw_seleccion_gestion from u_dw within tabpage_2
integer x = 951
integer y = 80
integer width = 736
integer height = 112
integer taborder = 31
boolean bringtotop = true
string dataobject = "d_fases_consulta_seleccion"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos2.visible=true
	cb_borrar2.visible=true
	idw_gestion_contrato.visible = true
else
	cb_todos2.visible=false
	cb_borrar2.visible=false
	idw_gestion_contrato.visible=false
end if 
end event

type cb_borrar1 from commandbutton within tabpage_2
boolean visible = false
integer x = 347
integer y = 1596
integer width = 325
integer height = 68
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_estados_contrato.rowcount() 
	idw_estados_contrato.SetItem(i,'activo','N')
next
end event

type cb_todos1 from commandbutton within tabpage_2
boolean visible = false
integer x = 18
integer y = 1596
integer width = 329
integer height = 68
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_estados_contrato.rowcount() 
	idw_estados_contrato.SetItem(i,'activo','S')
next
end event

type dw_seleccion_estados from u_dw within tabpage_2
integer x = 78
integer y = 80
integer width = 736
integer height = 112
integer taborder = 21
boolean bringtotop = true
string dataobject = "d_fases_consulta_seleccion"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos1.visible=true
	cb_borrar1.visible=true
	idw_estados_contrato.visible = true
else
	cb_todos1.visible=false
	cb_borrar1.visible=false
	idw_estados_contrato.visible=false
end if 
end event

type dw_estados_contrato from u_dw within tabpage_2
event csd_consulta_estados ( )
boolean visible = false
integer x = 41
integer y = 212
integer width = 832
integer height = 1236
integer taborder = 30
boolean bringtotop = true
string dataobject = "d_fases_consulta_estados"
boolean border = false
boolean ib_isupdateable = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_bajas.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_bajas.SetItem(1,'opcion','S')
end event

type dw_modalidad_contrato from u_dw within tabpage_2
boolean visible = false
integer x = 914
integer y = 1040
integer width = 795
integer height = 480
integer taborder = 50
boolean bringtotop = true
string dataobject = "d_fases_consulta_modalidad"
boolean border = false
boolean ib_isupdateable = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_bajas.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_bajas.SetItem(1,'opcion','S')
end event

type gb_estados from groupbox within tabpage_2
string tag = "texto=fases.estados"
integer x = 18
integer y = 12
integer width = 859
integer height = 1572
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Estados"
end type

type gb_modalidad from groupbox within tabpage_2
string tag = "texto=fases.modalidad"
integer x = 901
integer y = 844
integer width = 841
integer height = 736
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Modalidad"
end type

type gb_gestion from groupbox within tabpage_2
string tag = "texto=fases.tipo_gestion"
integer x = 901
integer y = 12
integer width = 841
integer height = 704
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Tipo Gesti$$HEX1$$f300$$ENDHEX$$n"
end type

type dw_gestion_contrato from u_dw within tabpage_2
boolean visible = false
integer x = 914
integer y = 212
integer width = 795
integer height = 468
integer taborder = 40
boolean bringtotop = true
string dataobject = "d_fases_consulta_gestion"
boolean border = false
boolean ib_isupdateable = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_bajas.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_bajas.SetItem(1,'opcion','S')
end event

type dw_seleccion_col_destino from u_dw within tabpage_2
integer x = 1833
integer y = 80
integer width = 768
integer height = 96
integer taborder = 31
boolean bringtotop = true
string dataobject = "d_fases_consulta_seleccion"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos4.visible=true
	cb_todos7.visible=true
	idw_colegio_dest.visible = true
else
	cb_todos4.visible=false
	cb_todos7.visible=false
	idw_colegio_dest.visible=false
end if 
end event

type dw_consulta_col_destino from u_dw within tabpage_2
boolean visible = false
integer x = 1783
integer y = 272
integer width = 846
integer height = 1280
integer taborder = 21
boolean bringtotop = true
string dataobject = "d_fases_consulta_col_destino"
boolean border = false
borderstyle borderstyle = stylebox!
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_seleccion_col_dest.GetItemString(1,'opcion')
if opcion='%' then idw_seleccion_col_dest.SetItem(1,'opcion','S')
end event

type tabpage_7 from userobject within tab_1
string tag = "texto=fases.otros_documentos"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Otros Documentos"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_otros_docs dw_otros_docs
dw_otros_doc_contrato dw_otros_doc_contrato
end type

on tabpage_7.create
this.dw_otros_docs=create dw_otros_docs
this.dw_otros_doc_contrato=create dw_otros_doc_contrato
this.Control[]={this.dw_otros_docs,&
this.dw_otros_doc_contrato}
end on

on tabpage_7.destroy
destroy(this.dw_otros_docs)
destroy(this.dw_otros_doc_contrato)
end on

type dw_otros_docs from u_dw within tabpage_7
integer x = 41
integer y = 16
integer width = 2574
integer height = 1640
integer taborder = 10
string dataobject = "d_fases_consulta_otros_docs"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

event buttonclicked;call super::buttonclicked;int i
choose case dwo.name
	case 'b_1'
		for i=1 to idw_otros_doc_contrato.rowcount() 
			idw_otros_doc_contrato.SetItem(i,'activo','S')
		next
	case 'b_2'
		for i=1 to idw_otros_doc_contrato.rowcount() 
			idw_otros_doc_contrato.SetItem(i,'activo','N')
		next		
end choose
end event

event itemchanged;call super::itemchanged;choose case dwo.name
	case 'tipo'
	if data ='S' then
		idw_otros_doc_contrato.visible = true
	else
		idw_otros_doc_contrato.visible=false
	end if 
	
end choose
end event

type dw_otros_doc_contrato from u_dw within tabpage_7
boolean visible = false
integer x = 1531
integer y = 264
integer width = 859
integer height = 1184
integer taborder = 50
boolean bringtotop = true
string dataobject = "d_fases_consulta_otros_docs_tipos"
boolean border = false
boolean ib_isupdateable = false
end type

event itemchanged;string opcion

opcion = idw_otros_doc_contrato.GetItemString(1,'activo')
if opcion='%' then idw_otros_doc_contrato.SetItem(1,'activo','S')
end event

type tabpage_6 from userobject within tab_1
string tag = "texto=fases.otros_datos"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Otros Datos"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_renuncias dw_renuncias
dw_registro_es dw_registro_es
dw_reclamaciones dw_reclamaciones
dw_reparos dw_reparos
dw_final_obra dw_final_obra
dw_garantias dw_garantias
end type

on tabpage_6.create
this.dw_renuncias=create dw_renuncias
this.dw_registro_es=create dw_registro_es
this.dw_reclamaciones=create dw_reclamaciones
this.dw_reparos=create dw_reparos
this.dw_final_obra=create dw_final_obra
this.dw_garantias=create dw_garantias
this.Control[]={this.dw_renuncias,&
this.dw_registro_es,&
this.dw_reclamaciones,&
this.dw_reparos,&
this.dw_final_obra,&
this.dw_garantias}
end on

on tabpage_6.destroy
destroy(this.dw_renuncias)
destroy(this.dw_registro_es)
destroy(this.dw_reclamaciones)
destroy(this.dw_reparos)
destroy(this.dw_final_obra)
destroy(this.dw_garantias)
end on

type dw_renuncias from u_csd_dw within tabpage_6
integer x = 46
integer y = 1564
integer width = 2565
integer height = 240
integer taborder = 11
string dataobject = "d_fases_consulta_renuncias"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)


end event

type dw_registro_es from u_dw within tabpage_6
integer x = 41
integer y = 1308
integer width = 2574
integer height = 252
integer taborder = 40
boolean bringtotop = true
string dataobject = "d_fases_consulta_registro_es"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

type dw_reclamaciones from u_dw within tabpage_6
string tag = "texto=fases.reclamaciones"
integer x = 41
integer y = 712
integer width = 2574
integer height = 252
integer taborder = 30
boolean bringtotop = true
string dataobject = "d_fases_consulta_reclamaciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

type dw_reparos from u_dw within tabpage_6
integer x = 41
integer y = 964
integer width = 2574
integer height = 356
integer taborder = 20
boolean bringtotop = true
string dataobject = "d_fases_consulta_reparos"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

type dw_final_obra from u_dw within tabpage_6
string tag = "texto=menu.finales_obra"
integer x = 41
integer width = 2574
integer height = 368
integer taborder = 60
boolean bringtotop = true
string dataobject = "d_fases_consulta_finales_obra"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)


end event

type dw_garantias from u_dw within tabpage_6
string tag = "texto=menu.garantia"
integer x = 41
integer y = 356
integer width = 2574
integer height = 368
integer taborder = 10
string dataobject = "d_fases_consulta_garantias"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

type tabpage_8 from userobject within tab_1
string tag = "texto=menu.arquitectos"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Arquitectos"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_arquitectos dw_arquitectos
end type

on tabpage_8.create
this.dw_arquitectos=create dw_arquitectos
this.Control[]={this.dw_arquitectos}
end on

on tabpage_8.destroy
destroy(this.dw_arquitectos)
end on

type dw_arquitectos from u_dw within tabpage_8
integer x = 41
integer y = 40
integer width = 2574
integer height = 368
integer taborder = 10
boolean bringtotop = true
string dataobject = "d_fases_consulta_arquitectos"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

type tabpage_3 from userobject within tab_1
event create ( )
event destroy ( )
string tag = "texto=fases.col_sit_pro"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Colegiados Sit. Profesional"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_datos_sitprof dw_datos_sitprof
cb_6 cb_6
cb_5 cb_5
cb_4 cb_4
cb_3 cb_3
cb_borrar4 cb_borrar4
cb_incluir4 cb_incluir4
dw_incompatibilidades dw_incompatibilidades
dw_sit_profesionales dw_sit_profesionales
dw_agrupaciones dw_agrupaciones
dw_opcion_incomp dw_opcion_incomp
dw_opcion_sit dw_opcion_sit
dw_opcion_agr dw_opcion_agr
dw_datos_agrupacion dw_datos_agrupacion
gb_7 gb_7
gb_6 gb_6
gb_5 gb_5
gb_4 gb_4
gb_8 gb_8
end type

on tabpage_3.create
this.dw_datos_sitprof=create dw_datos_sitprof
this.cb_6=create cb_6
this.cb_5=create cb_5
this.cb_4=create cb_4
this.cb_3=create cb_3
this.cb_borrar4=create cb_borrar4
this.cb_incluir4=create cb_incluir4
this.dw_incompatibilidades=create dw_incompatibilidades
this.dw_sit_profesionales=create dw_sit_profesionales
this.dw_agrupaciones=create dw_agrupaciones
this.dw_opcion_incomp=create dw_opcion_incomp
this.dw_opcion_sit=create dw_opcion_sit
this.dw_opcion_agr=create dw_opcion_agr
this.dw_datos_agrupacion=create dw_datos_agrupacion
this.gb_7=create gb_7
this.gb_6=create gb_6
this.gb_5=create gb_5
this.gb_4=create gb_4
this.gb_8=create gb_8
this.Control[]={this.dw_datos_sitprof,&
this.cb_6,&
this.cb_5,&
this.cb_4,&
this.cb_3,&
this.cb_borrar4,&
this.cb_incluir4,&
this.dw_incompatibilidades,&
this.dw_sit_profesionales,&
this.dw_agrupaciones,&
this.dw_opcion_incomp,&
this.dw_opcion_sit,&
this.dw_opcion_agr,&
this.dw_datos_agrupacion,&
this.gb_7,&
this.gb_6,&
this.gb_5,&
this.gb_4,&
this.gb_8}
end on

on tabpage_3.destroy
destroy(this.dw_datos_sitprof)
destroy(this.cb_6)
destroy(this.cb_5)
destroy(this.cb_4)
destroy(this.cb_3)
destroy(this.cb_borrar4)
destroy(this.cb_incluir4)
destroy(this.dw_incompatibilidades)
destroy(this.dw_sit_profesionales)
destroy(this.dw_agrupaciones)
destroy(this.dw_opcion_incomp)
destroy(this.dw_opcion_sit)
destroy(this.dw_opcion_agr)
destroy(this.dw_datos_agrupacion)
destroy(this.gb_7)
destroy(this.gb_6)
destroy(this.gb_5)
destroy(this.gb_4)
destroy(this.gb_8)
end on

type dw_datos_sitprof from u_dw within tabpage_3
integer x = 1321
integer y = 64
integer width = 1221
integer height = 352
integer taborder = 40
boolean bringtotop = true
string dataobject = "d_colegiados_consulta_datos_sitprof"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event buttonclicked;call super::buttonclicked;string pob, ls_anterior 

g_busqueda.titulo='Poblaciones'
g_busqueda.dw='d_poblaciones_lista_busqueda'
ls_anterior = g_bloqueo_fases
g_bloqueo_fases = 'S'
pob=f_busqueda_poblaciones()
g_bloqueo_fases = ls_anterior
if f_es_vacio(pob) then return
this.SetItem(1,'poblacion',pob)

end event

event constructor;call super::constructor;
// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

type cb_6 from commandbutton within tabpage_3
boolean visible = false
integer x = 2107
integer y = 1520
integer width = 325
integer height = 68
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "BorrarTodos"
end type

event clicked;int i

for i=1 to idw_incompatibilidades.rowcount() 
	idw_incompatibilidades.SetItem(i,'activo','N')
next
end event

type cb_5 from commandbutton within tabpage_3
boolean visible = false
integer x = 1778
integer y = 1520
integer width = 325
integer height = 68
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel.Todos"
end type

event clicked;int i

for i=1 to idw_incompatibilidades.rowcount() 
	idw_incompatibilidades.SetItem(i,'activo','S')
next
end event

type cb_4 from commandbutton within tabpage_3
boolean visible = false
integer x = 1239
integer y = 1520
integer width = 325
integer height = 68
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "BorrarTodos"
end type

event clicked;int i

for i=1 to idw_sit_profesionales.rowcount() 
	idw_sit_profesionales.SetItem(i,'activo','N')
next
end event

type cb_3 from commandbutton within tabpage_3
boolean visible = false
integer x = 910
integer y = 1520
integer width = 325
integer height = 68
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel.Todos"
end type

event clicked;int i

for i=1 to idw_sit_profesionales.rowcount() 
	idw_sit_profesionales.SetItem(i,'activo','S')
next
end event

type cb_borrar4 from commandbutton within tabpage_3
boolean visible = false
integer x = 375
integer y = 1524
integer width = 325
integer height = 68
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "BorrarTodos"
end type

event clicked;int i

for i=1 to idw_agrupaciones.rowcount() 
	idw_agrupaciones.SetItem(i,'activo','N')
next
end event

type cb_incluir4 from commandbutton within tabpage_3
boolean visible = false
integer x = 46
integer y = 1524
integer width = 325
integer height = 68
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel.Todos"
end type

event clicked;int i

for i=1 to idw_agrupaciones.rowcount() 
	idw_agrupaciones.SetItem(i,'activo','S')
next
end event

type dw_incompatibilidades from u_dw within tabpage_3
boolean visible = false
integer x = 1792
integer y = 656
integer width = 763
integer height = 848
integer taborder = 21
string dataobject = "d_colegiados_consulta_incompatibilidades"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_incomp.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_incomp.SetItem(1,'opcion','S')
end event

type dw_sit_profesionales from u_dw within tabpage_3
boolean visible = false
integer x = 928
integer y = 656
integer width = 763
integer height = 848
integer taborder = 21
string dataobject = "d_colegiados_consulta_sit_profesional"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;string opcion

opcion = idw_opcion_sit.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_sit.SetItem(1,'opcion','S')
end event

type dw_agrupaciones from u_dw within tabpage_3
boolean visible = false
integer x = 87
integer y = 656
integer width = 773
integer height = 848
integer taborder = 30
string dataobject = "d_colegiados_consulta_agrupaciones"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;string opcion

opcion = idw_opcion_agr.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_agr.SetItem(1,'opcion','S')
end event

type dw_opcion_incomp from u_dw within tabpage_3
integer x = 1806
integer y = 520
integer width = 727
integer height = 112
integer taborder = 21
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_5.visible=true
	cb_6.visible=true
	dw_incompatibilidades.visible = true
else
	cb_5.visible=false
	cb_6.visible=false
	dw_incompatibilidades.visible=false
end if 
end event

type dw_opcion_sit from u_dw within tabpage_3
integer x = 951
integer y = 520
integer width = 727
integer height = 112
integer taborder = 21
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_3.visible=true
	cb_4.visible=true
	dw_sit_profesionales.visible = true
else
	cb_3.visible=false
	cb_4.visible=false
	dw_sit_profesionales.visible=false
end if 
end event

type dw_opcion_agr from u_dw within tabpage_3
integer x = 105
integer y = 520
integer width = 727
integer height = 128
integer taborder = 21
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_incluir4.visible=true
	cb_borrar4.visible=true
	dw_agrupaciones.visible = true
else
	cb_incluir4.visible=false
	cb_borrar4.visible=false
	dw_agrupaciones.visible=false
end if 
end event

type dw_datos_agrupacion from u_dw within tabpage_3
integer x = 69
integer y = 72
integer width = 1079
integer height = 332
integer taborder = 21
string dataobject = "d_colegiados_consulta_datos_agrupacion"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
end type

event constructor;call super::constructor;
// Activamos el control calendario para los campos de tipo fecha
this.of_SetDropDownCalendar(True)
this.iuo_calendar.of_register(this.iuo_calendar.DDLB)
this.iuo_calendar.of_SetDateFormat("dd/mm/yyyy")
this.iuo_calendar.of_SetInitialValue(True)
end event

type gb_7 from groupbox within tabpage_3
integer x = 41
integer y = 8
integer width = 1143
integer height = 432
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Datos Agrupaci$$HEX1$$f300$$ENDHEX$$n"
end type

type gb_6 from groupbox within tabpage_3
string tag = "texto=fases.incompatibilidades"
integer x = 1783
integer y = 460
integer width = 791
integer height = 1052
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Incompatibilidades"
end type

type gb_5 from groupbox within tabpage_3
string tag = "texto=general.sit_profesional"
integer x = 910
integer y = 460
integer width = 800
integer height = 1052
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Situaciones Profesionales"
end type

type gb_4 from groupbox within tabpage_3
string tag = "texto=fases.agrupaciones"
integer x = 46
integer y = 460
integer width = 827
integer height = 1052
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Agrupaciones"
end type

type gb_8 from groupbox within tabpage_3
integer x = 1225
integer y = 8
integer width = 1349
integer height = 432
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Datos Situaciones,Incompatibilidades"
end type

type tabpage_4 from userobject within tab_1
event create ( )
event destroy ( )
string tag = "texto=fases.col_sit_col"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Colegiados Sit. Colegial"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_t_baja dw_t_baja
dw_opcion_altas dw_opcion_altas
cb_borrar30 cb_borrar30
cb_todos30 cb_todos30
cb_borrar20 cb_borrar20
cb_todos20 cb_todos20
cb_borrar10 cb_borrar10
cb_todos10 cb_todos10
dw_opcion_bajas dw_opcion_bajas
dw_t_alta dw_t_alta
dw_situaciones dw_situaciones
dw_alta_si_no dw_alta_si_no
dw_opcion_situaciones dw_opcion_situaciones
gb_2 gb_2
gb_10 gb_10
gb_3 gb_3
end type

on tabpage_4.create
this.dw_t_baja=create dw_t_baja
this.dw_opcion_altas=create dw_opcion_altas
this.cb_borrar30=create cb_borrar30
this.cb_todos30=create cb_todos30
this.cb_borrar20=create cb_borrar20
this.cb_todos20=create cb_todos20
this.cb_borrar10=create cb_borrar10
this.cb_todos10=create cb_todos10
this.dw_opcion_bajas=create dw_opcion_bajas
this.dw_t_alta=create dw_t_alta
this.dw_situaciones=create dw_situaciones
this.dw_alta_si_no=create dw_alta_si_no
this.dw_opcion_situaciones=create dw_opcion_situaciones
this.gb_2=create gb_2
this.gb_10=create gb_10
this.gb_3=create gb_3
this.Control[]={this.dw_t_baja,&
this.dw_opcion_altas,&
this.cb_borrar30,&
this.cb_todos30,&
this.cb_borrar20,&
this.cb_todos20,&
this.cb_borrar10,&
this.cb_todos10,&
this.dw_opcion_bajas,&
this.dw_t_alta,&
this.dw_situaciones,&
this.dw_alta_si_no,&
this.dw_opcion_situaciones,&
this.gb_2,&
this.gb_10,&
this.gb_3}
end on

on tabpage_4.destroy
destroy(this.dw_t_baja)
destroy(this.dw_opcion_altas)
destroy(this.cb_borrar30)
destroy(this.cb_todos30)
destroy(this.cb_borrar20)
destroy(this.cb_todos20)
destroy(this.cb_borrar10)
destroy(this.cb_todos10)
destroy(this.dw_opcion_bajas)
destroy(this.dw_t_alta)
destroy(this.dw_situaciones)
destroy(this.dw_alta_si_no)
destroy(this.dw_opcion_situaciones)
destroy(this.gb_2)
destroy(this.gb_10)
destroy(this.gb_3)
end on

type dw_t_baja from u_dw within tabpage_4
boolean visible = false
integer x = 1760
integer y = 268
integer width = 823
integer height = 1252
integer taborder = 40
boolean bringtotop = true
string dataobject = "d_colegiados_t_baja_consulta"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_bajas.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_bajas.SetItem(1,'opcion','S')
end event

type dw_opcion_altas from u_dw within tabpage_4
boolean visible = false
integer x = 978
integer y = 280
integer width = 736
integer height = 112
integer taborder = 50
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos20.visible=true
	cb_borrar20.visible=true
	dw_t_alta.visible = true
else
	cb_todos20.visible=false
	cb_borrar20.visible=false
	dw_t_alta.visible=false
end if 
end event

type cb_borrar30 from commandbutton within tabpage_4
boolean visible = false
integer x = 2080
integer y = 1568
integer width = 325
integer height = 68
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_t_baja.rowcount() 
	idw_t_baja.SetItem(i,'activo','N')
next
end event

type cb_todos30 from commandbutton within tabpage_4
boolean visible = false
integer x = 1751
integer y = 1568
integer width = 325
integer height = 68
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_t_baja.rowcount() 
	idw_t_baja.SetItem(i,'activo','S')
next
end event

type cb_borrar20 from commandbutton within tabpage_4
boolean visible = false
integer x = 1193
integer y = 1572
integer width = 325
integer height = 68
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_situaciones.rowcount() 
	idw_t_alta.SetItem(i,'activo','N')
next
end event

type cb_todos20 from commandbutton within tabpage_4
boolean visible = false
integer x = 864
integer y = 1572
integer width = 325
integer height = 68
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_situaciones.rowcount() 
	idw_t_alta.SetItem(i,'activo','S')
next
end event

type cb_borrar10 from commandbutton within tabpage_4
boolean visible = false
integer x = 343
integer y = 1576
integer width = 325
integer height = 68
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_situaciones.rowcount() 
	idw_situaciones.SetItem(i,'activo','N')
next
end event

type cb_todos10 from commandbutton within tabpage_4
boolean visible = false
integer x = 14
integer y = 1576
integer width = 325
integer height = 68
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_situaciones.rowcount() 
	idw_situaciones.SetItem(i,'activo','S')
next
end event

type dw_opcion_bajas from u_dw within tabpage_4
boolean visible = false
integer x = 1797
integer y = 280
integer width = 736
integer height = 112
integer taborder = 31
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos30.visible=true
	cb_borrar30.visible=true
	dw_t_baja.visible = true
else
	cb_todos30.visible=false
	cb_borrar30.visible=false
	dw_t_baja.visible=false
end if 
end event

type dw_t_alta from u_dw within tabpage_4
boolean visible = false
integer x = 901
integer y = 268
integer width = 800
integer height = 1252
integer taborder = 21
boolean bringtotop = true
string dataobject = "d_colegiados_t_alta_consulta"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_altas.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_altas.SetItem(1,'opcion','S')
end event

type dw_situaciones from u_dw within tabpage_4
boolean visible = false
integer x = 41
integer y = 280
integer width = 800
integer height = 1256
integer taborder = 31
string dataobject = "d_colegiados_situaciones_consulta"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_sit.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_sit.SetItem(1,'opcion','S')
end event

type dw_alta_si_no from u_dw within tabpage_4
integer x = 878
integer y = 68
integer width = 955
integer height = 136
integer taborder = 50
string dataobject = "d_colegiados_consulta_alta"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;boolean alta,baja

choose case data 
	case 'S' 
		alta = true
		baja = false
		cb_todos20.TriggerEvent(Clicked!)
	case 'N'
		alta = false
		baja = true
		cb_todos30.TriggerEvent(Clicked!)
	case else
		alta = false
		baja = false
end choose
gb_3.visible= baja
cb_todos30.visible= baja
cb_borrar30.visible = baja
idw_t_baja.visible = baja
gb_2.visible=alta
cb_todos20.visible=alta
cb_borrar20.visible = alta
idw_t_alta.visible = alta
		
end event

type dw_opcion_situaciones from u_dw within tabpage_4
integer x = 78
integer y = 128
integer width = 736
integer height = 112
integer taborder = 21
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos10.visible=true
	cb_borrar10.visible=true
	dw_situaciones.visible = true
else
	cb_todos10.visible=false
	cb_borrar10.visible=false
	dw_situaciones.visible=false
end if 
end event

type gb_2 from groupbox within tabpage_4
string tag = "texto=general.altas"
integer x = 864
integer y = 200
integer width = 864
integer height = 1356
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 79741120
string text = "Altas"
end type

type gb_10 from groupbox within tabpage_4
string tag = "texto=colegiados.situaciones"
integer x = 9
integer y = 48
integer width = 846
integer height = 1508
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Situaciones"
end type

type gb_3 from groupbox within tabpage_4
string tag = "texto=general.bajas"
integer x = 1746
integer y = 200
integer width = 850
integer height = 1356
integer taborder = 31
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Bajas"
end type

type tabpage_10 from userobject within tab_1
event create ( )
event destroy ( )
string tag = "texto=fases.col_sit_residente"
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Colegiados Sit. Residente"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_todos5 cb_todos5
cb_borrar5 cb_borrar5
dw_residente dw_residente
dw_opcion_residente dw_opcion_residente
gb_15 gb_15
end type

on tabpage_10.create
this.cb_todos5=create cb_todos5
this.cb_borrar5=create cb_borrar5
this.dw_residente=create dw_residente
this.dw_opcion_residente=create dw_opcion_residente
this.gb_15=create gb_15
this.Control[]={this.cb_todos5,&
this.cb_borrar5,&
this.dw_residente,&
this.dw_opcion_residente,&
this.gb_15}
end on

on tabpage_10.destroy
destroy(this.cb_todos5)
destroy(this.cb_borrar5)
destroy(this.dw_residente)
destroy(this.dw_opcion_residente)
destroy(this.gb_15)
end on

type cb_todos5 from commandbutton within tabpage_10
boolean visible = false
integer x = 14
integer y = 1576
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_residente.rowcount() 
	idw_residente.SetItem(i,'activo','S')
next
end event

type cb_borrar5 from commandbutton within tabpage_10
boolean visible = false
integer x = 343
integer y = 1576
integer width = 325
integer height = 68
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_residente.rowcount() 
	idw_residente.SetItem(i,'activo','N')
next
end event

type dw_residente from u_dw within tabpage_10
boolean visible = false
integer x = 41
integer y = 280
integer width = 800
integer height = 1256
integer taborder = 10
string dataobject = "d_colegiados_consulta_residente"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = idw_opcion_residente.GetItemString(1,'opcion')
if opcion='%' then idw_opcion_residente.SetItem(1,'opcion','S')
end event

type dw_opcion_residente from u_dw within tabpage_10
integer x = 78
integer y = 128
integer width = 736
integer height = 112
integer taborder = 10
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos5.visible=true
	cb_borrar5.visible=true
	dw_residente.visible = true
else
	cb_todos5.visible=false
	cb_borrar5.visible=false
	dw_residente.visible=false
end if 
end event

type gb_15 from groupbox within tabpage_10
string tag = "texto=colegiados.residente"
integer x = 9
integer y = 48
integer width = 846
integer height = 1508
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Residente"
end type

type tabpage_11 from userobject within tab_1
event create ( )
event destroy ( )
boolean visible = false
integer x = 18
integer y = 184
integer width = 2633
integer height = 2040
long backcolor = 79741120
string text = "Hon. Orien."
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_opcion_tarifa dw_opcion_tarifa
dw_honos_tarifas dw_honos_tarifas
cb_borrar6 cb_borrar6
cb_todos6 cb_todos6
gb_16 gb_16
end type

on tabpage_11.create
this.dw_opcion_tarifa=create dw_opcion_tarifa
this.dw_honos_tarifas=create dw_honos_tarifas
this.cb_borrar6=create cb_borrar6
this.cb_todos6=create cb_todos6
this.gb_16=create gb_16
this.Control[]={this.dw_opcion_tarifa,&
this.dw_honos_tarifas,&
this.cb_borrar6,&
this.cb_todos6,&
this.gb_16}
end on

on tabpage_11.destroy
destroy(this.dw_opcion_tarifa)
destroy(this.dw_honos_tarifas)
destroy(this.cb_borrar6)
destroy(this.cb_todos6)
destroy(this.gb_16)
end on

type dw_opcion_tarifa from u_dw within tabpage_11
integer x = 78
integer y = 128
integer width = 736
integer height = 112
integer taborder = 31
string dataobject = "d_colegiados_consulta_opciones"
boolean vscrollbar = false
boolean border = false
boolean livescroll = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;if data ='S' then
	cb_todos6.visible=true
	cb_borrar6.visible=true
	dw_honos_tarifas.visible = true
else
	cb_todos6.visible=false
	cb_borrar6.visible=false
	dw_honos_tarifas.visible=false
end if 
end event

type dw_honos_tarifas from u_dw within tabpage_11
boolean visible = false
integer x = 41
integer y = 280
integer width = 2350
integer height = 1256
integer taborder = 60
string dataobject = "d_fases_consulta_honos_orientativos"
boolean border = false
borderstyle borderstyle = stylebox!
boolean ib_isupdateable = false
boolean ib_rmbmenu = false
boolean ib_rmbfocuschange = false
end type

event itemchanged;call super::itemchanged;string opcion

opcion = dw_opcion_tarifa.GetItemString(1,'opcion')
if opcion='%' then dw_opcion_tarifa.SetItem(1,'opcion','S')
end event

type cb_borrar6 from commandbutton within tabpage_11
boolean visible = false
integer x = 343
integer y = 1576
integer width = 325
integer height = 68
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Borrar Todos"
end type

event clicked;int i

for i=1 to idw_tarifas.rowcount() 
	idw_tarifas.SetItem(i,'activo','N')
next
end event

type cb_todos6 from commandbutton within tabpage_11
boolean visible = false
integer x = 14
integer y = 1576
integer width = 325
integer height = 68
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
string text = "Sel. Todos"
end type

event clicked;int i

for i=1 to idw_tarifas.rowcount() 
	idw_tarifas.SetItem(i,'activo','S')
next
end event

type gb_16 from groupbox within tabpage_11
integer x = 9
integer y = 48
integer width = 2400
integer height = 1508
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 8388608
long backcolor = 67108864
string text = "Tarifa"
end type

type cbx_minutas from checkbox within w_fases_consulta
boolean visible = false
integer x = 2798
integer y = 216
integer width = 402
integer height = 80
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Minutas"
end type

type gb_1 from groupbox within w_fases_consulta
integer x = 2766
integer y = 8
integer width = 471
integer height = 200
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
end type

